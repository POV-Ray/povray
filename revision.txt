#----------------------------------------------------------------------------
# Note: To view an original flyspray bug report (FS#xxx), replace the leading
# FS# of the bug ID with the URL http://bugs.povray.org/.
# For example, to read FS#270, visit http://bugs.povray.org/270.
# To view a referenced newsgroup posting (<xxxxx@news.povray.org>), prefix
# the message ID with the URL http://news.povray.org/.
# For example, to read <42765ef3$1@news.povray.org>, visit:
# http://news.povray.org/<42765ef3$1@news.povray.org>.
# The '<' and '>' are optional (if using a shell you may want to omit them).
#----------------------------------------------------------------------------

---------------------------------
Changes between 3.7.RC7 and 3.7.0
---------------------------------

Change 6048 on 2013/09/14 by jholsenback@linux-c2bm

    picking up a last minute change

Change 6047 on 2013/09/14 by jgrimbert@smpdirect

    fix of formula to restore backward compatibility of heightfield on
    red+green non-indexed color image (not only backward compatible, but also
    correct formula to cover the full range as intended and documented) Added
    also comment to explain why the indexed-image code should NOT be fixed:
    despite providing more range, index*257 would break the backward
    compatibility, so index*256 should remains (for historical reasons only)


Change 6037 on 2013/09/01 by jholsenback@linux-c2bm

    updates to changes/revision files

Change 6036 on 2013/09/01 by jholsenback@linux-c2bm

    cleanup... updates and deletes

Change 6035 on 2013/09/01 by jholsenback@linux-c2bm

    delete outdated files

Change 6034 on 2013/09/01 by jholsenback@linux-c2bm

    several more changes to unix man page

Change 6028 on 2013/08/29 by jholsenback@linux-c2bm

    follow up to change #6027

Change 6027 on 2013/08/29 by jholsenback@linux-c2bm

    updates to unix man page

Change 6026 on 2013/08/27 by chrisc@x8

    add warranty disclaimer to console output

Change 6025 on 2013/08/27 by chrisc@x8

    remove outdated support header files for borland, mingw and watcom
    compilers. if support is needed for any of the above, it would be better to
    start a fresh header as the old ones have not been used since 3.6

Change 6024 on 2013/08/27 by chrisc@x8

    correct typo in rename

Change 6023 on 2013/08/27 by chrisc@x8

    remove old 4BPP toolbar icons as 16-color mode support isn't really
    relevant anymore

Change 6022 on 2013/08/27 by chrisc@x8

    rename a few files whose names were upper-case

Change 6018 on 2013/08/27 by chrisc@x8

    move SubmitMinidump to internal area

Change 6013 on 2013/08/24 by chrisc@x8

    another tweak to the about box

Change 6012 on 2013/08/24 by chrisc@x8

    update about bitmap to remove explicit URL's and add support to about
    window code to make some areas act as hyperlinks

Change 6011 on 2013/08/24 by chrisc@x8

    fix issue with editor selection due to off-by-one line numbers. make use of
    SetCaretPos consistent

Change 6008 on 2013/08/20 by clipka@xcli-pc-7

    fix for FS#304

Change 6007 on 2013/08/18 by clipka@xcli-pc-7

    fix cpuinfo stub for unofficial builds

Change 6005 on 2013/08/18 by chrisc@x8

    move about.psd from bitmaps/source to smp/internal/windows

Change 6004 on 2013/08/18 by chrisc@x8

    move #undef back inside official code block

Change 6002 on 2013/08/18 by chrisc@x8

    added some files left out of previous submissions

Change 5997 on 2013/08/18 by thorsten@host26

    adds Mac xcode project and support files, still some compile errors due to
    misconfigured paths etc. Big issues resolved though.

Change 5996 on 2013/08/18 by clipka@cli-pc-7

    minor indentation cleanup of various sample scene files

Change 5994 on 2013/08/18 by chrisc@x8

    swathe of windows changes for 3.7 AGPL3 release. Most visible is removal of
    the splash window and updating of the about dialog. 'Tip of the day'
    feature removed. Licensing clarified for pvbitmap.cpp/.h. pvlegal.h updated
    to reflect AGPL3. readme.html/.txt updated. Import libraries added for
    povcmax so as to allow cmedit to link without it. Several functions only
    used in official builds moved to new file 'official.h'. Many other changes
    related to official vs unofficial builds.

Change 5993 on 2013/08/18 by chrisc@x8

    move Intel CPU info code to legacy license area; add stub for
    unofficial builds

Change 5992 on 2013/08/18 by chrisc@x8

    add BSD-style license header to chi2.cpp as discussed with author

Change 5991 on 2013/08/18 by chrisc@x8

    remove some distribution license-related files that are no longer required

Change 5990 on 2013/08/18 by chrisc@x8

    update a few unix files to reflect AGPL

Change 5984 on 2013/08/11 by thorsten@xhost26

    first version of Mac display code for a preview window created by the
    terminal application

Change 5983 on 2013/08/11 by thorsten@xhost26

    clean up Mac tree

Change 5982 on 2013/08/09 by chrisc@x8

    tweak console project, remove unused codemax project

Change 5981 on 2013/08/09 by chrisc@x8

    remove outdated makefiles

Change 5979 on 2013/08/09 by chrisc@x8

    remove vs8 and vs9 solutions

Change 5978 on 2013/08/07 by chrisc@x8

    integrate flohmuller branch to trunk

Change 5977 on 2013/08/07 by chrisc@x8

    tweaks related to console build (windows version)

Change 5962 on 2013/07/28 by chrisc@x8

    remove all dependence on codemax header files

Change 5961 on 2013/07/28 by chrisc@x8

    move codemax source to //depot/povray/smp/legacy-license/codemax/...

Change 5960 on 2013/07/27 by chrisc@x8

    move cmedit source to //depot/povray/smp/windows/cmedit

Change 5958 on 2013/07/27 by chrisc@x8

    integrate flohmuller branch to trunk

Change 5946 on 2013/07/22 by clipka@cli-pc-7

    fix filetype of prebuild.sh (unix specific)

Change 5940 on 2013/07/21 by chrisc@x8

    first pass at explicitly assigning licences to individual source files in
    the distribution tree. Notes: fish13 has been deleted, and the Insert Menu
    and Templates sub-trees have not been updated

Change 5936 on 2013/07/20 by jholsenback@linux-c2bm

    corrections to a malformed regex used to fill a script variable

Change 5922 on 2013/07/18 by clipka@cli-pc-7

    trivial file header fix

Change 5915 on 2013/07/14 by chrisc@x8

    change headers to reflect AGPL; remove beta-test boilerplate

Change 5911 on 2013/06/23 by jgrimbert@smpdirect

    fixed typo in warp allocation: spherical warp would have been reported
    as cylindrical warp in case of leak or failure to allocate

Change 5908 on 2013/06/13 by jgrimbert@smpdirect

    corrected a segmentation fault that can occur when starting povray from
    within blender (unix specific)

Change 5907 on 2013/06/09 by jgrimbert@smpdirect

    addressing FS#294 splines are not thread safe

Change 5906 on 2013/05/13 by chrisc@x8

    integrate flohmuller branch to trunk

Change 5901 on 2013/04/21 by chrisc@x8

    integrate flohmuller branch to trunk

Change 5899 on 2013/04/18 by chrisc@x8

    integrate flohmuller branch to trunk

Change 5897 on 2013/04/17 by jholsenback@linux-c2bm

    updates to changes/revision files

Change 5896 on 2013/04/17 by chrisc@x8

    integrate flohmuller branch to trunk

Change 5890 on 2013/04/13 by jholsenback@linux-c2bm

    follow up to change #5889 corrected typo

Change 5889 on 2013/04/13 by jholsenback@linux-c2bm

    rename a distribution template file that had spaces in it's filename

Change 5884 on 2013/04/06 by clipka@cli-pc-7

    completed rollback of change #5876

Change 5883 on 2013/04/03 by jholsenback@linux-c2bm

    addressing FS#262 linux sources being compiled twice

Change 5882 on 2013/04/02 by clipka@cli-pc-7

    partical rollback of change #5876 (radiosity)

Change 5880 on 2013/03/31 by jholsenback@linux-c2bm

    follow up to change #5859 (consistency)

Change 5878 on 2013/03/30 by clipka@cli-pc-7

    follow up to change #5877 (minor comment update)

Change 5877 on 2013/03/30 by thorsten@thorsten-pc-2012

    moves some code to frontend, where it is needed

Change 5876 on 2013/03/30 by thorsten@thorsten-pc-2012

    adds back experimental warning for radiosity and adds experimental warning
    for gamma handling

Change 5867 on 2013/03/16 by clipka@cli-pc-7

    cleaned up our jpeg code to use the proper constants for the jpeglib's
    custom "boolean" type (we erroneously passed standard C++ bool constants
    instead, which could lead to compile errors on some systems)

Change 5859 on 2013/03/10 by jholsenback@linux-c2bm

    activate one message de-activate another

Change 5858 on 2013/03/10 by jholsenback@linux-c2bm

    suppress what appears to be a duplicate version related message

Change 5857 on 2013/03/08 by jholsenback@linux-c2bm

    bump unix VERSION to 3.7.0

Change 5856 on 2013/03/08 by jholsenback@linux-c2bm

    bump VERSION to 3.7.0

Change 5854 on 2013/03/08 by jholsenback@linux-c2bm

    rollback change #5843

Change 5853 on 2013/03/08 by jholsenback@linux-c2bm

    rollback change #5842

Change 5852 on 2013/03/08 by jholsenback@linux-c2bm

    rollback change #5841

Change 5851 on 2013/03/08 by clipka@cli-pc-7

    fixes for CID#967299 - CID#967301 resource leak

Change 5850 on 2013/03/08 by clipka@cli-pc-7

    fix for CID#967298 resource leak

Change 5849 on 2013/03/08 by jholsenback@linux-c2bm

    rollback change #5840

Change 5848 on 2013/03/08 by clipka@cli-pc-7

    fixes for CID#967302 and CID#967303 resource leak

Change 5846 on 2013/03/08 by clipka@cli-pc-7

    fixes FS#274 light source fading doesn't work properly with
    area_illumination and subsurface scattering

Change 5843 on 2013/03/06 by jholsenback@linux-c2bm

    addressing CID's# 967358-967362 Uninitialized variables 

Change 5842 on 2013/03/06 by jholsenback@linux-c2bm

    addressing CID's# 967337-967345 Uninitialized scalar variables 

Change 5841 on 2013/03/06 by jholsenback@linux-c2bm

    addressing CID's# 967333-967336 Uninitialized scalar variables 

Change 5840 on 2013/03/06 by jholsenback@linux-c2bm

    addressing CID# 967350 Uninitialized pointer read

Change 5820 on 2013/03/01 by clipka@cli-pc-7

    minor fix to radiosity statistics (octree samples/node)

Change 5819 on 2013/02/25 by clipka@cli-pc-7

    minor but effective changes to octree code for improved performance
    in radiosity-heavy scenes

Change 5816 on 2013/02/23 by jholsenback@linux-c2bm

    addressing CID #967264 non array delete used on array "str"

Change 5815 on 2013/02/23 by clipka@cli-pc-7

    fix for FS#271 (old behaviour is retained for pre-3.7 scenes)

Change 5814 on 2013/02/21 by clipka@cli-pc-7

    fixes a potential illegal memory access when reading a broken .pot
    (16-bit greyscale GIF) file, detected as Coverity issue CID #967365
    should also solve CID #967363 and #967364 along the way

Change 5812 on 2013/02/17 by chrisc@x8

    update source code readme.html

Change 5808 on 2013/02/17 by chrisc@x8

    fix unquoted path in shell extension registration and add registry key
    backups for uninstall

Change 5807 on 2013/02/14 by chrisc@x8

    minor setup tweak (windows version)

Change 5806 on 2013/02/14 by chrisc@x8

    update about box image (windows version)

Change 5805 on 2013/02/14 by chrisc@x8

    update keywords used for context-sensitive help (windows version)

Change 5804 on 2013/02/14 by chrisc@x8

    change copyright date to 2013

Change 5802 on 2013/02/12 by chrisc@x8

    update windows help file

Change 5801 on 2013/02/11 by chrisc@x8

    integrate flohmuller branch to trunk

Change 5796 on 2013/02/10 by jholsenback@linux-c2bm

    updates to changes/revision files

-----------------------------------
Changes between 3.7.RC6 and 3.7.RC7
-----------------------------------

Change 5795 on 2013/02/10 by chrisc@x8

    add Append_File INI option (same as +GP)

Change 5792 on 2013/02/09 by chrisc@x8

    follow up to #5786: write banner to stream each time we open for append,
    unless the stream is debug. without this it's often difficult to determine
    where a new render starts. we don't do this for the debug stream as we
    presume the user wants to format it as they see fit

Change 5791 on 2013/02/09 by chrisc@x8

    add Jerome Grimbert to contributing developer list

Change 5789 on 2013/02/07 by chrisc@x8

    update to insert menu from Friedrich Lohmueller

Change 5788 on 2013/02/06 by clipka@cli-pc-7

    addendum to change #5786

Change 5787 on 2013/02/06 by clipka@cli-pc-7

    fixed a portability issue of change #5784

Change 5786 on 2013/02/06 by thorsten@thorsten-pc-2012

    add +GP option, which allows users to append streamed console to
    existing console stream output file(s). Further, this option is now
    forced-on internally for the second frame of an animation,so output streams
    are appended. This has the side effect that the command-line option can
    be used to append all animation output to an existing file as well

Change 5784 on 2013/02/04 by clipka@cli-pc-7

    some minor code sanitizing

Change 5783 on 2013/02/04 by clipka@cli-pc-7

    added even more const modifiers to the code

Change 5782 on 2013/02/03 by clipka@cli-pc-7

    upgraded zlib to version 1.2.7 windows VS

Change 5778 on 2013/02/02 by clipka@cli-pc-7

    addendum to change #5777

Change 5777 on 2013/02/02 by clipka@cli-pc-7

    upgraded libpng and libjpeg to versions 1.5.14 and 9 respectively in
    windows VS

Change 5774 on 2013/02/02 by jholsenback@linux-c2bm

    conditionally filter indexentry tags from the unx and mac doc-sets, leaving
    them in the windows docs, as they are required to produce searchable
    index in chm file

Change 5773 on 2013/02/01 by chrisc@x8

    fix a few minor UI issues

Change 5772 on 2013/02/01 by jholsenback@linux-c2bm

    update changes/revision file for RC7

Change 5771 on 2013/02/01 by clipka@cli-pc-7

    fix for FS#270: render abort-continue (+C) sometimes skips blocks

Change 5770 on 2013/01/30 by clipka@cli-pc-7

    added plenty of const modifiers to the code; kicked out a few unused
    parameters and one piece of unused code

Change 5769 on 2013/01/30 by clipka@cli-pc-7

    a few signedness fixes in image handling code

Change 5768 on 2013/01/29 by clipka@cli-pc-7

    updated copyright information for some 3rd party libraries

Change 5767 on 2013/01/29 by jholsenback@linux-c2bm

    bump version to RC7 so unix build packages get branded properly

Change 5766 on 2013/01/29 by jholsenback@linux-c2bm

    updated changes/revision files

Change 5764 on 2013/01/29 by clipka@cli-pc-7

    a few whitespace fixes in revision.txt

Change 5763 on 2013/01/28 by chrisc@x8

    fix a long-standing bug where pressing 'pause' during a parse or render
    could sometimes put the frontend/backend sync into an unrecoverable state.

    the root cause was the fact that even if a call to the backend's pause
    method succeeds (e.g. the backend state correctly transitions to
    SceneData::Scene_Paused in the case of the parser), it is still possible
    for the task thread to move to Scene_Ready if the parser doesn't
    call Task::Cooperate() before finishing. the frontend code has until now
    assumed that if a call to e.g. RenderFrontend::PauseParser() succeeded,
    the parser would stay paused until told to resume or stop.

Change 5762 on 2013/01/28 by chrisc@x8

    add the proportion of the image in X and Y directions to the pixel offset
    displayed when the mouse hovers over the render window. e.g. if the mouse
    is at X=25 Y=50 of a 200x200 pixel render, the window title will
    show "25,50 [0.125,0.250]". this is to make it easier to work out
    row/column values for entering into the command-line for partial renders.

Change 5761 on 2013/01/28 by chrisc@x8

    add new option to prevent the system from sleeping whilst a render is in
    progress. by default this is selected.

Change 5760 on 2013/01/28 by chrisc@x8

    add an entry to the default tools menu to browse the sample scenes folder.

Change 5758 on 2013/01/28 by chrisc@x8

    add standard declares to the user keywords file.

Change 5757 on 2013/01/28 by chrisc@x8

    make the shortcuts placed on the desktop shorter, as windows usually hides
    the end of them.

Change 5755 on 2013/01/27 by chrisc@x8

    Fix for FS#150: Windows file association problems
    Fix for FS#224: Keyword Completion does not work for several names

    Various fixes/improvements to the way Windows INSTALL works and how the
    documents path is auto-detected if not specified

Change 5754 on 2013/01/27 by chrisc@x8

    Fix for FS#153: Error determining I/O permissions when using .ini file

Change 5753 on 2013/01/27 by chrisc@x8

    Fix for FS#232: illegal map_type usage reporting. Additionally parser also
    now issues an error for invalid interpolate values as well

Change 5751 on 2013/01/27 by chrisc@x8

    Bump benchmark version to 2.01. This is to avoid comparison with the 2.00
    used in various prior betas (primarily due to changes in the renderer
    rather than the benchmark itself)

Change 5750 on 2013/01/27 by clipka@cli-pc-7

    Replaced access declarations (already deprecated in C++98,
    dropped in C++11) with using declarations

Change 5748 on 2013/01/25 by chrisc@x8

    Adds a few more options to the editor tab right-click menu as suggested in FS#135

Change 5747 on 2013/01/24 by chrisc@x8

    Fix for FS#109: Debug_File no longer appends frame-by-frame debug data

Change 5746 on 2013/01/22 by clipka@cli-pc-7

    Fix for FS#267: Bug in "sor" primitive leads to random black
    artifacts in radiosity scenes 

Change 5745 on 2013/01/21 by clipka@cli-pc-7

    Minor changes to address issues uncovered by static code analysis

Change 5743 on 2013/01/20 by clipka@cli-pc-7

    Fix for FS#266: command line options in ini files don't accept quoted
    strings as parameters and other flaws found by means of static code
    analysis, plus minor code changes to aid in static code analysis

Change 5742 on 2013/01/19 by clipka@cli-pc-7

    Addressing CID#967224: Coverity static software analysis

Change 5741 on 2013/01/19 by clipka@cli-pc-7

    Addressing CID#967248: Coverity static software analysis

Change 5740 on 2013/01/19 by clipka@cli-pc-7

    Addressing CID#967249: Coverity static software analysis

Change 5739 on 2013/01/19 by clipka@cli-pc-7

    Addressing CID#967420: Coverity static software analysis

Change 5738 on 2013/01/11 by clipka@cli-pc-7

    Partial fix for FS#265 supress clang compilation warnings

Change 5732 on 2012/12/15 by clipka@cli-pc-7

    Follow-up: hotfix for #5731

Change 5731 on 2012/12/15 by clipka@cli-pc-7

    Fixed a bug in file-backed image container found by code review

Change 5730 on 2012/12/15 by clipka@cli-pc-7

    Housekeeping: indentations and comments

Change 5727 on 2012/11/12 by clipka@cli-pc-7

    As a follow-up to change #5719: added new source files to VS10 project

Change 5726 on 2012/11/12 by clipka@cli-pc-7

    Update to change #5710, to avoid hard-coding the value for boost::TIME_UTC
    aka boost::TIME_UTC_. Also renamed _TIME_UTC_ to POV_TIME_UTC for more
    robustness against any future naming conflicts.

Change 5725 on 2012/11/08 by clipka@cli-pc-7

    Unknown command line options didn't always produce an error;
    Also a fix for a minor flaw in string handling of INI settings

Change 5724 on 2012/11/01 by jgrimbert@smpdirect

    Fix for FS#257 (cannot find input file when resuming animation render)

Change 5718 on 2012/09/17 by clipka@cli-pc-7

    Fix a bug introduced with change #5665

Change 5716 on 2012/09/04 by chrisc@x8

    Assign .pov file association to POVWIN when installing.

Change 5715 on 2012/09/04 by chrisc@x8

    Fix for FS#238 (error during #read causes file to be kept open).

Change 5714 on 2012/09/04 by chrisc@x8

    Improve cloning of v3.6 INI and provide better defaults.

Change 5713 on 2012/09/03 by chrisc@x8

    Fix to handle filenames with a comma in them (crash report 419).

Change 5712 on 2012/09/02 by chrisc@x8

    Tweak the Windows setup file.

Change 5711 on 2012/09/02 by chrisc@x8

    Bump version to RC7.

Change 5710 on 2012/09/02 by chrisc@x8

    Fixed an issue caused by boost's change of TIME_UTC to TIME_UTC_.

Change 5708 on 2012/08/18 by jgrimbert@smpdirect

    Fix to get rid of the following compile warning on Linux variants:
    shape/poly.cpp:188:3: warning: this decimal constant is unsigned only in
    ISO C90 [enabled by default]

Change 5703 on 2012/08/05 by chrisc@x8

    Fix for benchmark thread vs CPU count.

Change 5699 on 2012/07/17 by clipka@cli-pc-7

    Fix for FS#249 (UTF-8 files with BOM not being accepted)

Change 5696 on 2012/07/10 by clipka@cli-pc-7

    Housekeeping (whitespace and comments)

Change 5695 on 2012/07/10 by clipka@cli-pc-7

    Fixed radiosity issues with "diffuse albedo" syntax

Change 5694 on 2012/07/10 by clipka@cli-pc-7

    Fix whitespace in screen.inc

Change 5689 on 2012/07/02 by thorsten@thorsten-pc-2012

    Adds back crand support.

Change 5688 on 2012/06/28 by jholsenback@linux-c2bm

    Addressing FS#247 set no_radiosity in Screen_Object()

Change 5687 on 2012/06/27 by jgrimbert@smpdirect

    Allow GD flag to work correctly (Fix FS#234): a typo.

Change 5685 on 2012/06/25 by clipka@cli-pc-7

    Follow up to #5678

Change 5684 on 2012/06/25 by clipka@cli-pc-7

    Update to #5678: workaround for fmod() apparently not conforming to C++
    standard on some linux machines.

Change 5678 on 2012/06/21 by clipka@cli-pc-7

    Fix for FS#233 Picture index out of range. - Fatal error in renderer:
    Uncategorized error.

----------------------------------------
Changes between 3.7.beta.RC5 and 3.7.RC6
----------------------------------------

Change 5674 on 2012/06/18 by jholsenback@linux-c2bm

    Pick up last minute changes before release of RC6

Change 5673 on 2012/06/18 by clipka@cli-pc-7

    Follow up fix for #5672 to address compile problems on linux platform.

Change 5672 on 2012/06/18 by clipka@cli-pc-7

    Fixed some numeric overflow issues in image handling; also fixed some
    other questionable code found along the way.

Change 5667 on 2012/06/16 by jholsenback@linux-c2bm

    Resync revsions/changes files.

Change 5665 on 2012/06/15 by chrisc@x8

    Potential fixes for a number of crash reports related to the editor,
    particularly drag & drop actions, and a fix for the XP64 installer.

Change 5663 on 2012/06/11 by clipka@cli-pc-7

    A minor fix for radiosity adc_bail_out handling.

Change 5662 on 2012/06/11 by clipka@cli-pc-7

    More comments changes and whitespace cleanup, plus some trivial code cleanup.

Change 5661 on 2012/06/11 by clipka@cli-pc-7

    A few comments changes and whitespace cleanup.

Change 5659 on 2012/06/10 by clipka@cli-pc-7

    A follow up to change #5649 corrected a formatting issue with radiosity
    statistics reporting.
 
Change 5653 on 2012/05/23 by jholsenback@linux-c2bm

    Fix for potential endless loop in CH2RGB macro

Change 5651 on 2012/05/22 by jholsenback@linux-c2bm

    Resync revsions/changes files.

Change 5650 on 2012/05/20 by chrisc@x8

    Fix merge issue from change #5387 which re-introduced a bug fixed earlier
    on (most recent crash report #385, dump file #343).

Change 5649 on 2012/05/20 by chrisc@x8

    Fix divide-by-zero in stats code when radiosity query count is 0
    (crash report #384, dump file #342)

Change 5648 on 2012/05/16 by clipka@cli-pc-7

    Additional fix associated with #5624 (colored transparent background)

Change 5636 on 2012/05/02 by jholsenback@linux-c2bm

    Resync revsions/changes files.

Change 5635 on 2012/05/02 by jholsenback@linux-c2bm

    Bump revision to RC6.

Change 5632 on 2012/03/21 by clipka@cli-pc-7

    Fix for FS#241: Photons not working correctly.

Change 5625 on 2012/03/10 by clipka@cli-pc-7

    Cleaned up various C-style casts:
    - fixed some fishy ones
    - removed some superfluous ones
    - replaced with reinterpret_cast some that were accidently casting away
      const qualifiers.
    - replaced with const_cast some that were deliberately casting away
      volatile qualifiers.
    - replaced with reinterpret_cast all others I spotted in the same files.
    - fixed some const qualifiers in function signatures.

Change 5624 on 2012/03/08 by clipka@cli-pc-7

    Fixed problems with colored transparent backgrounds.

Change 5623 on 2012/03/07 by chrisc@x8

    Updated setup script, plus a few improvements.

Change 5622 on 2012/03/07 by chrisc@x8

    Fixed the Windows help file searchable index. Note this is based on the
    snapshot of the wiki documentation set taken for RC4.

Change 5621 on 2012/03/03 by clipka@cli-pc-7

    Fixes to VS10 (windows version) build process
    - fixed ALL tiff project targets to build tiff config headers
    - fixed Debug/x64 target to build OpenEXR to Float

Change 5620 on 2012/02/28 by chrisc@x8

    Insert menu (windows version) update from Friedrich Lohmller.

----------------------------------------
Changes between 3.7.beta.RC4 and 3.7.RC5
----------------------------------------

Change 5618 on 2012/02/23 by jholsenback@linux-c2bm

    Bump to RC5 in the "correct" place

Change 5617 on 2012/02/23 by jholsenback@linux-c2bm

    Resync changes/revision.txt files

Change 5616 on 2012/02/23 by jholsenback@linux-c2bm

    Bump unix version to RC5

Change 5615 on 2012/02/23 by jholsenback@linux-c2bm

    Fix for FS#239 improper uid/gid handling incorrectly branded some files
    during non elevated privilege builds.

Change 5614 on 2012/02/23 by clipka@cli-pc-7

    Fix for crashdump #357 (triggered by non-closed SSLT-enabled
    mesh inside CSG)

Change 5612 on 2012/02/21 by chrisc@x8

    Make dump submitter a bit more robust.

Change 5610 on 2012/02/21 by clipka@cli-pc-7

    Fix for FS#12 (facets pattern in normal map)

Change 5607 on 2012/02/05 by chrisc@x8

    More installer work, should be more or less done now.

----------------------------------------
Changes between 3.7.beta.RC3 and 3.7.RC4
----------------------------------------

Change 5606 on 2012/02/04 by chrisc@x8

    Fix to FMA4 detection. AMD optimizations re-enabled.

Change 5604 on 2012/01/28 by jgrimbert@smpdirect

    Fix for FS#235 UNIX segmentation fault: when using the animation loop
    and large images are displayed.

Change 5603 on 2012/01/03 by chrisc@x8

    Updated the windows help file.

Change 5601 on 2011/12/28 by chrisc@x8

    Changed message displayed on crash.

Change 5600 on 2011/12/27 by chrisc@x8

    Initial version (windows) of NSIS-based installer.

Change 5597 on 2011/12/24 by chrisc@x8

    Added AMD optimizations for noise. Note that these are currently disabled.

Change 5596 on 2011/12/24 by chrisc@x8

    Updated the crashdump submitter.

Change 5593 on 2011/12/20 by chrisc@x8

    Add support for documents path to be anywhere, rather than requiring it to
    be in a standard location.

Change 5590 on 2011/12/19 by chrisc@x8

    Changed the windows crash reporting tool dump generation logic to always
    generate both full and mini dumps.

Change 5589 on 2011/12/15 by jholsenback_aries_1

    Removed obsolete comments (Library Path limitation)

Change 5588 on 2011/12/08 by clipka@cli-pc-7

     Added "Console" and "Console-SSE2" configurations to VS10 solution and
     some projects, and updated config & console code, to get Windows console
     project back working (needs to be back-ported to VS8 and VS9; no debug
     configuration yet); extensive testing required; expect shellout to be
     still dysfunctional.

Change 5587 on 2011/12/08 by clipka@cli-pc-7

    Updates to VS10 console project (still doesn't build at present though)

Change 5582 on 2011/12/05 by clipka@cli-pc-7

    Added Penrose P1 (N=6) and P2 (N=2) tilings as 25 and 26; changed the
    existing P3 tiling pattern number to 27

Change 5575 on 2011/12/03 by clipka@cli-pc-7

    Overhauled identifiers & comments in new patterns' code; Added a new
    "tiling" pattern: 25 type (N=2) produces a Penrose P3 tile

Change 5573 on 2011/12/02 by clipka@cli-pc-7

    Added support for tuning brightness of image-mapped sky spheres. See FS#9

Change 5572 on 2011/12/02 by clipka@cli-pc-7

   area_illumination now also respects fade_power and fade_distance. See FS#46

Change 5569 on 2011/12/01 by clipka@cli-pc-7

   major overhaul of iridescence feature

Change 5529/5528/5527 on 2011/11/22 by clipka@cli-pc-7

   added new "albedo" keyword, that can be used right after
   "diffuse", "phong" or "specular

Change 5518 on 2011/11/13 by chrisc@x8

   fix for the windows editor crash that was reported in crashdump#111

Change 5514 on 2011/11/13 by jgrimbert@smpdirect

   fix for FS#216: comment out the Radiosity= directive in raddem.ini 
   that directive became obsolete in 3.7

Change 5512 on 2011/11/12 by clipka@cli-pc-7

   fix for FS#225: translating a light source fails to translate
   the looks_like textures

Change 5511 on 2011/11/11 by clipka@cli-pc-7

   update of VS 2010 solution & projects: windows build can now statically link
   boost and openEXR libraries built from scratch

Change 5510 on 2011/11/11 by clipka@cli-pc-7

   update to add openEXR include directory tree for installation from source

Change 5509 on 2011/11/11 by clipka@cli-pc-7

   added VS 2010 projects to build boost_date_time, boost_thread and
   openEXR-related projects (not included in solution yet)

Change 5508 on 2011/11/11 by clipka@cli-pc-7

	 a logistics rollback of source/base/image/openexr.cpp and
   vfe/win/compilers/msvc.h (checked them in too early)

Change 5505 on 2011/11/11 by clipka@cli-pc-7

  added source trees for boost (subset of 1.45.0)
  and openEXR (subset of 1.6.1 with subset of IlmBase 1.0.1)

Change 5502 on 2011/11/05 by clipka@cli-pc-7

  fixed issue that caused Visual Studio 2010 to always consider
  povbackend to be outdated

Change 5501 on 2011/11/05 by clipka@cli-pc-7

  removed unused functions from vfe/win/syspovconfig.h that kept generating
  type conversion warnings

Change 5500 on 2011/11/05 by clipka@cli-pc-7

  some fixes to VS 2010 projects:
  - fixed tiff project to build tiff config headers
  - properly added subsurface.h and subsurface.cpp to povbackend project

Change 5499 on 2011/10/29 by clipka@cli-pc-7

  updating these files without change, in hope that an update of the RSC
  keywords will fix the files from always popping up in
  "reconcile offline work"

Change 5497 on 2011/09/22 by clipka@cli-pc-xp64

  fix for FS#221 "Undefined looks_like object causes hard crash"

Change 5490 on 2011/09/14 by clipka@cli-pc-xp64

  made POV_FREE macro safer to use

Change 5489 on 2011/09/14 by clipka@cli-pc-xp64

  another fix for #5487

Change 5488 on 2011/09/13 by clipka@cli-pc-xp64

  fix for stuff broken by #5487

Change 5487 on 2011/09/12 by clipka@cli-pc-xp64

  reverted changes #5474 and #5477 and implemented new fix for FS#208; local
  identifiers can now be passed out of macros without limitation.

Change 5486 on 2011/09/08 by jholsenback@jholsenback_aries

  Resync changes and revision files with recent activities

Change 5485 on 2011/09/06 by chrisc@x8

  Bump version to RC4

Change 5483 on 2011/08/28 by jgrimbert@smpdirect

  Update of benchmark.cpp related to #5480, #5477 and #5474

Change 5482 on 2011/08/25 by clipka@cli-pc-xp64

  Follow up to change #5443 to retain a TODO comment

Change 5481 on 2011/08/25 by clipka@cli-pc-xp64

  Follow up to change #5336 fixing FS#185

Change 5480 on 2011/08/22 by jgrimbert@smpdirect

  Follow up to #5474 and #5477 to avoid a second error message

Change 5479 on 2011/08/19 by clipka@cli-pc-xp64

  Rolled back change #5470 (due to undesired side effects) and implemented
  new fix for FS#165

Change 5478 on 2011/08/19 by clipka@cli-pc-xp64

  Scene file update (follow up to #5475)

Change 5477 on 2011/08/19 by jgrimbert@smpdirect
  
  Fix a regression of 5474 (returning a local colour, vector or float symbol
  (or any expression based on it) is not a problem, the symbol can be deleted
  as the value(s) are already copied in safe zone.

Change 5475 on 2011/08/18 by jgrimbert@smpdirect

  Fix to scene file to not return a #local directly from a #macro:
  - Related to change #5474 and FS#208: multiply #local by 1.

Change 5474 on 2011/08/18 by jgrimbert@smpdirect

  Fix addressing FS#208:
  - Detects deletion of current symbol and reports the error

Change 5470 on 2011/08/15 by jgrimbert@smpdirect

  Fix addressing FS#165:
  - The radius of the shooting cone was adjusted to include the whole sphere

Change 5468 on 2011/08/14 by jgrimbert@smpdirect

  - Enhanced "Photon message reporting" to address FS#190
  - Correction for segfault introduced in change #5467

Change 5467 on 2011/08/14 by jgrimbert@smpdirect

  Follow up to FS#169 memory leak:
  - Fixed the leak of 2 photon maps per frame to render. Became huge with
  the animation FS#169 used (1189 frames) leak was about 9 gigabytes on
  64 bit system.

Change 5465 on 2011/08/13 by jgrimbert@smpdirect

  Fix to avoid duplication of error message in parser reported in FS#215

Change 5460 on 2011/07/15 by jgrimbert@smpdirect

  Added a dump of the command line (unix only) when command-line option parsing
  error is reported. This addressess FS#214 which was due to an alias that
  would have been undetected without insight about an alias being used.

Change 5457 on 2011/06/26 by jholsenback@jholsenback_aries

  Finalized user contributed (jgehrcke) addressing FS#213

Change 5456 on 2011/06/24 by jholsenback@jholsenback_aries

  Corrections to fix introduced in change #5455

Change 5455 on 2011/06/24 by jholsenback@jholsenback_aries

  User contributed fix addressing endless loop condition reported in FS#213

Change 5453 on 2011/06/13 by jgrimbert@smpdirect

  Changed -V in unix option to --V (-version) to avoid conflict with
  -V (verbose) from core that was reported in FS#204

Change 5451 on 2011/06/04 by clipka@cli-pc-xp64

  Follow up to change #5450:
  - removed now obsolete SceneThreadData members

Change 5450 on 2011/06/04 by clipka@cli-pc-xp64

  Fix for UV mapping broken for parametric reported in FS#210

Change 5449 on 2011/06/02 by clipka@cli-pc-xp64

  A fix for "Cannot open file" error reported in FS#206
  - When text output files specified in INI) and added a few comments to path.h
  and path.cpp. Current solution allows arbitrary file names for output stream
  files; code for changing this to accept only "plain" file names is also
  provided but currently disabled

Change 5448 on 2011/06/02 by jgrimbert@smpdirect

  Follow up to change #5447:
  - Fix a valgrind complaint about reading uninitialised data
  in renderfrontend.cpp
  - Fix the issue with textures during tesselation with tessel{} and
  tesselate{} that was crashing at render time if a vertex was not textured due
  to using default texture on original object

Change 5447 on 2011/06/02 by jgrimbert@smpdirect

  Fix for computation of weighted textures problem reported in FS#209

Change 5446 on 2011/06/02 by clipka@cli-pc-xp64

  Improved error message output when text in-/output files cannot be opened

Change 5444 on 2011/06/02 by clipka@cli-pc-xp64

  Minor formatting cleanup to tiling.pov

Change 5443 on 2011/05/29 by jgrimbert@smpdirect

  Temporary fix for quick_color problem reported in FS#166
  - Moved the setting of qualityFlags into the constructor of the TraceTask,
  to avoid its value being overriden by the constructor of Radiosity

Change 5440 on 2011/05/22 by jgrimbert@smpdirect

  Add check for DF3 file without size FS#156

Change 5438 on 2011/05/19 by clipka@cli-pc-xp64

  Fix for Radiosity artifacts at low error_bound FS#203

Change 5437 on 2011/05/19 by jholsenback@jholsenback_aries

  A follow up to change #5436

Change 5436 on 2011/05/18 by jholsenback@jholsenback_aries

  A user contributed fix to the HFCreate_ (shapes.inc) macro

Change 5435 on 2011/05/09 by jholsenback@jholsenback_aries

  Suppress "bound_by" warnings when Bevelled_Text (shapes.inc) macro is called

Change 5433 on 2011/04/11 by clipka@cli-pc-xp64

  Fix for Calibri TrueType font garbled FS#200

Change 5431 on 2011/04/02 by jholsenback@jholsenback_aries

  Corrected scene file typos reported in FS#199

Change 5430 on 2011/03/21 by jholsenback@jholsenback_aries

  ~scenes/textures/patterns/tiling.pov now has the capability to conditionally
  write it's color_map to a text file.

Change 5428 on 2011/03/20 by clipka@cli-pc-xp64

  Subsurface scattering improvements:

  - added syntax to global subsurface block:

  global_settings { subsurface { radiosity BOOL } }

  specifies whether subsurface light transport effects should be applied to
  incoming radiosity-based diffuse illumination; if this setting is
  off (default), subsurface light transport effects will only be applied to
  direct illumination from classic light sources. Setting this to on will
  improve realism especially for materials with high translucency, but at a
  significant cost in rendering time.

  - added syntax to global radiosity block:

  global_settings {  radiosity { subsurface BOOL } }

  specifies whether radiosity sampling should honor subsurface light transport;
  if this setting is off (default), radiosity-based diffuse illumination is
  computed as if the surrounding objects had subsurface light transport turned
  off. Setting this to on may improve realism especially in the presence of
  materials with high translucency, but at some cost in rendering time.

  - Subsurface scattering is disabled in all quality levels except +Q9
  or higher.

  - More thorough fix to complement change #5425.

  - Minor changes to reduce intensity of patterned noise artifacts on
  subsurface textures.

Change 5425 on 2011/03/19 by jholsenback@jholsenback_aries

  added a temporary trap for certain subsurface conditions

Change 5424 on on 2011/03/19 by clipka@cli-pc-xp64

  change to mitigate banding with dark subsurface pigments

Change 5422 on on 2011/03/14 by clipka@cli-pc-xp64

  change to fix a no-op -J option

Change 5421 on on 2011/03/14 by clipka@cli-pc-xp64

  change to fix memory access violation when closing braces in a funtion
  were missing

Change 5418 on 2011/03/06 by jholsenback@jholsenback_aries

  added two scene files to the distribution

Change 5414 on 2011/02/27 by jgrimbert@experiment

  change +IM command line option to +MI

Change 5413 on 2011/02/25 by clipka@cli-pc-xp64

  change to mitigate problems introduced in change 5411

Change 5412 on 2011/02/25 by clipka@cli-pc-xp64

  updated subsurface scattering sample scene

Change 5411 on 2011/02/25 by clipka@cli-pc-xp64

  update SSLT code (various fixes and radiosity)

Change 5410 on 2011/02/25 by clipka@cli-pc-xp64

  changes to improve robustness regarding low translucency and/or high
  mm_per_unit settings for objects in general and blobs in particular
  added support for CSG (caveat: unions of overlapping components will cause
  unexpected results; use merge instead)

Change 5408 on 2011/02/21 by clipka@cli-pc-xp64

  bugfixes & improvements to SSLT code;
  syntax for material definition has changed as follows:

  texture {
    pigment { PIGMENT }
    finish { ...
      subsurface { translucency COLOR }
    }
  }
  interior { ior FLOAT }

  The pigment determines the SSLT material's overall appearance when applied
  to an object with sufficiently large structures. The translucency color
  (which can alternatively be a float) determines the strength of the
  subsurface light transport effect (note that the values may be >1.0; also
  note that the effect doesn't scale with the object; instead, to adjust
  materials to the dimensions of your scene, use the global mm_per_unit
  setting). The material's index of refraction also affects the appearance of
  the material, and is mandatory for SSLT materials.

  SSLT is now enabled only when a global_settings subsurface block is present;
  to enable SSLT but use the default settings, specify an empty block,
  i.e. "subsurface{}"

  Due to the experimental status of SSLT, there are currently some caveats:
  - Incorrect use may result in hard crashes instead of parse warnings.
  - Pigments having any zero color components currently don't play nice with
  SSLT; for example instead of "rgb 1" you should use something like
  "rgb <1,0.05,0.05>". Use at your own risk!

Change 5407 on 2011/02/21 by jholsenback@jholsenback_aries

  Added these user contributed mesh_camera scene files to:
  ~scenes/camera/mesh_camera/ess

  ess-ortho-camera.pov
  ess-persp-camera.pov
  ortho-camera.pov
  persp-camera.pov

Change 5405 on 2011/02/15 by clipka@cli-pc-xp64

  fixed bug causing "../../" in file paths to be stripped.

Change 5404 on 2011/02/13 by clipka@cli-pc-xp64

  changed list of experimental features: removed radiosity, added subsurface
  light transport

Change 5400 on 2011/02/08 by clipka@cli-pc-xp64

  fix for using interpolated image_maps in functions results in pixel-sized
  dot-artifacts

Change 5398 on 2011/01/24 by jholsenback@jholsenback_aries

  - A change to rewrite the 'ref=' tag as 'id=' in function GetAnchorInfo
  - Changes in the function GetMDHash to support two image formats so they BOTH
    can be recognized during migtation to the new format. 
  - A trap was added to alert if an unsupported image format is encountered.

----------------------------------------
Changes between 3.7.beta.RC2 and 3.7.RC3
----------------------------------------

Change 5391 on 2011/01/19 by chrisc@x8

  update windows help file.

Change 5390 on 2011/01/19 by chrisc@x8

  update windows insert menu.

Change 5389 on 2011/01/19 by chrisc@x8

  Bump version to RC3.

Change 5388 on 2011/01/18 by chrisc@x8

  add statusbar tooltip for windows version, primarily to allow full status 
  message to be shown on hover if its status bar section is too small.

Change 5387 on 2011/01/17 by chrisc@x8

  merge changes 5382 and 5384 from jgrimbert branch to trunk, with modifications 
  to suit.

  This adds a new INI parameter called Max_Image_Buffer_Memory (+IM), which 
  gives the number of megabytes of RAM to allow for output image caching.
  
  If the output image would use more than this, a file backed temporary image 
  is used instead. If not specified, it defaults to 128mb.

Change 5386 on 2011/01/17 by chrisc@x8

  since cooperate() is currently very low-impact, call it for every primary ray 
  as well as every 16th ray.

Change 5385 on 2011/01/17 by chrisc@x8

  Don't create the in-memory output image if image output is turned off.

Change 5384 on 2011/01/16 by jgrimbert@experiment [jgrimbert branch]

  I/O bottleneck, after benchmark: code rewrite from fs#180, ready to get some 
  parameters (from povray.ini) as soon as a way is possible.
  
  Previous code kept under #ifdef, new code in #else; Clean-up up to code managers.
	
  Issues fixed from fs#180: height*weight not matching blocksize, removed 
  gigantic vector of bool, removed assumed wrong optimisation about small 
  width. Also fixed the flag for the open() call (granting only read & write to 
  the user so far)
	
  Added meta information for 3rd party: at the end of the file/pixel array, 
  (use seek(END, -3*sizeof(size_type)) to get ready to read them)), 3 size_type 
  values: size of a pixel in byte, witdh & height.
	
	Committed for next urgent RC.

Change 5383 on 2011/01/15 by nkopp@cc-devel-test

  Fix bug that occasionally caused a crash in scenes with media (the bug was 
  introduced by an earlier refactoring)

Change 5382 on 2011/01/11 by jgrimbert@experiment [jgrimbert branch]

  Remove the I/O bottleneck (it's even worse than that) due to storing the 
  pixels in progress in a file whenever the rendering dimension is big enough. 
  The cost is 64 lines of data cache instead of 1 line. (as long as +BS is not 
  bigger than 64 (better with 32) and that the order of block rendering is per 
  line (as it is per default, so change at your own risk with big images))

Change 5381 on 2011/01/11 by jholsenback@jholsenback_aries

  two FixTags additions to filter out indexentry and sectiondesc tags because they aren't need anymore.

Change 5380 on 2011/01/10 by jholsenback@jholsenback_aries

  a fix to remove an extra closing div tag exposed by html validation

Change 5378 on 2011/01/09 by jholsenback@jholsenback_aries

  deleted old header info (my bad) to scene files

Change 5377 on 2011/01/09 by jholsenback@jholsenback_aries

  author updates and additions to scene files

Change 5376 on 2011/01/09 by jholsenback@jholsenback_aries

  remove obsolete scene files. author contributed replacements to follow.

Change 5375 on 2011/01/09 by jholsenback@jholsenback_aries

  FixTags addition to clobber "<" and ">" with escaped html versions. Most of 
  the offenders occurred in pre blocks where vectors were being represented. My 
  guess is someone just copy and pasted direct from a scene file into the 
  original html docs.

Change 5372 on 2011/01/08 by jholsenback@jholsenback_aries

  more extra or missing tag fixes that caused html validation errors

Change 5371 on 2011/01/08 by jholsenback@jholsenback_aries

  fixed misplaced opening table row tags that were causing html validation 
  errors (3 places)

Change 5365 on 2011/01/07 by chrisc@x8

  add boost/function.hpp to povray.h to fix compilation issues on some unix 
  systems.

---------------------------------------
Changes between 3.7.beta.41 and 3.7.RC2
---------------------------------------

Change 5360 on 2011/01/06 by chrisc@x8

  updates to SimpleVector usage to allow easy declaration of limits in platform 
  include files. also increase default sizes.

Change 5350 on 2011/01/05 by clipka@cli-pc-xp64

  fix FS#188 (no_reflection broken)

Change 5347 on 2011/01/05 by chrisc@cc-ubuntu-test

  fix signal handling issue reported in FS#187.

Change 5346 on 2011/01/05 by chrisc@x8

  bump version to RC2.

Change 5343 on 2011/01/04 by clipka@cli-pc-xp64

  fixed bug FS#186; parser will now adjust sub-polygon end points to exactly 
  match the start points.

Change 5342 on 2011/01/04 by chrisc@x8

  disable full memory allocation tracking on windows in favor of rougher 
  estimate based on samples of peak memory usage from windows API. also some 
  other misc changes to windows code.

Change 5341 on 2011/01/04 by chrisc@x8

  fix crash found by crashdump #77 (platform base can be NULL before the image 
  class gets destroyed in the case of unusual shutdown).

Change 5340 on 2011/01/04 by chrisc@x8

  fix crash in editor where FormatMessage() fails. refer crashdump #76.

Change 5339 on 2011/01/04 by clipka@cli-pc-xp64

  fixed gamma showcase scene

Change 5338 on 2011/01/04 by chrisc@x8

  update about box to read 2011, also fix some mis-alignment and other small issues.

Change 5337 on 2011/01/04 by nkopp@cc-devel-test

	Minor refactoring of media+photon code

Change 5336 on 2011/01/03 by clipka@cli-pc-xp64

  fixed FS#185 (wrong message about image resolution)

Change 5335 on 2011/01/03 by clipka@cli-pc-xp64

  fix for FS#184 (Too many pretrace steps when pretrace_start < pretrace_end).
	A parse error will now be generated if pretrace_start < pretrace_end.

Change 5333 on 2011/01/02 by chrisc@x8

  add windows help file.

Change 5330 on 2011/01/02 by chrisc@x8

  updated insert menu files.

Change 5329 on 2011/01/02 by chrisc@cc-ubuntu-test

  add in very basic support for running shell-outs on unix.

Change 5325 on 2011/01/01 by chrisc@x8

  hack around shellout permission issue in unix version (use a global for the meantime). untested.

Change 5323 on 2011/01/01 by chrisc@x8

  update built-in win demo scene for 3.7.

Change 5322 on 2011/01/01 by chrisc@x8

  removing beta status, moving to RC. no more timeouts.

Change 5321 on 2011/01/01 by chrisc@x8

  benchmark results on windows are now copied to the clipboard.

Change 5320 on 2011/01/01 by chrisc@x8

  a few changes due to observations made during analysis of crash dumps. no 
  ultimate cause for crashes involved yet determined due to insufficient 
  information in the minidump.

Change 5316 on 2011/01/01 by chrisc@x8

  some work on photon statistics.

Change 5315 on 2011/01/01 by chrisc@cc-devel-test

  Photon fixes from Nathan.

Change 5313 on 2010/12/30 by clipka@cli-pc-xp64

  using "color srgb" (or similar) before assumed_gamma was defined resulted in 
  a hard crash; fixed by generating a proper parse error instead.

Change 5312 on 2010/12/29 by clipka@cli-pc-xp64

  modified radiosity3.pov tutorial scene to use more realistic surface finish

Change 5311 on 2010/12/28 by clipka@cli-pc-xp64

  updated scenes that will feature in the radiosity tutorial, to be more 
  fitting for POV-Ray 3.7

Change 5310 on 2010/12/28 by jholsenback@jholsenback_aries

  changes to suppress assumed_gamma warnings

Change 5308 on 2010/12/28 by jholsenback@jholsenback_aries

  release changes #version and assumed_gamma

Change 5307 on 2010/12/28 by chrisc@x8

  make windows status pane a bit wider and add process memory usage slot in 
  status bar.

Change 5306 on 2010/12/28 by chrisc@x8

  fix memory leak.

Change 5305 on 2010/12/27 by chrisc@x8

  go back to using the current version as the default language version and 
  modify the warning messages associated with a missing or late #version.

Change 5303 on 2010/12/27 by clipka@cli-pc-xp64

  last-minute backward compatibility update:
	
  Gamma Handling:
	
    The assumed_gamma keyword is no longer deprecated; to the contrary, it is 
    now considered mandatory if a #version 3.7 or higher is specified, and its 
    absence will raise a "possible error" in this case, with a value of 1.0 being 
    presumed. (Note that #version, too, is now mandatory, and its absence will 
    raise a warning as well).
	
    The assumed_gamma value is now presumed to denote the "working color 
    space", in which classic color literals are specified and color 
    computations to be performed. Note however that this will give unrealistic 
    results for any value other than 1.0.
	
    Colors specified using "srgb" & co. will be converted from sRGB to the 
    working color space.
	
    image_map input files for which definitive implicit or explicit gamma 
    information is available (either by file format specification like the HDRI 
    formats, header information like PNG with sRGB or gAMA chunk, or a user 
    override via the "gamma" keyword) will be converted to the working color 
    space. If no definitive information is available, the respective files will 
    be presumed to match assumed_gamma if #version is < 3.7 or unspecified, or 
    any official recommendation if #version >= 3.7 is specified.
	
    height_field, bump_map and image_pattern input files will not be subject to 
    gamma-adjustment, unless the user explicitly specifies an override via the 
    "gamma" keyword; in that case, the file is presumed to match the gamma 
    value specified, and converted to linear values, irrespective of 
    assumed_gamma.
	
  Concerning anti-aliasing, for the decision whether to anti-alias the color 
  values will be converted from the working color space to that specified by 
  the Assumed_Gamma INI setting; the averaging of the samples however will be 
  performed in the working color space.
	
    For render preview, the generated image will be converted from the working 
    color space to that specified by the Display_Gamma setting. If 
    Display_Gamma is not specified, a platform-specific default will be 
    presumed.
	
    For file output, the generated image will be converted from the working 
    color space to whatever the file format mandates (this applies to OpenEXR 
    and Radiance HDR); if no such mandatory color space exists, the image will 
    be converted into that specified by the File_Gamma setting. If File_Gamma 
    is not specified either, the image will be converted into whatever is 
    officially recommended for that file format, or the de-facto standard; if 
    even that doesn't exist, no gamma adjustment is performed. In any case, if 
    the file format provides a means to specify a gamma in the image header 
    (this applies to PNG), the respective data is set according to whatever 
    gamma the image is converted to, regardless of the working color space.
	
    If assumed_gamma is not specified, and #version is set to pre-3.7 or 
    undefined, no gamma handling is performed at all.
	
	In terms of backward compatibility, this translates as follows:
	
    If assumed_gamma is not specified, and #version is set to pre-3.7 or 
    undefined, full compatibility with 3.6 and earlier is maintaned.
	
    If assumed_gamma is specified and #version is set to pre-3.7 or undefined, 
    compatibility with 3.6 is subject to the following restrictions: (a) full 
    output file handling compatibility requires File_Gamma to be set to the 
    same value as Display_Gamma (or left undefined if Display_Gamma is 
    undefined), and (b) input file handling is not backward compatible in case 
    of PNG files.
	
    If assumed_gamma is not specified and #version is set to 3.7 or higher, 
    compatibility with 3.6 or earlier is not maintained.
	
--------------------------------------------
Changes between 3.7.beta.40 and 3.7.beta.41
--------------------------------------------

Change 5286 on 2010/12/20 by chrisc@x8

  fix code list control appearing on primary monitor while povwin is on non-primary monitor.
	make render window sanity check smarter with respect to multiple monitors.
	add INI keywords to highlight list for editor.

Change 5282 on 2010/12/20 by clipka@cli-pc-xp64

  last-minute update to colour syntax for gamma pre-corrected colours; dropped 
  the "gamma" keyword there (it remains enabled for image input files) in favor 
  of the following syntax:
	
	    colour srgb <Rp,Gp,Bp>
	    colour srgbt <Rp,Gp,Bp,T>
	    colour srgbf <Rp,Gp,Bp,F>
	    colour srgbft <Rp,Gp,Bp,F,T>
	
  where Rp,Gp,Bp are colour component values pre-corrected for a display 
  conforming to the sRGB colour space, and F,T are linear colour component 
  values.

Change 5280 on 2010/12/20 by chrisc@x8

  update benchmark INI file to reflect removed/added options. update 
  compiled-in benchmark file to match one in distribution.

Change 5279 on 2010/12/20 by chrisc@x8

  implement requirement for "#version 3.7" to be provided to obtain full v3.7 functionality.
	prior to a #version statement appearing, the version defaults to 3.62.
  additionally, if the first #version appears after any other declaration, or 
    #version does not appear at all, a post-parse warning is issued.

Change 5277 on 2010/12/20 by chrisc@x8

  default to boost::thread_specific_pointer for taskDataPtr with compilers that don't support native TLS.

Change 5276 on 2010/12/20 by chrisc@x8

  integrate changes 5273 and 5275 from jgrimbert branch to trunk.
	
	  5275: comment out dead (and bogus) code in Poly object, raising max order to 35 because 15 was too small
	        (someone needed a 16th order), and add a new syntax to describe a polynomial equation (it's an addition,
	        the old way is kept):
	
	  5273: fs#179 proposal for simple fix (tested) to missing $HOME

Change 5275 on 2010/12/19 by jgrimbert@experiment

  comment out dead (and bogus) code in Poly object, raising max order to 35 
  because 15 was too small (someone needed a 16th order), and add a new syntax 
  to describe a polynomial equation (it's an addition, the old way is kept):
	
    polynomial { <order>, [xyz(<a>,<b>,<c>):<value>,]* [remaining as usual for poly]}
	
	Default value for all coefficient is 0.0;
	each xyz(): set the coefficient to <value> for x^a.y^b.z^c;
	(constant is xyz(0,0,0)). Ordering of xyz is irrelevant (but identical index keep only the last one)
	a sphere (radius 1...  x^2 + y^2 + z^2 -1 =0)
	polynomial{ 2, xyz(2,0,0):1, xyz(0,2,0):1, xyz(0,0,2):1, xyz(0,0,0):-1 }

Change 5274 on 2010/12/19 by clipka@cli-pc-xp64

  fix bug FS#182 (multi-textured blobs in intersections / differences broken)

Change 5273 on 2010/12/15 by jgrimbert@experiment

  fs#179 proposal for simple fix (tested) to missing $HOME

Change 5271 on 2010/12/15 by clipka@cli-pc-xp64

  changed the mechanism to retrieve & format the current time from SDL; new 
  syntax is as follows:

    - The keyword "now" evaluates to the time elapsed since 2000-01-01, 00:00:00 
      GMT in days, with a precision of seconds or better.
  
    - The function "datetime(FLOAT [,STRING])" interprets the FLOAT as days 
      since 2001-01-01, 00:00:00 GMT, and the STRING as a formatting string (same 
      format and default as was previously taken by "now([STRING])").
  
  Consequently, "datetime(now)" does what previously "now()" did, and 
  "datetime(now,STRING)" does what previously "now(STRING)" did.

Change 5270 on 2010/12/15 by chrisc@x8

  deprecate histogram output. some fixes to create_ini output.

Change 5268 on 2010/12/15 by chrisc@x8

  insert menu render fixes.

Change 5267 on 2010/12/15 by chrisc@x8

  avoid crash condition in editor find/replace if memory allocation fails.

Change 5266 on 2010/12/14 by jholsenback@jholsenback_aries

  follow up to address compilation error introduced with change #5261

Change 5265 on 2010/12/14 by chrisc@x8

  see if this fixes the fseek64 issue on linux.

Change 5264 on 2010/12/14 by chrisc@x8

  better handling of bad alloc and runtime error exceptions during message 
  processing (don't pass them up to the main thread).

Change 5263 on 2010/12/14 by chrisc@x8

  work around double-free causing memory corruption and later crash when create 
  scene (or probably any POVMS callback function) threw an exception.

Change 5262 on 2010/12/14 by chrisc@x8

  make windows frontend more aware of backend failures.

Change 5261 on 2010/12/14 by chrisc@x8

  change main thread and povray init to accept a callback to notify when the 
  main thread exits. this is needed to make sure the front end knows of a 
  premature exit of the backend thread and to avoid using the (now deleted) 
  message queue.

Change 5260 on 2010/12/14 by chrisc@x8

  POVMS_Send now reports a timeout when one happens.

Change 5258 on 2010/12/12 by clipka@cli-pc-xp64

  Added new include file, "ior.inc", defining ior & dispersion constants for a 
  lot of materials.

Change 5257 on 2010/12/12 by clipka@cli-pc-xp64

  Added new sample/test scene, "scenes/gamma/gamma_showcase.pov" (used in new 
  gamma section in the docs)

Change 5256 on 2010/12/11 by clipka@cli-pc-xp64

  disabled #default { image_map { gamma ... } } statement; may be re-enabled in 
  future versions, probably with a different syntax

Change 5255 on 2010/12/10 by jholsenback@jholsenback_aries

  re-enable show_clouds in the builtin benchmark scene

Change 5254 on 2010/12/09 by clipka@cli-pc-xp64

  Display gamma handling was broken in two places; fixed.

Change 5253 on 2010/12/09 by jholsenback@jholsenback_aries

  remove obsoleted code (image_map gamma)

Change 5252 on 2010/12/09 by jholsenback@jholsenback_aries

  remove obsoleted code (image_map gamma)

Change 5251 on 2010/12/09 by clipka@cli-pc-xp64

  Fixed metadata time zome bug introduced with #5210 (see FS#64 comments); 
  POV-Ray will now write proper Zulu time into the metadata again.

Change 5234 on 2010/12/04 by clipka@cli-pc-xp64

  added dither method information to options output

Change 5233 on 2010/12/04 by clipka@cli-pc-xp64

  Fixed a few flaws that caused the dither INI options & command line parameter 
  to not work properly; added dither support for Radiance HDR

Change 5232 on 2010/12/04 by clipka@cli-pc-xp64

  Dithering Support / Gamma Improvements / Code Refactoring:
	
    Add support for output file dithering; dithering is controlled by the INI 
    file settings "Dither=BOOL" and "Dither_Method=xx" as well as the command 
    line option "+/-THxx", where xx is one of:
	
    "B2".."B4": Bayer pattern dithering using 2x2, 3x3 or 4x4 patterns, respectively
    "D1": simple 1-dimensional error diffusion dithering
    "D2": simple 2-dimensional error diffusion dithering (needs extra memory for 2 pixel rows)
    "FS": Floyd-Steinberg error diffusion dithering (needs extra memory for 2 pixel rows)
	
  The default is "-THfs", i.e. dithering is off, with Floyd-Steinberg being the 
  default if only "+TH" is specified.
	
  Dithering works for all file formats except JPEG and OpenEXR (no intention to 
  implement) as well as Radiance HDR (non-straightforward to implement); these 
  file formats simply ignore the setting.
	
  Added dithering to reder preview, using 4x4 Bayer dithering.
	
  Display_Gamma now supports the "sRGB" option just as File_Gamma already did; 
  besides "sRGB", "srgb" and "SRGB", any combination of upper-/lowercase 
  letters is now recognized.
	
  Moved image data quantization / encoding / decoding functions from 
  image.h/cpp to new files encoding.h/cpp.

--------------------------------------------
Changes between 3.7.beta.39 and 3.7.beta.40
--------------------------------------------

Change 5225 on 2010/12/02 by chrisc@x8

  fix divide-by-zero crash in editor support code (refer crash report #50).

Change 5224 on 2010/12/02 by chrisc@x8

  change default update check period to one day in lead-up to final release.

Change 5223 on 2010/12/02 by chrisc@x8

  make sure simplevector.h pulls in pov_err.h.

Change 5222 on 2010/12/02 by chrisc@x8

  expand uses of FixedSimpleVector<64> to 127 elements. this doesn't fix the issue
  of course but will mitigate it a bit at the cost of increased memory usage.

Change 5221 on 2010/12/02 by chrisc@x8

  bump version to beta.40.

Change 5220 on 2010/12/01 by clipka@cli-pc-xp64

  fixed bug causing interpolated image maps to be shifted by half a pixel, as 
  described in news://news.povray.org:119/4bdad2a5@news.povray.org.

Change 5219 on 2010/12/01 by chrisc@x8

  mitigate issue with crackle sometimes chewing up huge amounts of RAM. see 
  FS#56 for more details.

  NB this fix is not ideal, in particular we ought to provide an INI setting to 
  allow the user to nominate how much RAM they want to use for the cache. 
  currently it's hard-coded to roughly 30mb per thread max during a block, and 
  15mb per thread when a block is cleaned up after it's done. if the size of 
  the cache would exceed the upper hard limit, new entries will not be cached.

Change 5218 on 2010/12/01 by chrisc@x8

  differentiate between hitting the limits of the fixed vector class and actual 
  memory allocation failure.

Change 5217 on 2010/12/01 by chrisc@x8

  improve reporting of uncategorized or unknown exception codes to aid in 
  tracking down the cause.

Change 5216 on 2010/11/30 by chrisc@x8

  add ovus.cpp/h to windows projects.

Change 5215 on 2010/11/30 by chrisc@x8

  integrate changes 5188 to head from jgrimbert branch into trunk.

Change 5214 on 2010/11/30 by jgrimbert@experiment

  adding the ovus code (#5200 & #5201) which was missing.

Change 5212 on 2010/11/29 by chrisc@x8

  integrate change 5183 to trunk.

Change 5211 on 2010/11/28 by clipka@cli-pc-xp64

  improved alpha premultiplication handling for pattern images

Change 5210 on 2010/11/28 by clipka@cli-pc-xp64

  metadata improvements:

  - Using boost::posix_time and boost::date_time::gregorian now for timestamp 
    computations rather than boost::date_time::c_time (which is not thread-safe 
    on some platforms).
  
  - Moved TGA file format-specific timestamp generation code out of Metadata 
    class.
  
  - PNG output now also writes a tIME chunk.
  
  - Modified PNG metadata handling to be thread-safe.
  
  - Fixed PNG chunk order to place tEXt chunks before image data, as required 
    according to PNG specification.

Change 5209 on 2010/11/28 by clipka@cli-pc-xp64

  minor code cleanup:

  - replaced min3/max3 macros in configbackend.h and MAX3 macro in octree.h 
    with new template functions min3/max3 in types.h
  
  - removed some obsolete constants from frame.h
  
  - eliminated a few unnecessary include statements, and made boost include 
    statements more consistent

Change 5208 on 2010/11/28 by jgrimbert@experiment

  fixed 5203: the map is now simpler (all centers of tile is at i/num, border 
  at (i+1)/num) (for i from 0 to num-1). The gradient on each tile is the same 
  for every tiles on the same tiling.

Change 5206 on 2010/11/28 by clipka@cli-pc-xp64

  Multiple changes to gamma handling:
	
	Removed file_gamma keyword. Input image file default can now be set via
	
	    default { image_map { gamma FLOAT } }
	
	or
	
	    default { image_map { gamma srgb } }
	
  For backward compatibility with legacy scenes, POV-Ray 3.7 will now mimick 
  all the gamma handling of POV-Ray 3.6 if the scene has a #version statement 
  specifying a version of 3.6x or earlier, and/or specifies an assumed_gamma, 
  with the following exceptions:

    * If the scene overrides the default input file gamma, POV-Ray will fall 
      back to the new gamma handling model.
  
    * If the scene is rendered using the File_Gamma INI file setting, or using 
      an INI file setting or command-line option to specify a version of 3.7 or 
      later, input file gamma handling will still mimick 3.6 behaviour, but 
      output file gamma handling will use the new model.
  
    * PNG input file handling is not fully backward compatible.
	
  Due to architectural changes, bug fixes and improvements, backward 
  compatibility for PNG input files is subject to the following exceptions:
  
    * For palette-based PNG files (an uncommon flavour of PNG), backward 
      compatibility is provided only if assumed_gamma is not specified. (This is 
      due to a POV-Ray 3.6 bug not mimicked by POV-Ray 3.7.)

    * For non-palette-based PNG files, backward compatibility is provided only 
      if assumed_gamma is specified. (This is due to an architectural change that 
      makes this overly difficult to mimick.)
  
    * For PNG files carrying both an sRGB chunk and a fitting gAMA chunk, 
      results will slightly differ. (This is due to POV-Ray 3.7 recognizing sRGB 
      chunks, which POV-Ray 3.6 did not do.)
  
    * For PNG files carrying an sRGB chunk but no gAMA chunk (or a wrong one), 
      backward compatibility is not provided. (Again this is due to POV-Ray 3.7 
      recognizing sRGB chunks.)

Change 5205 on 2010/11/28 by chrisc@x8

  Older platform SDK's don't have PROCESS_MODE_BACKGROUND_BEGIN defined.

Change 5203 on 2010/11/28 by jgrimbert@experiment

  Adding pavement & tiling patterns.
  
  tiling # (#: 1 to 24) provide 24 classical tiling pattern with 1 or more kind of tiles.
  The full map is used when rendering a tiling. 0 is the center of first tile.
  1 is the border of the only tile, or the center of another tile.
  When more than one kind of tile is used (#), the border are at 1/#, 2/#, ... #-1/# 
	
  (would it be simpler to have the border at 0/#, 1/#... #-1/# ? and center at 
   1/#-, 2/#-, #/#- ? might be amended later)
	
	pavement: (using polymino paving the plane)

   * number_of_sides (3,4,6) : the basic tile is a triangle, a square or an 
     hexagon
   
   * number_of_tiles (1 to 5 or 6): the number of basic tiles to combine together
     to make one real tile
   
   * pattern (depend on side & tile) (1 to ...): how the basic are combined 
     together
	
	 * exterior (1 to 3, irrelevant for hexagon)
   
   * interior (1 to 3)
   
   * form (1 to 3, or 1 to 4 for square)
	
  Variations on type of corner. 0 is plain, 1 is a straight cut, 2 is a curved cut.
	All complet sets are covered.

Change 5202 on 2010/11/26 by jgrimbert@experiment

  Add square & triangular pattern (2D, in xz plane, 4 & 6 area in shape of squares and triangles)

Change 5201 on 2010/11/26 by jgrimbert@experiment

  Adding bitwise operation (bitwise_and(), bitwise_or(), bitwise_xor()) Similar 
  to max(), not limited to 2 parameters.
  Also provide keywords for ovus object

Change 5200 on 2010/11/26 by jgrimbert@experiment

  Add the ovus shape. Documentation in french at http://jgrimbert.free.fr/pov/patch/ovus.html

  It's like a torus, but in egg shape ...
  
    ovus { base_radius, top_radius }
  
  (top_radius < 2.0*base_radius or else it's just a sphere)

  Retrofit of my old patch from povray 3.1; The code is mine (it was a fun time 
  with equations, eight years ago), so I can here license it for official 
  distribution. Egg, Avocado, Head... plenty of usage (for head, rotate it 
  upside down with a slant, the top radius is ready to match the jaws)


Change 5196 on 2010/11/22 by jgrimbert@grimbert

  Experimental, add exterior type 7 & 8 for fractal pattern, using the number 
  of actual iteration to get out (=e) and the factor (=n). 7 gives back 
  mod(e,n)/n (covering 0 to n-1/n), while 8 covers 0 to 1 with mod(e,n+1)/n. 
  Not protected against silly n (like n<1) so far.

Change 5195 on 2010/11/22 by chrisc@x8

  update support for file-backed RGBFT images to allow 64-bit seek offsets. 
  NOTE: platforms that do not implement fseek64() must provide one (either a 
  function or #define).

  add code to automatically switch to using file-backed intermediate images 
  when width >= 32 and pixel count >= 1024*1024.

Change 5194 on 2010/11/21 by chrisc@x8

  Add new option to set render priority to background (only available on Vista or later).
	Add note to crash handler dialog mentioning the continue option.
  Make standard minidump output more verbose as current dumps are a bit too 
  sparse to be helpful in some cases.

Change 5193 on 2010/11/21 by chrisc@x8

  fix issue where a shutdown after a render that allocated a lot of memory 
  blocks (or any other case where the shutdown takes more than five seconds) 
  could throw an uncaught exception. this could then cause the 'terminated in 
  an unusual way' windows error message.

Change 5192 on 2010/11/21 by clipka@cli-pc-xp64

  fix issue introduced with #4979 that would cause gamma to be screwed up with 
  non-transparent TGA input files

Change 5190 on 2010/11/21 by clipka@cli-pc-xp64

  fixed target platform metadata

Change 5189 on 2010/11/08 by jgrimbert@grimbert

  fixed #5183: the display of Frame Step was last frame when the Frame Step 
  option was not used.

Change 5188 on 2010/11/08 by jgrimbert@grimbert

  Revision of Fractal fields in pattern structure to allow deeper iterations 
  (past 32767, now upto 2^32-1) for fractal patterns. Footprint of structure 
  should stay the same, as the fields for types (interior & exterior) have been 
  reduced to unsigned char (only 0 to 6 used so far, whenever the number of 
  types reaches 255 it will be time to revert to a short)

Change 5183 on 2010/11/04 by jgrimbert@grimbert

  +STP / Frame_Step= , animation option inspired from megapov with two 
  restrictions: only positive step value are supported (forward, no backward 
  rendering) and the value is not available in the SDL (it won't be costly to 
  add it now as a #declare, but philosophicaly it should not be visible: we are 
  just rendering non consecutives frames, the clock & frame number (as well as 
  delta) should not affected).

  At the same patch, the return of the display of the Animation Options, right 
  after the Parser Options (well, inside the parser option in fact). (it does 
  not display the actual clock information when animation is on, only the 
  animation's parameters)

Change 5180 on 2010/11/02 by chrisc@x8

  turn a pov_base::Exception thrown during parse into a parse error. this 
  allows the line number of the error to be reported. see FS#80.

Change 5179 on 2010/11/01 by clipka@cli-pc-xp64

  fix FS#168 (noise_generator default broken)

Change 5177 on 2010/11/01 by chrisc@x8

  Add invalid parameter handler, will now throw kParamErr exception when the 
  RTL complains about invalid parameters.

Change 5176 on 2010/11/01 by chrisc@x8

  Merge changes 5167, 5168, 5169, 5170 and 5171 to trunk with a number of changes.
	
	All: Replace spaces with tabs where appropriate.

  #5169: Some bugfixes, formatting changes.
  
  #5170: Some bugfixes.
  
  #5170: Removed 'input_file_name' token; this is now implemented via an 
         automatically-inserted declare (see #5175).
  
  #5170: call to localtime_r changed to boost::date_time::c_time::gmtime() to 
         avoid platform portability issues (windows doesn't have the _r variant) and 
         to use GMT as the default timezone (so we can insert Z into the time string 
         rather than relying on strftime returning an ISO 8601 compliant string for '%z').
  
  #5170: Call to strftime wrapped with try/except and windows code modified to 
         raise kParamErr upon the vc RTL calling the CRT invalid parameter handler 
         (which would otherwise cause program termination when users pass an invalid 
         formatting string).

Change 5175 on 2010/11/01 by chrisc@x8

  Add support for passing ASCII strings via kPOVAttrib_Declare.
	Add pre-declared variable 'input_file_name' to vfe setup code.

Change 5171 on 2010/10/27 by jgrimbert@grimbert

  Addendum to #5170 (fs#134): protect the string returned by now("...format 
  string...") against error in format string ending in a too long answer for 
  the allocated array. Also use a #define for the size of that array, so it's 
  easier to change it if needed.

Change 5170 on 2010/10/26 by jgrimbert@grimbert

  fs#134 : provide SDL with "input_file_name", a token replaced by a string 
  which is the name of the input file of the scene; and a string returning 
  function "now()".
	
  now() can have a string parameter (but can also be used without; the 
  parenthesis are mandatory anyway). 
	
  When provided with a string, its value is used for formatting the current 
  local time. Formatting documentation is the one of strftime() C function. 
  (LC_TIME is taken into account too, so "%x" "%X" and "%c" might be different 
  from one system to another)
	
  Without parameter (that's not 'now("")', but 'now()' ), the format is 
  "%Y-%m-%d %T-%z"
	
  You can get the number of second from Epoch with "%s" (and for other 
  possibilities, have a look at the man page of strftime). (whatever can the 
  Epoch be on your system)
	
  The final string is limited to about 200 glyphs (or char), you should not 
  need as much for a printable time.

Change 5169 on 2010/10/25 by jgrimbert@grimbert

  FS#105: the return of the Output Options (with minor corrections about Jpeg 
  quality handling, and default row & columns start/end): The TODO about 
  filename/path are fixed using similar approach in Parser Options (going the 
  UCS2 way first, then converting to ascii).

Change 5168 on 2010/10/24 by jgrimbert@grimbert

  Rendering order replaced with distinct rendering options: pattern (-RP / 
  Render_Pattern) and block step (-RS / Render_Block_Step)

  Pattern is now (unsigned) positive, default to 0 (as previous)
  
  Block Step is as previously, reduced to a pseudoprime with height*width (in 
  block count)
  
  Now a given pattern and a block step can both be specified at the same time.

Change 5167 on 2010/10/18 by jgrimbert@grimbert

  Adding a final version for RenderOrder (-RO) option: default remain as previously
  (from left to right, then top to bottom). Default is 0 (as well as 1)

  with -1, it's top to bottom, then left to right
  
  with -2, it's closing from left & right to center, top & bottom alternatively 
  to middle
  
  with -3, it's the opposite from -2 (starting at center-middle, going left & 
  right, then to top & bottom)
  
  with -4 it's -2 rotated (like -1 is to 0): closing top & bottom to middle, 
  alternatively left & right to centre
  
  with -5, it's the opposite from -4 (starting at middle-center)
  
  with N > 0, it's about 1 square every N (about: N might get reduced to allow 
  clock arithmetic to cover the whole picture: N must be pseudo-prime with 
  number of blocks to render; at worst it is shrinked to 1... the default)

Change 5166 on 2010/10/15 by chrisc@x8

  merge changes 5162-5165 to trunk.
	
  fs#154 : get owner & group of $HOME to assert the ownership of povray.conf & 
           povray.ini in $HOME/... subtree during installation (should be now
           fine with both "sudo make install" from joe user, and "make install"
           from root user)
	
  fs#64 : add metatags to output image (excepted for BMP, there is no room in BMP
          format for comment).

  The date of creation, the software name and 4 lines of additional text 
  (recommended to stay under 80 char), all in ASCII.

  So far the 4 lines are just kind of constants depending from the compilation 
  option. If you have a better usage for these lines, just go for it.
	
  fs#167 : force the computation on resize() to happen on unsigned long int by 
           either adding ul qualifier to existing constant or by introducing a
           1ul factor in all resize (w * h ...) calls.

Change 5164 on 2010/10/13 by jgrimbert@grimbert

  fs#167 : force the computation on resize() to happen on unsigned long int by 
           either adding ul qualifier to existing constant or by introducing a
           1ul factor in all resize( w * h ...) calls.

Change 5163 on 2010/10/12 by jgrimbert@grimbert

  fs#64 : add metatags to output image (excepted for BMP, there is no room in 
          BMP format for comment).

  The date of creation, the software name and 4 lines of additional text 
  (recommended to stay under 80 char), all in ASCII.

  So far the 4 lines are just kind of constants depending from the compilation 
  option. If you have a better usage for these lines, just go for it.

Change 5162 on 2010/10/12 by jgrimbert@grimbert

  fs#154 : get owner & group of $HOME to assert the ownership of povray.conf & 
           povray.ini in $HOME/... subtree during installation (should be now fine
           with both "sudo make install" from joe user, and "make install" from root user)

Change 5157 on 2010/09/13 by chrisc@x8

  handle case where INI file has old paths due to setup changes.

Change 5156 on 2010/09/13 by chrisc@build

  add sse2 DLL's to setup.

Change 5155 on 2010/09/12 by chrisc@x8

  integrate changes from 32-bit installer.

Change 5154 on 2010/09/12 by chrisc@x8

  convert branched 32-bit installer to suit 64-bit platform.

Change 5153 on 2010/09/12 by chrisc@build

  update to beta 39, add crash dump submit binary, and fix install location issue.

Change 5148 on 2010/09/12 by chrisc@build

  update 32-bit install script to allow attempted install to program files even 
  if not elevated.

--------------------------------------------
Changes between 3.7.beta.38 and 3.7.beta.39
--------------------------------------------

Change 5140 on 2010/09/02 by jholsenback@jholsenback_aries

  update revision.txt and changes.txt prior to beta-39 release

Change 5139 on 2010/09/02 by chrisc@x8

  bump version to beta 39

Change 5136 on 2010/09/02 by chrisc@x8

  add max ray distance to camera definition, also marks mesh camera
  as experimental.

Change 5131 on 2010/09/01 by jholsenback@jholsenback_aries

  added mesh_camera demo scenes

Change 5130 on 2010/08/31 by clipka@cli-pc-xp64

  fix for bug introduced with change #5124

Change 5129 on 2010/08/30 by jholsenback@jholsenback_aries

  consistency change with recent built-in benchmark. reference change #5105

Change 5128 on 2010/08/30 by chrisc@x8

  Add mesh_camera to available camera types.

  The mesh camera is a special camera type that allows complete control of
  the ray origin and direction for each pixel of the output image. The basic
  concept is to associate pixels with faces defined within a mesh or mesh2
  object. The mesh need not be instantiated in the scene, though it can be
  (and doing so can lead to some interesting uses, such as texture baking
  or illumination calculations).
  
  In its simplest form, each pixel of the output image is assigned to a face
  of the mesh according to (width * (int) y) + (int) x. However, more complex
  mapping is possible via multiple meshes and multiple rays per pixel. The
  type of mapping in use is determined by the distribution method parameter
  in the camera declaration. Except for mapping #3, the ray origin will be
  set to the centriod of the face, and the direction will be that of the
  face's normal. For mapping #3, barycentric co-ordinates are determined
  from the UV co-ords of the first face to match the X and Y position, and
  those are then coverted to a position on the face which will serve as the
  ray origin. Support is provided to move the origin off the face along the
  normal, and to reverse the ray direction.
  
  For most of the distribution methods, any POV feature that causes sub-
  pixel positioning to be used for shooting rays (e.g. AA or jitter) will
  not do anything useful, because X and Y are converted to integers for
  indexing purposes. At this time, no warning is issued if AA etc is
  requested when rendering a non-applicable distribution; this may be
  added later.

  The syntax for the mesh camera is currently as follows:
  
  camera {
      mesh_camera {
        rays_per_pixel
        distribution_type
        MESH_OBJECT
        [MESH_OBJECT ...]
      }
      [location]
      [direction]
      [smooth]
  } 
  
  rays_per_pixel:
    This float parameter controls the number of rays that will be shot for each pixel
    in the output image. Each distribution allows different values, but the minimum is
    always 1.
  
  distribution_type:
    This float parameter controls how pixels are assigned to faces, as documented below.
  
    distribution #0:
      This method allows single or multiple rays per pixel, with the ray number 
      for that pixel allocated to each mesh in turn. The index into the meshes
      is the ray number (where rays_per_pixel > 1), and the index into the
      selected mesh is the pixel number within the output image. If there is no
      face at that pixel position, the resulting output pixel is unaffected.
  
      You must supply at least as many meshes as rays_per_pixel. Each pixel is
      shot rays_per_pixel times, and the results averaged. Any ray that does not
      correspond with a face (i.e. the pixel number >= face count) will not
      affect the resulting pixel color. Generally, it would be expected that
      the number of faces in each mesh is the same, but this is not a requirement.
  
      Using multiple rays per pixel is useful for generating AA (since standard AA
      won't work) or for special effects such as focal blur, motion blur, and so
      forth, with each additional mesh specified in the camera representing a
      slightly different camera position.
  
      Note that it is legal to use transformations on meshes specified in the
      camera body, hence it's possible to obtain basic AA by using a single mesh
      multiple times, with subsequent ones jittered slightly from the first,
      and a suitable rays_per_pixel count.
  
    distribution #1:
      This method allows both multiple rays per pixel and summing of meshes; i.e. 
      the faces of all the supplied meshes are logically summed together as if 
      they were one single mesh. In this mode, if you specify more than one ray 
      per pixel, the second ray for a given pixel will go to the face at (width * 
      height * ray_number) + pixel_number, where ray_number is the count of rays 
      shot into a specific pixel. If the calculated face index exceeds the total
      number of  aces for all the meshes, no ray is shot.
  
      The primary use for this summing method is convenience in generation of
      the meshes, as some modellers slow down to an irritating extent with
      very large meshes; using distribution #1 allows these to be split up.
  
    distribution #2:
      Distribution method 2 is a horizontal array of sub-cameras, one per mesh 
      (i.e. like method #0, it does not sum meshes). The image is divided 
      horizontally into #num_meshes blocks, with the first mesh listed being the 
      left-most camera, and the last being the right-most. The most obvious use 
      of this would be with two meshes to generate a stereo camera arrangement.
  
      In this mode, you can (currently) only have a single ray per pixel.
  
    distribution #3:
      This method will reverse-map the face from the UV co-ordinates. Currently,
      only a single ray per pixel is supported, however, unlike the preceding
      methods, standard AA and jitter will work. This method is particularly
      useful for texture baking and resolution-independant mesh cameras, but
      requires that the mesh have a UV map supplied with it.
  
      You can use the smooth modifier to allow interpolation of the normals at 
      the vertices. This allows for use of UV mapped meshes as cameras with the 
      benefit of not being resolution dependant, unlike the other distributions.
      The interpolation is identical to that used for smooth_triangles.
  
      NB if used for texture baking, the generated image may have visible seams
      when applied back to the mesh. This can be mitigated; see Jaime Vives
      Piqueres sample scripts. Also, depending on the way the original UV map
      was set up, using AA may produce incorrect pixels on the outside edge of
      the generated maps.
  
  mesh_object:
    One or more mesh or mesh2 objects to be used for the camera. These will be
    treated differently depending on the distribution method, as explained above.
    Transformations on the meshes can be used here, and will reflect on the
    resulting image as it would be expected for a regular camera.
  
  location:
    On this special camera, location doesn't affect where the camera is placed
    per se (that information is on the mesh object itself), but is used to
    move the origin of the ray off the face, along the normal of that face.
    This would typically be done for texture baking or illumination
    calculation scenes where the camera mesh is also instantiated into the
    scene (usually only a tiny amount of displacement is needed).

    The X and Y for location is not currently used, and the Z always refers
    to the normal of the face, rather than the real Z direction in the scene.

  direction:
    Like location, this doesn't correspond to the real direction vector of the
    camera. It serves only to reverse the normal of all the faces, if
    necessary. If the Z component is less than -EPSILON, then the rays will be
    shot in the opposite direction than they would otherwise have been.
    X and Y are not used.

  Potential uses of the mesh camera include:

    o Calculation of illumination on a surface represented by a mesh.
      This was the first use of the mesh camera; a NASA JPL project
      wished to calculated watts/m2 of illumination across a portion
      of the moon's surface, for which they had a detailed grid and
      hence were able to create a mesh.
  
    o Texture baking (creation of an image suitable to be used as a UV
      map). Given a mesh with UV co-ordinates defined, POV-Ray can generate
      an image that can be later used in either POV itself or any modelling
      application that can load UV-mapped textures. This means that any of
      POV-Ray's native textures may be baked to a map (however note that
      use of transparency on objects will give a confusing result).
  
    o Any arbitrary camera shape, including all existing POV-Ray cameras
      (though of course there is little point in replicating an existing
      camera).
  
    o Precise modeling of optical aberrations in lenses (presuming data is
      available to generate a mesh that follows the aberrations). It may
      also be possible to model a lens that reverses such abberations if
      the scene being rendered has an image map containing an image taken
      through the lens.
  
    o Modeling optical devices that employ filters, such as camera CCD's
      (by having a mesh that defines R, G and B image sensor elements and
      the color filters that are typically overlayed on them).
  
    o Any effect that could be achieved by shooting multiple rays for a
      single pixel from different locations (or in different directions)
      and averaging the results.
  
    o Simulation of compound eyes such as those of insects.
  
    o Certain types of animation (where only the camera moves), using
      distribution #2 and a post-processor to split the output image.
      This can be useful for scenes that take a very long time to parse
      compared to the time taken to render (which can be an impediment
      if using the traditional POV clock-based loop).
  
    o If a means of limiting the maximum ray length is added, then a mesh
      camera could be used to probe a scene to generate voxel or slice data
      (the latter is useful for generating STL data for 3d printers).
  
  Examples (placement macros not included for brevity):
  
  // Stereo camera:
  
  camera {
    mesh_camera {
      1 2 
      mesh {
        camera_mesh
        meshcam_placement(c_location_left,c_look_at)
      }
      mesh {
        camera_mesh
        meshcam_placement(c_location_right,c_look_at)
      }
    }
    location <0,0,-.01>
  }
  
  // Texture baking:
  
  camera {
    mesh_camera {
      1 3
      mesh2 {vase1}
      mesh2 {vase1}
      mesh2 {vase1}
    }
    location <0, 0, -0.01>
    direction <0, 0, 1>
  }

Change 5125 on 2010/08/30 by clipka@cli-pc-xp64

  Fix for a few Linux compiler warnings

Change 5124 on 2010/08/30 by clipka@cli-pc-xp64

  Fix for some Microsoft-isms and other flaws introduced with changes #5109
  and #5111.

Change 5123 on 2010/08/30 by chrisc@x8

  a few misc changes/fixes, including support (not enabled) for ASCII PPM
  output [handy for text processing of output image during testing].

Change 5119 on 2010/08/30 by chrisc@x8

  fix for use of templated version of min().

Change 5116 on 2010/08/29 by clipka@cli-pc-xp64

  fixed a bug in radiosity introduced with change #5112 that could cause
  samples to be re-used too far away

Change 5115 on 2010/08/29 by clipka@cli-pc-xp64

  Added support for focal blur with user-defined bokeh, using the
  following syntax:

      camera {
        // ... focal blur camera...
        bokeh {
          pigment { ... }
        }
      }
  
  If bokeh is specified, focal blur will use a custom sampling sequence based
  on the specified pigment's brightness in the range <0,0,0> to <1,1,0>, i.e.
  the unit square in the XY plane.

Change 5114 on 2010/08/29 by clipka@cli-pc-xp64

  Parser failed to eat away the parameter value after the obsolete
  "max_intersections" keyword, causing it to crash instead of gracefully
  ignoring it with a warning; fixed.

Change 5113 on 2010/08/29 by clipka@cli-pc-xp64

  fixed some dormant photons code that, according to code inspection, was
  broken with radiosity change #4761

Change 5112 on 2010/08/28 by clipka@cli-pc-xp64

  Radiosity improvements:

  - Removed the max 1600 count limit; if the count exceeds 1600, POV-Ray will
    now use a Halton sequence instead of the built-in sequence.

  - POV-Ray can now draw sample directions in a round-robin fashion from a
    larger pool, so that different samples can use different sets of sample
    directions, leveraging the benefit of the nearest_count mechanism.
    For this purpose, the count keyword syntax has been changed:

      count RAYS_PER_SAMPLE [, DIRECTION_POOL_SIZE ]

  - Added importance sampling to radiosity; full ray computations are
    performed only for a certain portion of sample rays, depending on the
    importance of the first object each ray encounters. Importance can be
    assigned on a per-object basis using the followng syntax (using a sphere
    as an example):

      sphere { ... radiosity { importance IMPORTANCE } }

    where IMPORTANCE is a value in the range from >0.0 to <=1.0 specifying the
    percentage of rays to actually compute on average. A particular ray will
    only be fully computed if it is within the first COUNT*IMPORTANCE rays of
    the sampling sequence; due to the low-discrepancy sub-random nature of the
    sequence, this is mostly equivalent to a per-ray weighted random choice,
    while maintaining a low-discrepancy uniform distribution on a per-object
    basis. Rays actually computed are weighted to compensate for those
    not computed.

    Objects derived from previously defined objects will default to the
    "inherited" importance. CSG components without an explicit importance will
    default to their parent object's importance. Other objects normally
    default to an importance of 1.0, but this can be changed in a
    default {} block:

      default { radiosity { importance DEFAULT_IMPORTANCE } }

    NOTE: The "radiosity on|off" feature for objects (specifying whether an
    object shall receive radiosity illumination) is currently NOT available.
    Depending on user feedback, it will be substituted with some keyword
    within the object-specific radiosity{} block, or dropped completely.

  - Some more minor modifications.

Change 5111 on 2010/08/28 by clipka@cli-pc-xp64

  Improved focal blur:

  - Modified code to generate extra samples in a circular rather than square
    pattern when blur_samples is not 4, 7, 19 or 37, leading to a circular
    rather than square bokeh.

  - Modified the code that re-placed an extra sample if it would be close to
    another one, in order to get rid of the lower-right bias the old
    code produced.

  - Extra samples are now generated from a halton sequence rather than a
    random stream.

  - Modified blur_samples syntax to optionally specify a minimum number of
    samples to be taken before testing against confidence/variance settings
    (default is 4 if blur_samples maximum is <7, otherwise 7), to provide a
    means to get rid of stray non-blurred pixels. The new syntax is:

      blur_samples [ MIN_SAMPLES, ] MAX_SAMPLES

  - Eliminated the VEC2 type in favor of Vector2d.

  - Simplified a few statements and did a bit of cleanup.

Change 5110 on 2010/08/28 by clipka@cli-pc-xp64

  SSLT improvements:

  - Fixed a bug in SSLT code that caused the single-scattering
    term to be ignored.

  - Using halton sequence instead of random generator for picking sampling
    directions, to reduce visible patterns in noise.

Change 5109 on 2010/08/28 by clipka@cli-pc-xp64

  Introduced new framework for internal random number generators, intended for
  reducing the memory footprint (by sharing precomputed values among
  generators with identical parameters) as well as easier replacement of
  implementations.

Change 5106 on 2010/08/27 by clipka@cli-pc-xp64

  minor code simplification in aoi pattern

Change 5105 on 2010/08/26 by jholsenback@jholsenback_aries

  changed Output_File_Type to type "n"  reference FS#155

Change 5102 on 2010/08/21 by clipka@cli-pc-xp64

  changed radiosity defaults to "always_sample off" and "recursion_limit 2"

Change 5099 on 2010/08/14 by jholsenback@jholsenback_aries

  corrected 1 pixel error in mosaic preview see FS#114

Change 5097 on 2010/08/08 by clipka@cli-pc-xp64

  fix for FS#162 "Character 101 (0x65) not found in /usr/share/fonts/truetype/freefont/FreeSans.ttf"

Change 5096 on 2010/08/08 by chrisc@cc-ubuntu-test

  Installer changes suggested in article <web.4c558a54f4269f7c380f8080@news.povray.org>

Change 5089 on 2010/08/05 by clipka@cli-pc-xp64

  fixed a preprocessor definition in Win32-SSE2 console project

Change 5086 on 2010/08/04 by clipka@cli-pc-xp64

  removed duplicate references to Windows system libraries

Change 5084 on 2010/07/26 by chrisc@cc-ubuntu-test

  Remove soft expiration from unixconsole.cpp.

Change 5081 on 2010/07/24 by jholsenback@jholsenback_aries

  fix parse warnings reported in FS#157

Change 5074 on 2010/07/23 by chrisc@x8

  fix name of editor DLL when building SSE2 binary.
  enable editor DLL build by default in solution.

Change 5071 on 2010/07/21 by clipka@cli-pc-xp64

  fixed bug FS#158 in render options output code, causing a wrong value to be
  reported for antialiasing gamma

Change 5059 on 2010/07/01 by chrisc@x8

  shellout fix.

--------------------------------------------
Changes between 3.7.beta.37 and 3.7.beta.38
--------------------------------------------

Change 5053 on 2010/07/01 by chrisc@x8

  fix error in windows version expiry test.

Change 5046 on 2010/06/29 by clipka@cli-pc-xp64

  modified code to avoid even more deprecation warnings with libpng 1.4;
  NEEDS TESTING with both 1.2 and 1.4!

Change 5045 on 2010/06/29 by jholsenback@jholsenback_aries

  properly allow for libpng 1.25 AND 1.4.3

Change 5044 on 2010/06/29 by jholsenback@jholsenback_aries

  Rollback //depot/povray/smp/unix/configure.ac to revision 41

Change 5043 on 2010/06/29 by clipka@cli-pc-xp64

  modified code to avoid deprecation warnings with libpng 1.4;
  NEEDS TESTING with both 1.2 and 1.4!

Change 5040 on 2010/06/28 by jholsenback@jholsenback_aries

  sample scene vector typo corrections FS#110

Change 5039 on 2010/06/28 by jholsenback@jholsenback_aries

  configure updates for libpng 1.4 you MAY want to defer this until
  change #5031 is completed.

Change 5036 on 2010/06/26 by clipka@cli-pc-xp64

  Added support for using the sRGB transfer function for output file gamma; 
  syntax is "File_Gamma=sRGB". ("SRGB" and "srgb" are supported as well.)
  
  Note: When "File_Gamma=sRGB" is used with PNG output file format, POV-Ray 
  writes an sRGB chunk, thereby claiming that the output conforms to the sRGB 
  color space; however, this claim is not necessarily true, as POV-Ray is 
  currently not color space aware; it depends on whether your scene input data 
  conforms to the sRGB color space.
  
  Note: The other gamma INI file parameters (Antialias_Gamma and DisplayGamma) 
  do NOT support the "sRGB" value at present.

Change 5033 on 2010/06/25 by clipka@cli-pc-xp64

  Changes regarding alpha handling, plus some cleanup:
  
  - Added "premultiplied BOOL" parameter to input image file syntax; like the 
    "gamma"/"file_gamma" parameter, it must immediately follow the filename 
    (though the order of "gamma"/"file_gamma" and "premultiplied" does not 
    matter). The boolean parameter specifies whether the file is stored in 
    premultiplied ("associated") or non-premultiplied ("straight") alpha format, 
    overriding the file format specific default. (This keyword has no effect on 
    files without an alpha channel.)
  
  - Prepared code for adding an INI-file parameter to override file format 
    specific alpha mode (premultiplied vs. non-premultiplied) for output files.
  
  - Cleaned up the lists of reserved words in reswords.cpp and reswords.h.

Change 5031 on 2010/06/23 by clipka@cli-pc-xp64

  Various changes related to PNG files:

  - modified png.cpp to be ready for libpng 1.4 (Needs Testing!)
  
  - fixed flaw in PNG input file gamma handling that caused unnecessary loss of 
    precision
  
  - fixed bug in change #4979 that screwed up image file input under certain 
    conditions (most particularly PNG files)

Change 5029 on 2010/06/21 by clipka@cli-pc-xp64

  Fixed uv mapping for bezier spline lathe.

Change 5028 on 2010/06/21 by clipka@cli-pc-xp64

  Minor change to radiosity adaptive pretrace code.

Change 5026 on 2010/06/20 by clipka@cli-pc-xp64

  Modified radiosity pretrace mechanism:
  
  - POV-Ray will now create only one set of threads for the whole pretrace, 
    instead of one set for each pretrace step; likewise, progress report will 
    pertain to the whole pretrace rather than each step; POV-Ray will no longer 
    wait for a pretrace step to be fully completed, and instead assign threads to 
    the next step as soon as all blocks of the previous step are either finished 
    or already assigned.
  
  - Implemented adaptive pretrace. When a second parameter is specified after 
    the "nearest_count" keyword, pretrace will stop re-iterating over areas 
    where, on average, that many (average-quality) samples are already present 
    per ray.
  
  - Refactored some related code.

Change 5025 on 2010/06/20 by thorsten@host26

  Adds "#declare atand = function (x) {degrees(atan(x))} " to "math.inc"

Change 5022 on 2010/06/19 by clipka@cli-pc-xp64

  fix for metallic phong highlights which were broken by change #4962

Change 5021 on 2010/06/18 by clipka@cli-pc-xp64

  added #elseif statement; the #if, #ifdef and #ifndef directives syntax is 
  changed as follows:
  
    IF_DIRECTIVE:
      #if ( Cond ) TOKENS... [ELSE_DIRECTIVE] #end
    IFDEF_DIRECTIVE:
      #ifdef ( IDENTIFIER ) TOKENS... [ELSE_DIRECTIVE] #end
    IFNDEF_DIRECTIVE:
      #ifndef ( IDENTIFIER ) TOKENS... [ELSE_DIRECTIVE] #end
  
    ELSE_DIRECTIVE:
      #else TOKENS... |
      #elseif ( Cond ) TOKENS... [ELSE_DIRECTIVE]
  
  Example:
  
    #if (Foo)
      #debug "Foo is true\n"
    #elseif (Bar)
      #debug "Foo is false, but Bar is true\n"
    #else
      #debug "Foo and Bar are both false\n"
    #end

Change 5010 on 2010/06/05 by chrisc@x8

  fix issue with windows insert menu preview loading of BMP's that contained DPI
  information, and expand number of available insert menu ID's to about 9000.

Change 5009 on 2010/06/05 by chrisc@x8

  avoid pulling in all of the std and boost namespaces in many places in favor 
  of some more specific uses. NB requires changes to platform header files, 
  already done for unix version, the mac port can clone the changes from the 
  windows syspovconfig.h.

Change 5004 on 2010/06/01 by clipka@cli-pc-xp64

  Added "emission" parameter to the finish block; syntax and effect are 
  virtually identicall to "ambient", except that "emission" is unaffected by 
  the global "ambient_light" parameter, which will now effectively be set to 0 
  if radiosity is active (except in legacy scenes having #version set to < 
  3.70). The intention is to simplify the use of materials designed for 
  non-radiosity scenes in scenes with radiosity, or the design of scenes that 
  can be rendered with or without radiosity.

Change 5003 on 2010/05/29 by chrisc@x8

  round out core shellout support for the time being.
  TODO: add support to simplefrontend.h.

Change 5001 on 2010/05/28 by chrisc@x8

  add special handling for INI lines that are shell-out commands.

Change 5000 on 2010/05/27 by jholsenback@jholsenback_aries

  eliminate dependancy on colors.inc in distro file.

Change 4999 on 2010/05/26 by chrisc@x8

  re-implement support for shellouts (WIP, INCOMPLETE).

Change 4998 on 2010/05/26 by chrisc@x8

  windows editor tab/indent settings are no longer per-file+global default; 
  changes affect all opened files.

Change 4997 on 2010/05/26 by chrisc@x8

  add display of filename on tab hover in windows editor, and add right-click 
  menu to tabs allowing opening of folder in explorer and copy of filename to 
  clipboard.

Change 4996 on 2010/05/25 by chrisc@x8

  windows: increase maximum number of insert menu sections to 8192, and ensure 
  that if no INI file exists, a default one that includes the insert menu for 
  output is made.

Change 4995 on 2010/05/25 by chrisc@x8

  add support for loading of JPG and PNG files as windows insert menu hints.

Change 4994 on 2010/05/24 by jholsenback@jholsenback_aries

  removed outdated information and corrected typos from some distro files.

Change 4993 on 2010/05/22 by clipka@cli-pc-xp64

  changed input file gamma syntax for individual files; as an alternative to 
  the "file_gamma" keyword, the parser will now also accept the "gamma" keyword 
  originally introduced for specifying gamma in color values. (To specify the 
  default input file gamma in the global_settings section, "file_gamma" is 
  still mandatory though, as "gamma" would be ambiguous and misleading.)

Change 4992 on 2010/05/22 by clipka@cli-pc-xp64

  fix FS#116 "assertion fails when using 'filter all' with small-palette images"

Change 4991 on 2010/05/21 by clipka@cli-pc-xp64

  Changed antialiasing to compare gamma-adjusted colours instead of linear 
  colours, to improve antialiasing of darker regions.
  
  Note that this gamma-adjustment is only applied to copies of the sample 
  values, and does not affect averaging of the sample values, which is still 
  performed on the original linear data. It is also independent of both preview 
  display and output file gamma.
  
  The antialiasing gamma-adjustment is controlled by the new ini-file / 
  command-line options "Antialias_Gamma=x" and "+AGx" respectively, defaulting 
  to 2.5. Note that this differs from Display_Gamma and File_Gamma defaults, as 
  it is intended to fit human vision rather than typical CRT characteristics. 
  Nevertheless, the value specified is once again the inverse of the gamma 
  actually applied, in order to use the more familiar value range.

Change 4990 on 2010/05/21 by clipka@cli-pc-xp64

  fix FS#114 "Mosaic Preview not displaying properly" for unix systems.

Change 4987 on 2010/05/20 by clipka@cli-pc-xp64

  Fixed a bug introduced with change #4979 that caused semi-transparent objects 
  visible against a default background to be displayed wrong in the preview 
  window when alpha output was off. (File output was unaffected though.)

Change 4986 on 2010/05/20 by clipka@cli-pc-xp64

  Added "gamma" keyword to specify gamma pre-corrected colours.
  
  The colour syntax is extended as follows:
  
    COLOR_BODY:
      COLOR_VECTOR [GAMMA] |
      COLOR_KEYWORD_GROUP |
      COLOR_IDENTIFIER [GAMMA]
    ...
    COLOR_KEYWORD_ITEM:
      COLOR_IDENTIFIER       |
      red Red_Amount         |
      blue Blue_Amount       |
      green Green_Amount     |
      filter Filter_Amount   |
      transmit Transmit_Amount |
      GAMMA
    GAMMA:
      gamma Gamma_Value |
      gamma srgb
  
  Specifying "gamma Gamma_Value" indicates that the colour components are 
  gamma-precorrected for a display gamma of Gamma_Value, instructing POV-Ray to 
  automatically convert the colour components to linear values using the 
  following formula:
  
    Effective_Red_Amount      = pow ( Red_Amount,   Gamma_Value )
    Effective_Green_Amount    = pow ( Green_Amount, Gamma_Value )
    Effective_Blue_Amount     = pow ( Blue_Amount,  Gamma_Value )
    Effective_Filter_Amount   = Filter_Amount
    Effective_Transmit_Amount = Transmit_Amount
  
  Likewise, specifying "gamma srgb" indicates that the colour components are 
  gamma-precorrected using the sRGB transfer function (being roughly, but not 
  quite, equivalent to a Gamma_Value of 2.2).
  
  Note that gamma is NOT an additional component, but rather modifies the 
  interpretation of the other colour keywords. For instance, the following 
  statements are all fully equivalent:
  
    #declare Foo = colour rgbt <0.2, 0.3, 0.4, 0.5> gamma 2;
    #declare Foo = colour rgbt <0.04,0.09,0.16,0.50>;
    #local Fnord = colour rgbt <0.2, 0.3, 0.4, 0.5>; #declare Foo = colour Fnord gamma 2;
  
  Also note that specifying gamma does not affect the filter or transmit components.

Change 4984 on 2010/05/16 by clipka@cli-pc-xp64

  more changes to input image transparency handling:
  
  - For material_map, /no/ alpha premultiplication handling is done whatsoever; 
    instead, the data as stored in the file is used.

  - For bump_map and image_pattern, images with alpha channel are treated as if 
    they had a black background (unless the alpha channel itself is used).

Change 4983 on 2010/05/14 by clipka@cli-pc-xp64

  fix FS#113 "Multi-layered reflections broken"

Change 4982 on 2010/05/14 by clipka@cli-pc-xp64

  Added comments & fixed a few flaws in the GammaCurve class

Change 4979 on 2010/05/13 by clipka@cli-pc-xp64

  Changed alpha handling for image file in- and output:
  
  * Previous versions of POV-Ray always expected straight (non-premultiplied) 
    alpha for file input, while always writing associated (premultiplied) alpha 
    for output; this has been changed on a per-file-format basis to use the same 
    alpha handling mode for in- and output alike:

    - PNG will use straight alpha as per specification;
  
    - OpenEXR and TIFF will use associated alpha as per specifications;
  
    - TGA and BMP 32-bit RGBA (an inofficial extension to BMP) will use 
      straight alpha, retaining file input compatibility for now, until a final 
      decision has been made on these formats.
  
  * When generating non-premultiplied alpha output to a classic 
    low-dynamic-range file format (e.g. PNG), transparency of particularly bright 
    areas will now be reduced, in order to better preserve highlights on 
    transparent objects. (Note that this mechanism has some limitations with 
    colored highlights.)
  
  * When used with file formats for which alpha output is currently not 
    supported by POV-Ray (or only via an inofficial extension, as with BMP), 
    turning on alpha output via Output_Alpha=on or +UA will now generate a 
    warning.
  
  * Fixed various bugs in image.cpp found during code inspection.

Change 4977 on 2010/05/10 by clipka@cli-pc-xp64

  fix FS#111 "Remove_Bounds=off / -UR does not work properly"

Change 4976 on 2010/05/10 by clipka@cli-pc-xp64

  Fixed FS#112 "OpenEXR alpha is only written when it shouldn't be"

Change 4975 on 2010/05/10 by clipka@cli-pc-xp64

  Changes to sky_sphere handling:
  
  - Using filter in a sky_sphere with layered pigments now has the same effect 
    as in a large sphere with a multi-layered texture. (For compatibility with 
    legacy scenes, specifying a #version < 3.70 will revert to the old, poorly 
    specified behavior.)
  
  - Using Output_Alpha=on with legacy scenes (#version < 3.70) will now 
    suppress sky spheres and background except in reflections, for backward 
    compatibility with v3.6.

Change 4972 on 2010/05/09 by clipka@cli-pc-xp64

  Parser now checks for plausible relation between radiosity minimum_reuse and maximum_reuse:

  - If ony one value is specified, parser will warn if minimum_reuse > maximum_reuse/2,
    and adjust the unspecified value accordingly.
  
  - If both values are specified, parser will warn if minimum_reuse > maximum_reuse/2,
    but not modify any of the values; if minimum_reuse >= maximum_reuse; the parser will
    raise an error.

Change 4971 on 2010/05/08 by clipka@cli-pc-xp64

  Replaced virtually all occurrences of Colour type with RGBColour, using 
  separate filter and/or transmit variables/parameters where needed, to get a 
  clearer picture of where these values are actually used and processed, and 
  where they were just plain ballast.
  
  Consolidated a few duplicate constants.
  
  Changed effect of filter in a layered-pigment sky_sphere to match the 
  behavior of a corresponding layered-texture large regular sphere. (The old 
  behavior, though probably having been unintentional, is automatically 
  re-activated for backward compatibility when #version < 3.7 is specified.)
  
  Partial fix for broken alpha channel output; v3.6 behavior is now reproduced 
  exactly (including bugs), regardless of version. Further changes will address 
  the premultiplied-alpha issue (which was already handled wrong in 3.6) and 
  possibly add options for use cases where v3.6 behavior might be undesired.

Change 4969 on 2010/05/06 by chrisc@x8

  Fix crash reported in http://news.povray.org/4bd949b3@news.povray.org

Change 4968 on 2010/05/05 by chrisc@build

  beta 37a install scripts.

Change 4967 on 2010/05/05 by chrisc@x8

  change version to beta 37a.

Change 4965 on 2010/05/03 by clipka@cli-pc-xp64

  fixed an issue with SSLT that could cause rendering threads to hang

Change 4964 on 2010/05/02 by clipka@cli-pc-xp64

  fix for FS#107 "Failed to parse INI file, over network"

Change 4963 on 2010/05/02 by clipka@cli-pc-xp64

  follow-up to change #4962 to suppress excessive parse warnings about ignored 
  filter & transmit components

Change 4962 on 2010/05/02 by clipka@cli-pc-xp64

  Yet more code refactoring:
  
  - replaced lots of COLOUR parameters & variables with Colour or RGBColour

  - replaced various Colour parameters & variables with RGBColour
  
  - replaced a few int parameters & variables with bool
  
  - declared several more parameters as const
  
  - removed a few obsolete parameters and pieces of code
  
  - refactored image interpolation for better performance and (hopefully) ease 
    of understanding
  
  - eliminated references to "ray.h" include file (except in ray.cpp)
  
  *PLUS*:

  - Implemented bicubic image interpolation as interpolation type 3

Change 4961 on 2010/04/28 by clipka@cli-pc-xp64

  various output file type-related changes:

  - When specifying an input image in SDL without a file type (neither via type 
    keyword nor via extension), parser would not fall back to system default 
    (broken since change #4932); fixed.
  
  - When specifying an IFF input image in SDL, POV-Ray would instead attempt to 
    read it as a TIFF file; should be fixed (not that anybody would probably care 
    these days...).
  
  - Some code pertaining to histogram output was not updated with change #4932; 
    fixed. (no symptoms there, as histogram output is presently out of order 
    anyway)
  
  - Some code pertaining to logging of output settings was not updated with 
    change #4932; fixed. (no symptoms there either, as logging of output settings 
    is presently out of order as well)
  
  - Validity check for Grayscale_Output setting was broken with change #4932; fixed.
  
  - Changed default output file format for Windows version to PNG (note that 
    "sys" format still remains mapped to BMP)

  - Unix config was not updated properly with changes #4932 and #4948; fixed.
  
  - Some minor code refactoring pertaining to the #4932 changes.

Change 4958 on 2010/04/28 by clipka@cli-pc-xp64

  fix for FS#104 "Output file gamma broken for File_Gamma=1.0"

Change 4957 on 2010/04/28 by clipka@cli-pc-xp64

  disabled chroma sub-sampling in JPEG output; reduced default quality setting 
  from 95% to 85% to retain same overall quality & file size.

Change 4956 on 2010/04/27 by clipka@cli-pc-xp64

  fix FS#103 "JPEG output does not conform to baseline JFIF standard"

Change 4955 on 2010/04/26 by clipka@cli-pc-xp64

  Changed a wagonload of function parameters to const, plus some other minor 
  code refactoring

Change 4953 on 2010/04/24 by chrisc@build

  update install scripts for beta 37.

Change 4951 on 2010/04/24 by chrisc@x8

  Update changes.txt/revision.txt.

Change 4949 on 2010/04/24 by chrisc@x8

  bump version to beta 37.

--------------------------------------------
Changes between 3.7.beta.35 and 3.7.beta.37
--------------------------------------------

Change 4948 on 2010/04/24 by chrisc@x8

  fix issue where parse fails if output file type not specified (see change #4932).

Change 4947 on 2010/04/22 by clipka@cli-pc-xp64

  preliminary workaround for FS#81 "sphere_sweep generating artifacts"

Change 4946 on 2010/04/21 by clipka@cli-pc-xp64

  partial fix for FS#102 "#switch directive parsing problem": POV-Ray will now 
  complain if the first #case or #range after a #switch is missing the hash 
  sign ("#")

Change 4944 on 2010/04/19 by clipka@cli-pc-xp64

  fix for FS#92 "Sphere_Sweep Bug": Modified quadratic polynom solver to 
  "normalize" polynoms first before checking for optimizations, to prevent 
  problems when all coefficients are small

Change 4943 on 2010/04/19 by clipka@cli-pc-xp64

  fixed FS#100 "cutaway_textures"; removed some obsolete code along the way

Change 4942 on 2010/04/18 by clipka@cli-pc-xp64

  modified #break semantics; the #break directive can now be used...:
    - anywhere within a #case or #range block, to skip to the end of the 
      #switch directive (previously, #break was only useful right before the next 
      #case, #range or #else directive, to indicate that a slip-through was not 
      desired);

    - anywhere within a loop block (both #while and #for), to preliminarily 
      terminate the loop; and

    - anywhere within a #macro block, to preliminarily terminate the macro.
  
  Example for the use in a loop:
  
    #local R = seed(4711);
    #for (I, 1, 100)
      #if (rand(R) < I/1000)
        #break // terminate loop early
      #end
      #debug concat(str(I,0,0), " iterations and counting\n")
    #end
  
  Where multiple #switch, loop and/or #macro blocks are nested, #break will 
  leave only the innermost of these.

Change 4941 on 2010/04/16 by clipka@cli-pc-xp64

  implement FS#84 "A for-loop construct":
  
    #for (Identifier, Start, End [, Step])
      //...
    #end
  
  is now available for simple loops incrementing Identifier from Start to End 
  (inclusive) with the given Step size (default: +1.0). Basically, it works the 
  same as the classic #while pattern:
  
    #local Identifier = Start;
    #while (Identifier <= End)
      //...
      #local Identifier = Identifier + Step;
    #end
  
  Some additional notes:
    - If Step is negative, comparison will be automatically adjusted to match a 
      "countdown" pattern.

    - Start, End and Step are evaluated only *once*.
  
    - The loop counter is a full-fledged local variable. Any local variable of 
      the same name already defined before the loop *will* be overwritten without 
      warning (note that in the main scene file, all local variables outside of 
      macros are effectively global); inside the loop, any tampering with the 
      variable is possible for effect, as long as it is defined as a local numeric 
      variable at the end of each iteration.
  
    - After the loop has terminated, the variable will remain defined, typically 
      holding the value End+Step.
  
    - The loop counter must *not* be an array element.

Change 4940 on 2010/04/15 by clipka@cli-pc-xp64

  fixed FS#97 "Forward-slash pathnames not fully supported in Windows version", plus:
  
  - some code refactoring pertaining to path handling
  
  - fixed FS#83 "redundant code in pvengine.cpp" (removed apparently duplicate 
    code from pvengine.cpp handler for KEYWORD_LOOKUP_MESSAGE)

Change 4939 on 2010/04/14 by clipka@cli-pc-xp64

  some photons changes:
  
    * Partially fixed FS#93 "Photons are unnaturally amplified by pass_through objects"
  
      NOTE: As the error is also present in POV-Ray 3.6, behavior has necessarily 
      changed with this fix; pass_through objects will now affect the color of 
      photons on their way to their target, according to pigment filter/transmit, 
      interior fade, and media (which implies that opaque objects will block 
      photons even when declared pass_through); it needs to be seen whether this 
      new behavior will be accepted by the users, or whether some additional 
      mechanism will have to be implemented to choose between old and new 
      behavior for compatibility with legacy scenes. At present, behavior can 
      only be changed at compile time with the preprocessor defines PT_FILTER_BEFORE_TARGET
      and PT_AMPLIFY_BUG in photons.cpp.
  
  * Fixed FS#95 "Photons are over-attenuated by semi-transparent surfaces"
  
  * Some minor code refactoring & comment changes in photons-related code

Change 4938 on 2010/04/12 by clipka@cli-pc-xp64

  fix FS#94 "Unexpected refraction angle in interfaces with changing IOR <> 1.0"

Change 4937 on 2010/04/02 by clipka@cli-pc-xp64

  Cosmetic Code & Comment Changes

Change 4936 on 2010/04/02 by clipka@cli-pc-xp64

  Radiosity code changed:
  
    - When a new sample has been gathered after sample lookup returned 
      insufficient samples, sample lookup is no longer run again; instead, the new 
      sample is interpolated with the results of the earlier lookup.
  
    - The actual number of samples required to satisfy the reuse_count setting is 
      now influenced by sample quality, with high-quality samples reducing the 
      effective number of samples required (down to 1/4 of the parameter value in 
      extreme cases) and low-quality samples increasing the number. Note that this 
      may change the balance between speed and quality for some scenes.
  
    - Fixed some bugs & flawed comments found during code inspection.

Change 4935 on 2010/03/28 by clipka@cli-pc-xp64

  - Implemented AOI pattern (thanks to Grimbert Jerome for most of the code); 
    the syntax is as follows:
  
      pigment { aoi pigment_map { ... } }
      normal { aoi normal_map { ... } }
      texture { aoi texture_map { ... } }
  
    The pattern gives a value proportional to the angle between the ray and the 
    surface; for consistency with the slope pattern, values range from 0.5 where 
    ray is tangent to the suftace, to 1.0 where perpendicular; in practice, 
    values below 0.5 may occur in conjunction with smooth triangles or meshes.
  
    (Note that this differs from the current MegaPOV implementation, where the values
    range from 0.5 down to 0.0 instead.)
  
  - Extended slope pattern to specify a reference point instead of a direction; 
    the new syntax is as follows:
  
      slope { point_at <ReferencePoint> [, Lo_Slope, Hi_Slope] }
  
    (Note that this variant currently does *not* allow for the "altitude" keyword to be used.)
  
    The functionality is similar to MegaPOV's "aoi <ReferencePoint>" pattern, 
    except that the values are reversed, i.e. range from 0.0 for surfaces 
    facing away from the point in question, to 1.0 for surfaces facing towards 
    that point; thus, "slope { <Vector> }" and "slope { point_at 
    <Vector>*VeryLargeNumber }" have virtually the same effect.
  
  - Fixed FS#90 "POV-Ray accepts additional patterns after "slope""
  
  - Various purely cosmetic code changes (comments and formatting) to photons.cpp

Change 4934 on 2010/03/26 by clipka@cli-pc-xp64

  fix for FS#78 "Wrong rendering of BeamTest-Scene in 3.7.beta.35a"

Change 4933 on 2010/03/26 by clipka@cli-pc-xp64

  fix for FS#67 "alpha channel in image map is ignored for shadows"

Change 4932 on 2010/03/26 by clipka@cli-pc-xp64

  Various changes to image file output:
  
  Code refactoring:
  
  - Image file output now uses the GammaCurve mechanism already in use for 
    image file input, to allow for arbitrary transfer functions (e.g. as used by 
    sRGB) in the future.

  - Output/histogram file type is now identified by the command line / INI 
    options parser, removing some uglies from the code and allowing for easier 
    maintenance of file type letters.
  
  Fixes:
  
    - Fixed FS#88 "File output code does not properly handle negative color values"

    - Fixed FS#89 "PPM output garbled for bit depths other than 8 bits"

    - Fixed a benign coding flaw in HDR image input code (wrong parameter type in function prototype)

    - Fixed file type names in some error messages
  
  Changes:
  
    - Radiance HDR image output no longer writes the proprietary GAMMA header 
      field.
  
    - PPM image output now supports 16-bit greyscale output (effectively 
      writing a PGM file instead), to be activated via the "Greyscale_Output=on" 
      option or the "+FPg" file type switch.

Change 4930 on 2010/03/15 by chrisc@x8

  Add manual update check menu item for Windows UI.

Change 4929 on 2010/03/14 by calimet@lavender

  Unix beta.35a config: require boost >= 1.37 and (for now) libpng < 1.4

Change 4928 on 2010/03/13 by chrisc@x8

  update for beta 36, add hard expiry and remove standard timeout from windows version.
  activate update checks in windows version.

Change 4927 on 2010/02/11 by clipka@cli-pc-xp64

  Minor radiosity changes:
  
    - maximum_reuse parameter now governs the maximum effective radius of a 
      sample more directly.

    - Removed obsolete code.

    - Trimmed down radiosity sample memory footprint a bit.

    - Improved robustness of code

    - Improved pretrace "pixel" coordinates computation

    - Eliminated some "magic numbers"

Change 4926 on 2010/02/08 by chrisc@x8

  Fix to changes.txt/revision.txt.

Change 4925 on 2010/02/08 by chrisc@x8

  Update about.bmp for windows source dist.

Change 4924 on 2010/02/08 by chrisc@x8

  Update windows source dist.

Change 4915 on 2010/01/11 by chrisc@x8

  Fix cone axis bug
  Fix crash caused by PossibleError function being called with invalid first parameter.
  Change version to beta 35a.

-------------------------------------------
Changes between 3.7.beta.34 and 3.7.beta.35
-------------------------------------------

Change 4906 on 2009/12/31 by chrisc@x8

  Fix FS#73 (Blend map cannot get 256 entries).
  
  Thanks to J\E9r\F4me Grimbert for the proposed fix.

Change 4905 on 2009/12/31 by chrisc@x8

  Fix FS#59 (Cone intersection test broken)
  
  Implement suggested fix from J\E9r\F4me Grimbert.
  NB this fix should be back-ported to 3.6.

Change 4904 on 2009/12/31 by chrisc@x8

  Fix FS#51 (POV-Ray crashes hard on missing parenthesis).
  
  The cause of this bug was a pointer to the include file input stream being 
  retained in the token structure after the stream was closed. The fix involves 
  comparing the token filehandle pointer to the input file pointer when it is 
  about to be closed, and setting it to NULL if this is the case. Additionally, 
  if the include file stack is popped, the token filehandle is set to the 
  handle of the enclosing file. This will result in any parse errors that occur 
  for the current token being reported as being in the enclosing file (assuming 
  that an error occurs before a new token is started). Typically this will be 
  just after the include or macro statement that opened the file.

Change 4903 on 2009/12/31 by chrisc@x8

  Set expiry to March 1 2010, bump version to beta 35.

Change 4902 on 2009/12/31 by chrisc@x8

  change hard-coded timeout to 2011.

Change 4900 on 2009/11/08 by clipka@cli-pc-xp64

  Proper fix for FS#32 "tiff file extention error" and other changes to file 
  extension handling:
  
  When trying to load a file of a certain type, the unchanged filename is now 
  tried first IF it ends in one of the default extensions for the type; 
  otherwise it is tested only after trying to append one of the defailt 
  extensions.
  
  When trying to infer a file type from the file name, all of the default 
  extensions are now compared against, instead of just the first (so that e.g. 
  "foo.jpeg" will now be identified as a jpep file name).
  
  Some additional code refactoring regarding file extension handling.

Change 4899 on 2009/11/08 by clipka@cli-pc-xp64

  Updated list of contributors (console only; bitmaps need to be updated accordingly)

Change 4898 on 2009/11/07 by clipka@cli-pc-xp64

  a few trivial changes

Change 4897 on 2009/11/07 by clipka@cli-pc-xp64

  Fix FS#53 "Blob trace level":
  
  Trace level increment is now performed on rays being reflected or refracted 
  at a surface, rather than on rays hitting a potentially refracting or 
  reflecting object, to do away with the need to figure out beforehand which 
  objects should increment the trace level and which shouldn't.
  
  Note that slight discrepancies with previous versions may occur regarding 
  maximum trace level statistics; e.g. a scene without any reflective or 
  refractive surfaces will report a maximum trace level of 1 instead of 0.
  
  Trace level for radiosity secondary rays will now be incremented according to 
  the same rules, instead of being incremented for every object surface they 
  encounter.
  
  Note that this change does not pertain to photons, the trace level of which 
  is still incremented at every object surface they encounter, including purely 
  transparent, non-refracting surfaces.

Change 4896 on 2009/10/25 by clipka@cli-pc-xp64

  Minor fix for change #4890: Gamma correction was not always forced on when 
  global file_gamma was used after assumed_gamma.

Change 4895 on 2009/10/25 by clipka@cli-pc-xp64

  Dispersion changes:
    - fixed FS#61 ("Dispersion does not give proper results")
    - improved results with low dispersion sample count
    - refactored code for future improvements

Change 4892 on 2009/10/01 by chrisc@cc-luggable

   GUIEXT updates from Hugo Arnaut.

Change 4890 on 2009/09/15 by clipka@cli-pc-xp64

  Improve input image file gamma handling.
  
  Input image files not carrying unambiguous gamma information will now be 
  assumed to match a common gamma setting, and gamma-adjusted accordingly; this 
  common input file gamma setting can be specified in the scene file using the 
  following syntax:
  
    global_settings {
        file_gamma GAMMA
    }
  
  where GAMMA is either a numeric expression specifying the approximate display 
  gamma for which input files are assumed to be gamma pre-corrected, or the 
  keyword 'srgb' indicating that input files are assumed to match the sRGB 
  standard. (In the latter case, gamma adjustment is applied according to the 
  sRGB standard, instead of approximating with a gamma 2.2 power-law function.) 
  The default setting is sRGB.
  
  Regardless of this global setting, gamma correction is not applied if the 
  image input file is obviously used as a mere data container, such as when 
  immediately used in a height field.
  
  FS#10 "Add support for specifying input images' gamma pre-correction":

  Default gamma handling rules for any image input file can be overridden by 
  specifying 'file_gamma GAMMA" immediately after the file name, e.g.:
  
    image_map {
        jpeg "foobar.jpg" file_gamma 1.8
        interpolate 2
    }
  
  This also applies to contexts where gamma adjustment is not normally applied, 
  e.g. file formats that are defined to be encoded linearly, or files used in 
  height fields, to simplify handling of files not conforming to standards.

    * Various bug fixes and minor improvements in input file reading code.
  
    * Added "out-of-the-box" transparency support for GIF files.
  
    * Added support for PNG sRGB chunks.
  
    * NOTE: Gamma handling for PNG input files has changed as follows in legacy ('#version 3.6') scenes:

  - In the absence of an 'assumed_gamma' statement, non-indexed PNG files with 
    a gAMA chunk (i.e. virtually all PNG files) will appear far brighter than 
    with POV-Ray 3.6.

  - In the presence of an 'assumed_gamma 1.0' statement, indexed PNG files 
    (uncommon) will appear darker than with POV-Ray 3.6.

  - In the presence of an 'assumed_gamma 2.2' statement, PNG files with a gAMA 
    lower than 2.2 (uncommon) will appear darker than with POV-Ray 3.6.

  - PNG files with an sRGB chunk but no gAMA chunk may appear significantly 
    different than with POV-Ray 3.6.

  - PNG files may generally appear slightly different than with POV-Ray 3.6.

  A warning will be printed in these cases, except for the latter.
  
  NOTE: Non-legacy scene default gamma handling for image input files has 
  changed significantly from previous betas, affecting all file formats except 
  OpenEXR, Radiance HDR and (with minor differences) most flavors of PNG; there 
  will be NO corresponding warnings.

Change 4889 on 2009/09/14 by calimet@lavender

  SDL preview display: temporarly disable the window title; see http://bugs.povray.org/23

Change 4887 on 2009/09/10 by clipka@cli-pc-xp64

  Update libtiff from version 3.6.1 to 3.8.2.
  This fixes FS#57 "Compressed TIFF image_map renders all transparent".

Change 4886 on 2009/09/09 by clipka@cli-pc-xp64

  Fix FS#55 "Output_Alpha=on doesn't work as documented"

Change 4885 on 2009/09/08 by clipka@cli-pc-xp64

  Subsurface Light Transport improvements:
  
  - Illumination samples for diffuse contribution are now shared among R, G and 
    B color components; this eliminates color noise, and also appearently reduces 
    RNG-induced patterns. Although this comes at a cost of increasing luminance 
    noise, the performance increase should allow to fully counter this effect by 
    increasing the sample count accordingly.
  
  - Fixed some asserts that did not compile on Linux.

Change 4884 on 2009/09/08 by clipka@cli-pc-xp64

  Modified ray-object-intersection postcondition handling.
  
  Those postconditions effectively rejected whole objects based on whether the 
  closest intersection would match the condition, instead of filtering out 
  individual intersections before determining the closest one. This would lead 
  to artifacts, e.g. small-scale smoothed mesh objects would fail to 
  self-shadow near edges where the normal would be almost perpendicular to a 
  group light source.
  
  Changed this so that compliance with the postcondition is now tested on all 
  intersections of a particular object when trying to determine the closest 
  intersection point with that object.

Change 4883 on 2009/09/07 by calimet@lavender

  Configure errors on missing NON_REDISTRIBUTABLE_BUILD=yes when required

Change 4882 on 2009/08/29 by clipka@cli-pc-xp64

  Improved integration of subsurface code within POV-Ray.
  
  Subsurface light transport code should now properly handle light attenuation 
  due to distance, spotlight falloff or intervening non-opaque objects 
  (including media and projected_through objects). Diffuse ambient illumination 
  is also supported to some extent (multiple-scattering term only) when 
  radiosity is turned on (however, it does not actually call radiosity code at 
  present).

Change 4881 on 2009/08/29 by clipka@cli-pc-xp64

  Fixed FS#52 "inside() function does not accept meshes despite valid inside_vector"

Change 4880 on 2009/08/29 by clipka@cli-pc-xp64

  Some code refactoring.
  
  pov::Trace::RadiosityFunctor and pov::RadiosityFunction:
    - Removed some unused method parameters.
  
  pov::Trace:
    - Added more comments to the declaration

    - Modified method parameters to consistently be const where feasible, and 
      use reference types in favor of pointers.

    - Modified area light code handling to leave the original LightSource data 
      unchanged; extracted all except the initialization part of 
      TraceAreaLightShadowRay() into new method TraceAreaLightSubsetShadowRay(); 
      slightly simplified the code

    - Renamed some parameters and variables for consistency.
  
  Various:
    - Defined a few function/method parameters as const

    - Cleaned up some macros

Change 4876 on 2009/08/24 by clipka@cli-pc-xp64

  Fixed and re-enabled change #4845 ("moved media handling code..."; see also #4860).
  
  This may significantly speed up scenes using both "heavyweight" averaged or 
  pattern-mapped textures (e.g. micronormals) and interior media.

Change 4870 on 2009/08/22 by clipka@cli-pc-xp64

  Fix FS#49 "number_of_waves default value not properly initialized"

Change 4869 on 2009/08/22 by clipka@cli-pc-xp64

  Some code refactoring and commenting:
  
  pov::Intersection: Added some doxygen-compatible comments; removed some 
  unused members; moved Intersection::GetLocalIPoint() functionality to 
  pov::Blob (the only place where it was used).
  
  pov::Blob: moved Intersection::GetLocalIPoint() functionality to here.
  
  pov::RadiosityFunction (and related): Eliminated some members that duplicated 
  SceneRadiositySettings values; renamed some local variables.
  
  pov::Trace: Added some doxygen-compatible comments; removed an unused 
  parameter from Trace::ComputeOneWhiteLightRay().

Change 4867 on 2009/08/20 by clipka@cli-pc-xp64

  Fix bug FS#48 "CSG bounding box computation broken with shearing transformation"

-------------------------------------------
Changes between 3.7.beta.33 and 3.7.beta.34
-------------------------------------------

Change 4861 on 2009/08/06 by clipka@cli-pc-xp64

  Refactoring of Trace class for more consistent use of types:
  - replacing DBL with double
  - replacing Colour with RGBColour where suitable
  - replacing COLOUR / RGB macros with Colour / RGBColour method calls
  - replacing colour component math with colour class math where suitable
  - replacing array-style colour component access with accessor method calls
  - declaring Colour& / RGBColour& parameters as const where appropriate
  - replacing VECTOR macros with Vector3d method calls where suitable
  - simplifying some unnecessarily complicated code

Change 4858 on 2009/07/30 by clipka@cli-pc-xp64

  added sample scene "advanced/diffuse_back.pov" to illustrate diffuse backside
  illumination (see changelist #4854)

Change 4856 on 2009/07/29 by clipka@cli-pc-xp64

  added support for diffuse backside illumination:
  
  To model thin, diffusely-translucent objects (e.g. paper, curtains, leaves etc.),
  an optional 2nd float parameter has been added to the "diffuse" finish statement
  to control the effect of illumination from the back of the surface. The default
  value is 0.0, i.e. no diffuse backside illumination. For realistic results, the
  sum of both parameters should be between 0.0 and 1.0, and the 2nd parameter should
  be the smaller of the two.
  
  Note: This feature is currently experimental and may be subject to change. In
  particular, the syntax as well as interoperation with double_illuminate, multi-layered
  textures or conserve_energy are still under investigation.

Change 4846 on 2009/07/20 by calimet@lavender

  fix FS#40 (FreeBSD lacking POSIX CLOCK_PROCESS_CPUTIME_ID) using the simple workaround
  proposed in http://news.povray.org/4a5f8092@news.povray.org

Change 4843 on 2009/07/15 by clipka@cli-pc-xp64

  added option to speed up radiosity pretrace:
  
  As some computations don't contribute to the generation of radiosity samples, they can
  safely be skipped during radiosity pretrace to gain some speed if the pretrace's other
  role as a coarse preview is not required.
  
  The following .ini file / command line options control whether pretrace performs all
  computations so it can double-feature as a coarse preview ("vain pretrace"):
  
      Radiosity_Vain_Pretrace=bool   turns vain pretrace on/off
      +RVP                           turns vain pretrace on (default)
      -RVP                           turns vain pretrace off
  
  Note that with vain pretrace off, preview will look remarkably odd during the radiosity
  pretrace phase; this is normal, and no reason to be alarmed.
  
  At the moment, turning vain pretrace off will affect only classic lighting computations
  (diffuse lighting, higlights and iridescence); other features expendable during pretrace
  may follow in future versions.

Change 4842 on 2009/07/15 by clipka@cli-pc-xp64

  FS#39 - "cats" and "life" sample scenes broken (follow-up)
  
  NOTE: Only the line ending of the very last line of each file changed (CR to CR+LF); some
  programs may consider this a non-change, so be sure to get the updated version!

Change 4835 on 2009/06/21 by chrisc@x8

  windows console version now sends stream output to stderr by default.

-------------------------------------------
Changes between 3.7.beta.32 and 3.7.beta.33
-------------------------------------------

Change 4828 on 2009/06/17 by calimet@lavender

  [unix] config: fix FS#34 (http://bugs.povray.org/task/34) and update generic autoconf macros

Change 4825 on 2009/06/15 by chrisc@x8

  improve support for image output to stdout/stderr for supported file types. the  BANNER_STREAM
  output will still be a problem if writing the image to stdout as currently this cannot be turned
  off. however note that the linux and winconsole versions write these streams to STDERR so this
  should be OK on those platforms.

  NOTE: this submission does not implement progressive output; the image is only written 
  after the render completes. progressive output will be added in a later submission.

Change 4824 on 2009/06/15 by chrisc@x8

  don't fclose stream if it's stdout, stderr or stdin, plus add support for output to stderr.

Change 4823 on 2009/06/14 by chrisc@x8

  fix FS#14 (coincident transparency issue)

  The postcondition in intersection tests had no means of taking SMALL_TOLERANCE into 
  account on those occasions it's needed (such as when doing shadow tests). This is now 
  implemented.

Change 4822 on 2009/06/14 by chrisc@x8

  fix FS#17 (square blotches in transparency).
  shadow cache assignment was testing for transparancy against CSG member rather than CSG itself.

Change 4820 on 2009/06/08 by chrisc@x8

   more cleanly handle circumstance where the VFE session closes unexpectedly (e.g. 
        due to an exception).

Change 4819 on 2009/06/08 by chrisc@x8

  add support for an exception during message dispatch being forwarded all the way to the 
  front-end code (see #4817) and provide a means to automatically stop a render when such 
  an exception occurs. this is a bit hacky in that it's possible to get multiple instances 
  of the exception before the render stop takes effect (due to POVMS messages already 
  queued or that get queued before the request is received).

Change 4818 on 2009/06/08 by chrisc@x8

  optimize the way imageProcessing handles creating new images; should reduce the chance 
  of an out-of-memory error.

Change 4817 on 2009/06/08 by chrisc@x8

  add support for file-backed RGBFT image container and use it for intermediate image 
  storage if allocating a memory-backed one fails. this implementation is basic in that it 
  doesn't support large files (anything more than what fseek/fwrite etc can handle) and 
  only buffers a single line. the proper solution to the intermediate image storage issue 
  is to go away from using an image container and cache the render blocks on disk instead, 
  using a class that can stream fully-completed rows to the image output code (required for 
  writing to stdout to work properly again).

  add support for an exception during message dispatch being forwarded all the way to the 
  front-end code. previously such exceptions were discarded, meaning that if e.g. an image 
  write operation failed due to lack of disk space, the front-end wouldn't know (and the 
  render would continue).

  NOTE: this has changed the semantics of POVMS_ProcessMessages: previously, it would 
  never throw an exception or allow one to reach the caller. VFE insulates callers from 
  this but platforms not using VFE need to be prepared to handle an exception if one 
  occurs.

Change 4816 on 2009/06/07 by clipka@cli-pc-xp.rad

  Add some more radiosity stats for performance tweaking

Change 4815 on 2009/06/07 by chrisc@x8

  fix FS#33 (parse accepting invalid vector float components).
  the parser will now throw an error if an additional period ('.') is found in a floating-point literal.
  see http://bugs.povray.org/task/33.

Change 4814 on 2009/06/07 by chrisc@x8

  fix bug FS#16
  code introduced in change #4452 did not iterate the blend map or materials to check for reflection.
  this could result in a render with infinitely increasing trace level (until stack 
  overflow) due to maxTraceLevel not being incremented.
  See http://bugs.povray.org/task/16.

Change 4813 on 2009/06/07 by clipka@cli-pc-xp.rad

  preliminary fix for FS#32 (tiff file extention error):
  Exact specified filename is now always searched for, if only as a last resort

Change 4811 on 2009/06/07 by chrisc@x8

  fix bug FS#15 (using trace or inside with a julia fractal causes a crash).
  See http://bugs.povray.org/task/15.

Change 4809 on 2009/06/05 by chrisc@x8

   fix bug FS#13 (files of exactly 4k cause editor crash in 64-bit windows)
  see http://bugs.povray.org/task/13

Change 4806 on 2009/05/31 by chrisc@x8

   fix editor crash on 64-bit systems.

Change 4801 on 2009/05/29 by calimet@lavender

  [unix] fix "FS#21 - unix scripts have wrong version set"

Change 4800 on 2009/05/29 by calimet@lavender

  [unix] config: drop support for --with-boost-src configure option.
  The workaround offered by this option has been marked unsafe since the first
  POV 3.7 source release (beta.28).  Moreover, installing Boost from sources
  got much easier since at least version 1.35.
  Note: with this change, the libraries/ folder is no longer distributed.

Change 4794 on 2009/05/27 by calimet@lavender

  [unix] get rid of --disable-vsnprintf-check and unimplemented SVGA support (--with-svga); misc tweaks

Change 4791 on 2009/05/24 by clipka@cli-pc-xp.rad

  Fix "FS#31 - function pattern in image map" (transmit component was inverted in pigment function images)

Change 4790 on 2009/05/24 by clipka@cli-pc-xp.rad

  Fixed "FS#24 - isosurface, bounding box & threads"; added some debug assertions to make 
  sure similar issues with IStack pop up early in future

Change 4783 on 2009/05/18 by clipka@cli-pc-xp.rad

  Fix ARRAYS_WriteDF3 macro:

    - Fix 16-bit depth output
    - Fix a parse warning

Change 4781 on 2009/05/18 by calimet@lavender

  [unix] config: Boost >= 1.36 required

Change 4780 on 2009/05/18 by calimet@lavender

  [unix] config: generic updates from GNU automake 1.11

Change 4774 on 2009/05/13 by clipka@cli-pc-xp.rad

  add no_radiosity keyword, as known from MegaPOV:
  Specifying "no_radiosity" in an object block makes that object invisible to radiosity 
  rays, in the same way as "no_image", "no_reflection" and "no_shadow" make an object 
  invisible to primary, reflected and shadow test rays, respectively.

Change 4765 on 2009/04/26 by chrisc@x8

  combine IntStats and FPStats into RenderStats class; this allows for more convenient access.
  introduce new thread-local storage macro; this is intended to replace use of boost's 
  thread_specifc_ptr such that we can get more direct (i.e. faster) access to the data 
  being referred to. currently this isn't used for anything new (CurrentTaskCooperate uses 
  it as before), but over time more uses will be enabled.

  NOTE: there is a default implementation of the TLS macro named DECLARE_THREAD_LOCAL_PTR in frame.h.
  This uses the syntax that GCC expects, and thus should work for unix and mac platforms, 
  however I've not tested it.

Change 4764 on 2009/04/25 by chrisc@x8

  remove reference to uninitialized local variable causing radiosity stats to be 
  displayed when they should not be.

Change 4762 on 2009/04/25 by chrisc@x8

  statistics re-work to provide support for floating-point values as well as int.
  also change ThreadData arguments in most places to no longer be const.

Change 4761 on 2009/04/20 by clipka@cli-pc-xp.rad

  Revival of Radiosity Load/Save + various other radiosity code changes:
  
  the following .ini / command line parameters are recognized:
  
    Radiosity_File_Name=<name>" or "+RF<name>" to set the cache file name;
    Radiosity_From_File=<on/off>" or "+RFI" to enable reading the radiosity file at startup
    Radiosity_To_File=<on/off>" or "+RFO" to enable writing new samples to the radiosity file
  
  NOTE: The parameter names are preliminary, and may still be subject to change; there is 
  a potential conflict between the shorthand forms)
  
  If both +RFI and +RFO are specified, new samples gathered are appended; otherwise, +RFO 
  causes the file to be overwritten if it exists.
  
  New samples gathered are written whenever an SMP block is completed. Tests indicate 
  that this is almost neutral regarding performance, compared to operation with radiosity 
  file output disabled.
  
  ---------------------
  Accompanying changes:
  
    - moved most of the radiosity parameters out of povrayold.h; overhauled handling of 
      per-recursion settings
  
    - each thread now has its own sample cache block allocation pool, reducing thread 
      synchronization overhead; according to tests, this gives a slight performance benefit.
  
  ---------------------
  Unrelated changes:
  
    - changed structure of the code computing sample ray directions, as initial preparations
      for future "smart" sampling algorithms
  
    - now using different "waveforms" to average nearby samples, using a more smoothly blurring
      function for top-level samples during final render, while using a faster function for
      deep-recursion samples and/or pretrace
  
    - slightly tweaked individual per-recursion parameters

Change 4760 on 2009/04/10 by clipka@cli-pc-xp.rad

  fixed duplicate color names in glass.inc

Change 4759 on 2009/04/10 by clipka@cli-pc-xp.rad

  Various Radiosity improvements:
  
    - further cleaned up code; improved performance for "bounce depth" >= 2 again
  
    - new "high reproducibility" mode: when specifying "High_Reproducibility" or "+HR" on the
      command line, POV-Ray will spend extra effort to make sure renders are deterministic despite
      SMP (currently, radiosity is the only code to use this flag; in HR mode, radiosity pretrace
      starts out with fewer threads, and some extra rules are imposed on sample re-use that may cause
      surplus samples to be gathered)

-------------------------------------------
Changes between 3.7.beta.31 and 3.7.beta.32
-------------------------------------------

Change 4753 on 2009/03/31 by clipka@cli-pc-xp.rad

  added ARRAYS_WriteDF3 macro to arrays.inc for writing an array to a df3 file

Change 4748 on 2009/03/28 by clipka@cli-pc-xp.rad

  fix bug creating artifacts in output file when mosaic preview is used with +EP2 and -A

Change 4747 on 2009/03/28 by clipka@cli-pc-xp.rad

  Added experimental support for subsurface light transport (aka subsurface scattering).
  
  Currently, SSLT is activated for a particular object by adding the following statement to
  its finish (note that this is very likely to change):
  
    subsurface { COLOR, COLOR }
  
  specifying the (reduced) scattering coefficients (sigma'[s]) and absorption coefficients
  (sigma[a]), respectively, in units of 1/mm, for each of the three basic colors. The object's
  IOR will also affect the results.
  
  The algorithm is designed to give realistic results at a scale of 10 mm per POV-Ray unit by
  default; for other scales, place the following statement in the global_settings section:
  
    mm_per_unit NUMBER
  
  To tune the algorithm for quality or performance, the number of samples for the diffuse
  scattering and single-scattering approximation, respectively, can be specified by placing
  the following statement in the global_settings section:

    subsurface { samples NUMBER, NUMBER }
  
  SSLT is still in alpha stage.

Change 4743 on 2009/03/27 by clipka@cli-pc-xp.rad

  added radiosity octree performance stats; fixed stats for max trace level & parse time

Change 4742 on 2009/03/25 by clipka@cli-pc-xp.rad

  implement binary #write

Change 4733 on 2009/03/14 by chrisc@x8

  alter the return type of GetThreadID() related functions to be POVMS_Sys_Thread_Type.
  Change POVMS_Sys_Thread_Type to be unsigned long (needed for 64-bit Macintosh x86 build).

Change 4731 on 2009/03/09 by chrisc@x8

  improvements to performance in crackle cache. in particular, avoid calling malloc() for
  each cached entry, and rely on performance of unordered_map's default allocator to not hammer
  the heap. NB I tried using boost's pool allocator but this gave particularly poor performance
  on render shutdown (during destruction of the allocated entries).
  
  optimised the management of the crackle cache size by setting limits in megabytes (currently
  per-thread and not user-settable: this needs looking at).
  
  NB there is some scope for investigation of whether or not the crackle cache could be efficiently
  turned back into a single cache per scene, rather than per thread; cache efficiency seems fairly
  high and thus most accesses are reads.
  
  optimised crackle cache entry setup a little by avoid branches during main loop at cost of extra
  memory lookups.
  
  changed crackle to use the boost hash.
  
  renamed the standard POV 'Rectangle' class to 'Rect' due to a long-standing and rather annoying
  clash with a Windows definition of the same same name. unfortunately some boost headers (such as
  pool allocators, and also the mutex code) pull in windows.h and contaminate the namespace with
  windows crap. while I could work around it by explicitly specifying pov_base::Rectangle it's
  cleaner just to change the definition to avoid this.

Change 4726 on 2009/02/25 by calimet@lavender

  unix config: changes for beta.31
    - require boost >= 1.35 to build latest radiosity changes
    - add check whether the selected C++ compiler works to fix issue reported in
      http://news.povray.org/web.494ffd924e4b35bcedb0f3170%40news.povray.org
    - add more robust check to detect boost
    - add support for ICC's -xHost flag (version 11.0 and above) and preliminary support for SSE4

Change 4725 on 2009/02/25 by calimet@lavender

  unix config: ax_test_compiler_flags.m4 checks current flag with all previously selected flags;
    does not use AC_TRY_COMMAND anymore

Change 4720 on 2009/02/22 by chrisc@x8

  tweak randomsequences.h to make visual studio 2005 happy.

Change 4710 on 2009/02/18 by chrisc@x8

  tweak display of render shutdown and file warnings on Windows.

Change 4709 on 2009/02/18 by chrisc@x8

  change 'render shutdown' to 'shutdown' in shutdown messagefactory.

-------------------------------------------
Changes between 3.7.beta.29 and 3.7.beta.31
-------------------------------------------

Change 4708 on 2009/02/17 by chrisc@x8

  fix inconsistent usage of int/long in line numbers within POVMS messages.
  implement filename display in message output where name is supplied.

Change 4707 on 2009/02/16 by chrisc@x8

  introduce means for objects to submit a message on shutdown. this is
    currently only implemented for isosurfaces (the max_gradient warning), but
    can be implemented for any object type by providing an implementation of
    ObjectBase::DispatchShutdownMessages.

Change 4706 on 2009/02/15 by chrisc@x8

  auto-size progress bar to fit in remaining status panel space; if not enough
    room, don't show it at all.

Change 4703 on 2009/01/19 by clipka@cli-pc-xp.rad

  fixed bug that caused wrong radiosity illumination on transformed mapped textures

Change 4696 on 2009/01/16 by calimet@lavender

  config: ax_x86_arch.m4 does not use AC_TRY_COMMAND anymore;
  add preliminary support for SSE4x and newer Core i7, Phenom CPUs

Change 4695 on 2009/01/16 by calimet@lavender

  config: ax_fix_incorrect_path.m4 does not use AC_TRY_COMMAND anymore

Change 4694 on 2009/01/16 by calimet@lavender

  config: rewrite ax_compiler_version.m4 macro for better logging;
  do not use autoconf's undocumented/deprecated/dangerous AC_TRY_COMMAND anymore

Change 4693 on 2009/01/15 by calimet@lavender

  remove a non-ASCII character (radiosity updates, change 4687) 

Change 4692 on 2009/01/15 by calimet@lavender

  install script: fix non-POSIX 'read' options as reported in
    http://news.povray.org/web.496e790f156c502e2adf27b40@news.povray.org

Change 4691 on 2009/01/12 by calimet@lavender

  config: fix issue reported in http://news.povray.org/web.494fe25d9d9e24ec569d0e9f0@news.povray.org
  updates/fix for newer GNU autoconf versions (tested with 2.63)

Change 4690 on 2009/01/12 by calimet@lavender

  config: updates from the Autoconf Macro Archive; minor mod for ax_compare_version.m4

Change 4689 on 2009/01/12 by calimet@lavender

  config: generic updates from GNU automake 1.10.2

Change 4688 on 2009/01/10 by chrisc@x8

  ported SSLT code by Sarah Tariq and Lawrence (Lorenzo) Ibarria from v3.5
    proof-of-concept source files.
  code is not active currently. lots more work to do.

Change 4687 on 2009/01/08 by chrisc@x8

  Radiosity updates from Christoph Lipka, with some minor re-formatting and
    updates to suit changes in the boost::thread library.

Change 4685 on 2009/01/06 by chrisc@x8

  various minor changes mostly related to building the code with boost v1.37.0

Change 4683 on 2009/01/03 by chrisc@x8

  add Visual Studio 2008 project.

Change 4680 on 2008/10/18 by chrisc@x4

  fix install issue where SSE2 binary was always used even if system didn't
    have SSE2.

Change 4673 on 2008/10/05 by chrisc@x4

  update windows readme.txt, add HTML version (readme.txt is now derived from
    the HTML one).

Change 4668 on 2008/09/30 by calimet@lavender

  fix bashism is various scripts; see http://news.povray.org/48c1d1b9$1@news.povray.org

Change 4667 on 2008/09/30 by calimet@lavender

  fix bashism is various scripts; see http://news.povray.org/48c1d1b9$1@news.povray.org

-------------------------------------------
Changes between 3.7.beta.28 and 3.7.beta.29
-------------------------------------------

Change 4662 on 2008/09/27 by chrisc@x4

  allow 'save as' to succeed without 'file is already open in editor' error if
    case of current file is being changed.

Change 4661 on 2008/09/27 by chrisc@x4

  add CPU count code from Intel Corp.
  this allows us (at least on Intel CPU's) to get a more accurate count of
  actual CPU cores installed. this is particularly useful for fixing the
  issue with the stats (Windows counts virtual processors as physical ones,
  which mucks up the CPU vs elapsed time ratio calculation).

Change 4659 on 2008/09/27 by chrisc@x4

  update teapot sample scene.
  change flat_enough to 0.0001 (was 0.01).
  change teapot texture, checker color, and background color.
  fix error on line 179 where incorrect y-coordinate was given (reported by
    Yannick Patois).

Change 4658 on 2008/09/27 by chrisc@x4

  add colored text output to message window. warning and debug messages get
    different colors than error messages and standard text.
  change default background to be a plain color.

Change 4657 on 2008/09/27 by chrisc@x4

  add deprecation to glass_old.inc and related changes (from Jim Holsenback).

Change 4656 on 2008/09/25 by chrisc@x4

  add ability to declare an identifier as deprecated.
  
    #declare deprecated Col_Glass_Old=color rgbf <0.8, 0.9, 0.85, 0.85>;
    #declare deprecated once Col_Glass_Old=color rgbf <0.8, 0.9, 0.85, 0.85>;
    #declare deprecated "Some message" Col_Glass_Old=color rgbf <0.8, 0.9, 0.85, 0.85>;
  
  A deprecated identifier generates no message at the time it is declared: a
  warning is only issued if it is used.
  
  If the optional 'once' keyword is present it must immediately follow the
  'deprecated' keyword and indicates that the warning should only be displayed
  once per parse.
  
  If the optional message string is present, it will be used as the warning to
  be displayed if the identifier is used. Otherwise, a message of the form
  "Identifier 'FOO' was declared deprecated." is used.
  
  An identifier is considered 'used' if it is referenced anywhere (even if in
  another #declare).

Change 4655 on 2008/09/25 by chrisc@x4

  add some extra libraries to the link for installations that don't already
    imply them.

Change 4653 on 2008/09/22 by chrisc@x4

  updated objects and portfolio files from Sabrina Kilian.
  See <48876483@news.povray.org> for details.

Change 4652 on 2008/09/21 by chrisc@x4

  work around crackle hash issue reported by Yvo by reverting to old hash function.
  Issue: new hash function returns large range of possible values, causing
    memory used by cache to grow quickly.

Change 4651 on 2008/09/21 by chrisc@x4

  move assumed location of user-editable files into a subdir of 'My Documents'.

Change 4649 on 2008/09/21 by chrisc@x4

  update sample INI files to read 3.7.

Change 4648 on 2008/09/21 by chrisc@x4

  scenes and include updates from Jim Holsenback and Stephen Shonfield.
  See <48876483@news.povray.org> for details.

Change 4645 on 2008/09/20 by chrisc@x4

  bump version to beta 29, expiry to 1 November 2008.

Change 4644 on 2008/09/20 by chrisc@x4

  a few tweaks to the project files; in particular, allow boost path to be
    specified via $(BOOST_ROOT).

Change 4643 on 2008/09/20 by chrisc@x4

  fixes two crashes reported in thread <web.48b1839e38b6f50ec03ef3130@news.povray.org>.
  also be a little more conservative with the cache allocations (min 1 entry
    even if no lights).

Change 4642 on 2008/09/20 by chrisc@x4

  fix sphere_sweep parse crash reported in <web.48bc447cc2ccad1e8510f03f0@news.povray.org>.

Change 4640 on 2008/09/16 by chrisc@x4

  change Ascii to USC2 function such that ASCII codes > 127 are not sign-extended.
  change UCS2 to Ascii function such such that UCS2 codes between 128 and 255 are
    now accepted.

Change 4639 on 2008/09/16 by chrisc@x4

  change media confidence test to accept 0.0 as per docs.

Change 4626 on 2008/08/11 by chrisc@x4

  thanks to Yvo for picking this lurking error up (could cause crashes in JPEG code).

Change 4624 on 2008/08/04 by calimet@lavender

  include Solaris patch by John Martin as reported in <web.47e9bdccd4b82d06c7064b8c0%40news.povray.org>.
  Update VERSION to beta.28

-------------------------------------------
Changes between 3.7.beta.27 and 3.7.beta.28
-------------------------------------------

Change 4620 on 2008/07/26 by chrisc@x4

  about box and status panel changes.
  set XP icon as default.
  add PSD for about box.

Change 4618 on 2008/07/21 by chrisc@x4

  change way parse warnings are dispatched internally if not optimized for
    console.

Change 4617 on 2008/07/20 by chrisc@x4

  fix 'white outlines in df3 patterns with interpolate 2' issue reported in
    <483d2920@news.povray.org>.
  NB fix solves problem by clamping the return value to no less than 0. a more
    correct approach might be to work out why the (very small) negative values
    were being generated in the first place.

Change 4616 on 2008/07/20 by chrisc@x4

  fix 'clock not working in functions' issue reported in
    <486c3c98$1@news.povray.org>.

Change 4613 on 2008/07/20 by chrisc@x4

  make sure windows exception handler body only gets executed once no matter
    how many threads are running.

Change 4611 on 2008/07/19 by chrisc@x4

  fix str() crash reported in <web.4880f0adaf19f856c59235590@news.povray.org>.

Change 4609 on 2008/07/14 by chrisc@x4

  fix bounding box calculation flaw that caused in some cases major slow-downs
    in scenes using difference (e.g. abyss.pov).

Change 4608 on 2008/07/13 by chrisc@x4

  re-implement light color cache for textures. without this, each subsequent
    layer (after the first) in a multi-layered texture will cause an unnecessary
    call to TraceShadowRay and its subsequent intersection test to determine the
    light color at that point.
  
  NOTE 1: the original 3.6 code did not re-initialise the 'Tested' flag in
    ComputeShadowColour; I presume this is to re-use the cache at that level ...
    need to check if this is the case. the current code does the same.
  
  NOTE 2: there's more work to do on this. it's just a first step; there are
    other places where caching is needed.

Change 4606 on 2008/07/01 by chrisc@x4

  work around boost::regex-related problem.
  bugfix for INI directory exclusion in IO permissions.

-------------------------------------------
Changes between 3.7.beta.26 and 3.7.beta.27
-------------------------------------------

Change 4605 on 2008/06/30 by chrisc@x4

  more work on splitting program data/user data.
  revert to using INI file for pvengine options.
  improve 3.6 migration code.

Change 4602 on 2008/06/21 by chrisc@x4

  fix issue whereby manual bounds, clips, patterns, UV, and interior were left
  behind when a transformation was applied to a CSG object.

Change 4600 on 2008/06/15 by chrisc@x4

  add handling of std::bad_alloc() to parser, rather than letting it fall
  through to task. this allows the file and line number that was being parsed
  at the time to be displayed. also, the bad_alloc handler in task attempts to
  raise a POV_EXCEPTION, which could fail due to insufficient memory for the
  exception object; this is no longer attempted.

Change 4599 on 2008/06/15 by chrisc@x4

  alter pvmem.cpp to throw std::bad_alloc() upon memory allocation failure.

Change 4594 on 2008/05/25 by chrisc@x4

  add support for specifying grayscale output via INI file or command-line.
  
  this is intended to replace the use of hf_gray_16 in global_settings. 
  hf_gray_16, if encountered, has no effect on the output type and will 
  additionally generate a warning message (as before).
  
  currently only PNG file support is provided with grayscale output; others 
  will be added over time.
  
  grayscale output may be specified via 'Grayscale_Output=true' as an INI 
  option, or '+Fxg' (for output type 'x') as a command-line option. For 
  example, '+Fng' for PNG grayscale output.
  
  caveat: grayscale output implies the maximum bit-depth the format supports; 
  for PNG this is 16. it is not valid to specify bits per color channel with 
  'g' (e.g. '+Fng16' is not allowed, and nor for that matter is '+Fn16g'). if 
  bits per channel is provided via an INI option, it is ignored.
  
Change 4593 on 2008/05/19 by chrisc@x4

  fix crash with inverse and CSG reported in <web.4828b51b6d261ebff3e4f6a20@news.povray.org>.

Change 4592 on 2008/05/19 by chrisc@x4

  fix incorrect flag test which would have resulted in issues with cutaway 
  textures and CSG or objects with double_illuminate set.

-------------------------------------------
Changes between 3.7.beta.25 and 3.7.beta.26
-------------------------------------------

Change 4591 on 2008/05/11 by chrisc@x4

  Fix for "no_image and transparency" problem reported in <web.46f84a9cd032f3c7cb86afba0@news.povray.org>.
  NB: there might be other circumstances where we need to honor the NO_IMAGE
  flag at this point in the code; this fix just added refraction to the test.

Change 4590 on 2008/05/11 by chrisc@x4

  Fix the animation frame number issue reported in <478561e3@news.povray.org>;
  beware of side-effects (hopefully none).

Change 4588 on 2008/05/08 by chrisc@x4

  Re-enable Include_Header thanks to patch from Stefaan De Roeck (see <47fb5d65@news.povray.org>).
  Also fix unrelated bug discovered when testing above: if an attempt to open
  an include file threw an exception (e.g. due to file I/O restrictions), POV-Ray
  would crash if the include stack element had not been previously used.

Change 4587 on 2008/05/08 by chrisc@x4

  Fix 'library path accumulation' issue reported in <481da512$1@news.povray.org>.

Change 4586 on 2008/05/07 by chrisc@x4

  apply isosurface cache fix suggested by Lukas Winter in <47c5b8b6$1@news.povray.org>.

Change 4584 on 2008/05/07 by chrisc@x4

  Workaround for race condition that would cause 'timed out waiting for worker thread' error.

Change 4582 on 2008/04/25 by calimet@lavender

  [unix] fix the --prefix ignored issue reported by Warp
  http://news.povray.org/47f28cfe@news.povray.org

Change 4581 on 2008/04/20 by calimet@lavender

  dd two missing includes; after reports by Sean McGrath on
    http://news.povray.org/web.47e7abdfb582dec03803aa600@news.povray.org
    http://blogs.sun.com/smg/entry/povray_3_7_on_solaris

Change 4580 on 2008/04/08 by calimet@lavender

  apply gentoo patch for build failure with gcc 4.3
  http://bugs.gentoo.org/show_bug.cgi?id=216684

Change 4544 on 2008/02/09 by chrisc@x4

  a raft of changes, mostly related to our default class name, registry location, and migration.
  as of this checkin, POVWIN now uses its own registry branch instead of sharing the one used by 3.6.
  support has been added for automatically migrating INI-based settings from a prior 3.6 install.
  other misc changes also included.

Change 4533 on 2008/02/08 by chrisc@x4

  fix file drop crash reported in <47ac0f69$1@news.povray.org>.

Change 4532 on 2008/02/05 by chrisc@x4

  stub out windows video capture support code (needs re-implementation).

-------------------------------------------
Changes between 3.7.beta.24 and 3.7.beta.25
-------------------------------------------

Change 4524 on 2008/01/30 by chrisc@x4

  remove last vestiges of pvengine.ini support (with exception for compatibility in GUIEXT).
  NB this doesn't affect pov-ray's own INI file handling.
  
  Move pvtools.ini to logged-in user's Application Data\POV-Ray for Windows directory.

  As of this checkin, version 5 of the common control DLL is required. This was 
  supplied with IE5, so it's highly unlikely that it won't be present on any 
  version of windows that we still support.

Change 4523 on 2008/01/29 by calimet@lavender

  add auto setting of thread count and rework --benchmark for linux platform.

  The number of threads is now set as the number of detected CPUs, or
  4 otherwise.  The built-in benchmark now accepts +Lpath command-line
  options and does no longer read any INI file but the provided one.

Change 4521 on 2008/01/29 by chrisc@x4

  moves all settings that used to be in pvengine.ini into the registry.

Change 4519 on 2008/01/19 by warp@warp

  fixed double-illumination problem with the area_illumination feature.

Change 4518 on 2008/01/19 by chrisc@x4

  irid, ground fog, and constant fog were using noise generator 0 rather than 
  the default generator.

Change 4513 on 2008/01/01 by calimet@nx

  build system: fix problems in detecting Athlon64 X2 cpus and OpenEXR < 1.4.
  Thanks to Jaime for the reports.

Change 4511 on 2008/01/01 by chrisc@x4

  add fix for the 'area lights and transform' bug reported in 
  <web.4639ad4565c782bbc717c9af0@news.povray.org>.

Change 4510 on 2007/12/31 by chrisc@x4

  changes to parser error message handling intended to reduce the incidence of 
  duplicate messages.

-------------------------------------------
Changes between 3.7.beta.23 and 3.7.beta.24
-------------------------------------------

Change 4494 on 2007/11/27 by nkopp@lightspeed

  Update photon code to take advantage of multiple threads.
  
Change 4493 on 2007/11/16 by warp@warp

  Fixed superellipsoid bug reported in <6p8nj3tckhrd1pihpofmvltqrfrs4lish8@4ax.com>

Change 4492 on 2007/11/12 by warp@warp

  Added a new warp: cubic. It maps an area in the x-y plane between <0,0>
  and <1,1> in the same way as box uv-mapping does.

Change 4488 on 2007/11/09 by warp@warp

  A new pattern type: 'cubic'. It takes six texture elements and maps each
  one to each pyramid centered at each half-axis (thus effectively mapping
  each texture element to each side of a origin-centered cube).

Change 4486 on 2007/11/07 by warp@warp

  Added support for reading the pixel resolution of an image map. This is done
  by giving an image map pigment identifier to max_extent(), which will then
  return the resolution of the image map as the x and y value of the returned vector.

Change 4483 on 2007/11/03 by warp@warp

  Added support for full area light diffuse and specular illumination. By default
  this is off, but can be turned on with the new keyword 'area_illumination [on|off]'
  inside the light_source definition block.

-------------------------------------------
Changes between 3.7.beta.22 and 3.7.beta.23
-------------------------------------------

Change 4470 on 2007/10/20 by chrisc@x4

  POVWIN now allows an expired beta to be extended by up to one week at a time,
  up to a maximum of 12 months.

Change 4457 on 2007/09/15 by nkopp@lightspeed

  Fix photon issues with refraction and dispersion

Change 4454 on 2007/09/05 by warp@warp

  Comparison ('=', '!=', '<', '<=', '>', '>=') support for strings.

--------------------------------------------
Changes between 3.7.beta.20b and 3.7.beta.22
--------------------------------------------

Change 4452 on 2007/08/28 by warp@warp

  The trace level in the trace() function is now incremented only if
  an object was hit and the object is marked to increment the trace
  level, or if the ray was a radiosity ray. Objects which do not use
  reflection nor ior (but which might be semi-transparent) are marked
  as not incrementing the trace level.

Change 4447 on 2007/08/09 by chrisc@cc-vm-xp

  Workaround for the temp file mapping not being completed.
  Temp files are now created as before (in the place specified).
  
Change 4445 on 2007/08/09 by chrisc@cc-vm-xp

  Fix issue whereby an I/O restrictions error would be displayed rather than 
  'input file not found' in certain cases where POVWIN was asked to render a 
  source file that was not present.

Change 4431 on 2007/05/13 by calimet@nx

  Multi-threaded signal handler, replaces the basic implementation.
  The signal handler is now running its own thread waiting to receive signals
  via sigwait().  Cancelling the benchmark before it starts is now handled via
  the handler as well, and returns proper exit value.

Change 4430 on 2007/04/30 by nkopp@lightspeed

  Further fix for media_attenuation bug
  (fix new bug that was introduced in changelist 4394)

Change 4420 on 2007/04/19 by chrisc@x4

  Fix SDL crash reported in <4617c41e$1@news.povray.org>.

Change 4412 on 2007/04/17 by chrisc@x4

  Add Control-A support in commandline input box (select all).
  change render window keypress code to hand focus to main window for any key, not just escape.

Change 4394 on 2007/04/14 by nkopp@lightspeed

  Fix fog (and participating media) shadow attenuation issues.
  
  Media computation was ignoring the lightsource's media_attenuation
  flag under some circumstances, and was attenuating shadow rays if
  the shadow ray had intersected an object.

Change 4389 on 2007/04/14 by chrisc@x4

  Fix jpeg temp file issue reported in thread <web.46168c053403448a4f02351a0@news.povray.org>.

Change 4378 on 2007/04/10 by calimet@lavender

  Fix incorrect exit value when closing the display window (user abort)

Change 4377 on 2007/04/09 by chrisc@x4

  Temporarily hard-code INI keywords into editor syntax table for INI files.

--------------------------------------------
Changes between 3.7.beta.20 and 3.7.beta.20b
--------------------------------------------

Change 4375 on 2007/04/09 by chrisc@x4

  add 'alternate render file' feature to povwin IDE. the purpose of this 
  feature is to make working on include files and macros more convenient.
  
  if the user requests that a file which is not a '.pov' or '.ini' file, 
  povwin consults an internal list of include file to source file mappings 
  which is accumulated for each render (note this is not persistent). if 
  the file that is to be rendered is in this list, the user is asked if 
  they would prefer to render the source file that most recently included 
  it instead. their decision is stored for the remainder of the session.
  
  additionally, add extensions .MCR and .MAC to list of files POV 
  considers include files (i.e. which are filtered as such in the various 
  file dialogs and assigned the POV file type for the editor syntax 
  highlighting).
  
  add .INI file type to editor syntax highlighting. currently does not 
  recognise POV keywords; this is to be added.
  
Change 4374 on 2007/04/08 by chrisc@x4

  add window menu to IDE. entries are MRU-sorted.
  also some other misc changes, including removing links to IRTC CD etc.

Change 4371 on 2007/04/07 by chrisc@x4

  Activate new memory statistics code; update win mem stats code to suit.
  
  NOTE: This is a work in progress. Currently it only gives global memory 
  stats (not per-thread). Per-thread stats are planned and are more useful 
  than global stats since we can then determine the memory usage of e.g. 
  the parse stage vs the render stage, plus ignore any allocs from non-core
  related threads (e.g. the UI).
  
  NB this feature requires non-trivial platform-specific code to function. 
  I'd advise holding off doing other platform support until the windows 
  code is done, as the interface will probably change.

Change 4370 on 2007/04/01 by calimet@nx

  fix problems in running the internal benchmark (setting the number of 
  threads; aborting the benchmark before it starts)

Change 4368 on 2007/04/01 by calimet@nx

  better error checking for timers; pretend the CPU time is always right for 
  now.

Change 4367 on 2007/04/01 by calimet@nx

  configure.ac: always check getrusage() and gettimeofday()

Change 4365 on 2007/04/01 by calimet@nx

  various changes and fixes including:
    - the display PauseWhenDone() method now takes a parameter that signals
      whether we need to exit immediatly (for instance if ctrl+c is hit)
    - set expiry to 2007-04-16
    - better handling of render cancel (text display; within animation)
    - read session status a bit more often (200ms instead of 250)
    - immediatly notify a change in the backend state (set event mask)
      to better synchronize the relevant console messages
    - exit code now returns 0=ok | 1=error | 2=user abort

Change 4359 on 2007/03/31 by chrisc@x4

  fix issue with editor window splitting not being restored 
  (<45620b9e$1@news.povray.org>).

  fix issue with file type not being set on initial save if 'save as' was 
  not used (reported many times, including <45602a08@news.povray.org> and 
  <46092c8a@news.povray.org>).

Change 4358 on 2007/03/31 by chrisc@x4

  fix uv mapping issue reported in <45602a08@news.povray.org> and 
  <46092c8a@news.povray.org>.

  note that the core issue here could have had effects in other places. 
  [Copy_Object was not properly initializing/clearing some fields that are 
  usually, but not always, copied by the object-specific copy function.
  in particular it was not clearing llights].

Change 4356 on 2007/03/29 by calimet@lavender

  tentative implementation for CPU and wall-clock timers using the POSIX 
  clock_gettime() function or getrusage() as a fallback; misc changes such 
  as code cleanup.
  
  Note: On Linux at least, the per-thread CPU time is likely to be wrong, 
  i.e. equivalent to the process wall-clock time, due to how glibc 
  implements clock_gettime() with CLOCK_PROCESS_CPUTIME_ID or 
  CLOCK_THREAD_CPUTIME_ID (see http://sources.redhat.com/ml/libc-alpha/2004-10/msg00008.html).
  Linux  kernels >= 2.6.10 should implement those calls internally; however 
  I seem to get wrong results when the number of threads exceeds the number 
  of cores/cpus.  Needs further testing and/or workarounds.

Change 4355 on 2007/03/29 by calimet@lavender

  reorganize configure.ac to perform library checks before language 
  constructs and functions checks; add tests for availability of librt and 
  clock_gettime() for POSIX timers, as well as getrusage() and 
  nanosleep(); move again the variable expansion for directories after the 
  call of AC_OUTPUT.

Change 4354 on 2007/03/28 by calimet@lavender

  fix PNG gamma issue reported in <45aa976e$1@news.povray.org> and 
  <45c11eed$1@news.povray.org>.  If supported, the gAMA chunk is always 
  written, thus following the HDR (radiance) output behavior.

Change 4353 on 2007/03/28 by calimet@lavender

  Restrict display and file gamma to be at least 0.001

Change 4352 on 2007/03/27 by calimet@lavender

  activate interframe pause thanks to change 4345 (closes bugzilla bug #22)
  and add basic signal handler

-------------------------------------------
Changes between 3.7.beta.19 and 3.7.beta.20
-------------------------------------------

Change 4350 on 2007/03/25 by chrisc@x4

  change a number of instances of POV_EXCEPTION_STRING() to be POV_EXCEPTION() 
    with error code and string.

Change 4349 on 2007/03/25 by chrisc@x4

  cease use of longjmp in png error handlers.
  note that this change throws exceptions from 'extern C' functions. if you 
    have told your compiler that this does not happen, be sure to change that 
    setting for png.cpp.

Change 4348 on 2007/03/25 by chrisc@x4

  remove embedded LF in message generated for #error.

Change 4347 on 2007/03/25 by chrisc@x4

  add 'file modified' indicator to filename shown in main window caption.
  add feature notification for when auto-reload results in files being auto-saved.

Change 4345 on 2007/03/24 by chrisc@x4

  some vfe changes to assist resolution of the 'pause after render' problem.

Change 4344 on 2007/03/22 by calimet@lavender

  unix: add support for --benchmark (works together with +wt) and print
    built-in features with --version

Change 4343 on 2007/03/20 by calimet@lavender

  sanitize a few unix HTML files and port the lastest 3.6 changes
    (w3c conformance, folded menu entries, improved keyword index)

Change 4342 on 2007/03/20 by calimet@lavender

  sanitize a few generic HTML files

Change 4341 on 2007/03/18 by calimet@nx

  port the latest changes in the 3.6 build system to 3.7

Change 4340 on 2007/03/16 by calimet@lavender

  workaround the "1 thread busy after completing" issue reported in
    <45dda26c$1@news.povray.org> by replacing a wait event with polling.

-------------------------------------------
Changes between 3.7.beta.18 and 3.7.beta.19
-------------------------------------------

TODO

-------------------------------------------
Changes between 3.7.beta.17 and 3.7.beta.18
-------------------------------------------

TODO

-------------------------------------------
Changes between 3.7.beta.16 and 3.7.beta.17
-------------------------------------------

Change 4298 on 2006/11/16 by chrisc@x4

  fix vidcap handling of video source pins that are not RGB8 (it now ignores them).

Change 4297 on 2006/11/16 by chrisc@x4

  disable RTR support on Win64 for now.
  make sure pause button state reflects frontend state when pause/resume fails.
  include version ID and system time in crash dump filename.
  open explorer window with crash dump file selected after a crash dump.

Change 4295 on 2006/11/14 by chrisc@x4

  fix issue with sys output file extension on windows (<455a0770@news.povray.org>).

Change 4294 on 2006/11/14 by chrisc@x4

  fix 'Subset_Start_Frame not working' issue (<web.454b67a8defacc9bf2985afc0@news.povray.org>).

Change 4289 on 2006/11/12 by chrisc@x4

  remove local index vectors from bsp tree build code to avoid slowdowns due to 
  heap locking. on win32, this roughly doubles build speed for complex trees
  (e.g. isocacti.pov).

Change 4288 on 2006/11/11 by calimet@nx

  Some display-related improvements.
  Do not close the display window between the frames of an animation.
  Use PACKAGE_NAME and VERSION_BASE for the window title.
  Fix unwanted pause_when_done if the render is canceled.
  Decrease the GetStatus() wait time from 1s to 250ms.

Change 4287 on 2006/11/10 by chrisc@x4

  fix for BSP missing objects and speckled rendering (cornell.pov gave a good 
  example of both).

Change 4285 on 2006/11/05 by chrisc@x4

  fix infinite loop in radiosity pre-trace code that would occur with small 
  values of pretrace end.

  add temporary workaround to distribute radiosity pre-tracing amongst all 
  threads. this needs to be removed once we work out the best way of co-ordinating
  the worker threads during pre-trace.

Change 4283 on 2006/11/04 by calimet@lavender

  Fix missing definition for FILENAME_SEPARATOR that caused run failure with
  absolute filenames (reported by Warp).

Change 4281 on 2006/11/03 by chrisc@x4

  enable multi-threaded radiosity. includes some basic locking on radiosity 
  cache, but see note in source.

  radiosity is still a WIP.

Change 4280 on 2006/11/02 by chrisc@x4

  fix bug that stopped radiosity from being activated when it should have been.

Change 4275 on 2006/10/30 by chrisc@x4

  implement clockless animation support for real-time raytracing.

Change 4274 on 2006/10/30 by chrisc@x4

  some more RTR changes. windows capture code now supports options as follows:
  
    width=nnn
    height=nnn
    double-buffer=yes|true|1|no|false|0
    skip-initial=nnn
    gamma=fff
  
  if omitted, defaults are:
  
    width and height - the first found pin in the video capture device graph
    double-buffer    - on
    skip-initial     - 0 frames (i.e. off)
    gamma            - 1.0
  
  it is possible to specify just the width or height, in which case the code 
  will default to the first found pin with that size, and won't care what the 
  other dimension is. specifying '-1' as a width or height is also a way of 
  saying it is a "don't-care". if the requested size is not available, the 
  render will fail.
  
  skip-initial is the number of frames to skip before returning from the 
  initialization. this is needed on some webcams that need a number of frames 
  to perform their setup (such as auto exposure and auto white-balance). this 
  matters mostly if the vidcap input is being used for something other than 
  real-time rendering.
  
  double-buffer and gamma do what their name imply.
  
  example specification:
  
    image_map {sys  ":vidcap:width=640:height=480:double-buffer=0:skip-initial=5:gamma=2.2" map_type 1}

Change 4273 on 2006/10/29 by chrisc@x4

  add double-buffering to video capture implementation.

Change 4272 on 2006/10/29 by chrisc@x4

  some preliminary RTR support. still a WIP.

Change 4271 on 2006/10/28 by chrisc@x4

  fix issue caused by failure to clear ray interiors during focal blur sample loop.
  see <web.45424a798f1b3f6c1bd6cd0c0@news.povray.org>.

Change 4270 on 2006/10/25 by chrisc@x4

  implement video capture. still need to add options parsing for setting e.g. 
  resolution etc.

Change 4266 on 2006/10/23 by chrisc@x4

  fix issue with trace returning an incorrect intersection point in some 
  circumstances (see <web.45367d932f1ac4de72d86b490@news.povray.org>).
  
  The issue was caused by the noise function using a different noise generator 
  during the parse than afterwards, since f_noise3d passed a NULL pattern to 
  Noise(), which tells noise to use the default noise generator. However this 
  is not assigned prior to parse completion.
  
  The fix was to give the VM access to the actual noise generator via 
  scenedata, so that it may be passed to Noise(). In the process I took the 
  opportunity to get rid of the global gNoiseGenerator, since its main reason 
  for existance is to allow Noise() to work when it isn't passed a noise 
  generator explicitly (via tpat). Noise() - and also a few other functions 
  that used to take a TPATTERN * - now directly accept the noise generator 
  instead.

Change 4265 on 2006/10/23 by chrisc@x4

  fix material assignment issue (see bugzilla bug #21).

Change 4264 on 2006/10/23 by chrisc@x4

  improve handling of debug messages in vfe.

Change 4263 on 2006/10/21 by chrisc@x4

  fix crash reported in <web.453677b9876cd74e72d86b490@news.povray.org>.

Change 4261 on 2006/10/17 by thorsten@host27i

  Adds stat for camera count as well as variable for sending camera index to 
  View::StartRender (however, does not implement selecting that camera yet)

Change 4260 on 2006/10/15 by calimet@lavender

  change default file gamma from 1.0 to 2.2

Change 4258 on 2006/10/14 by chormann@chho

  correcting 'FileGamma' and 'DisplayGamma' to 'File_Gamma' and 'Display_Gamma' 
  in warning messages

-------------------------------------------
Changes between 3.7.beta.15 and 3.7.beta.16
-------------------------------------------

Change 4256 on 2006/10/14 by chrisc@x4

  work around an issue caused by apparent resource starvation within windows.
  this would show itself as non-updating editor windows when switching tabs or
  focus - usually when running several instances of POVWIN - and is caused by
  CreateCompatibleBitmap() failing. substituting calls to CreateDIBSection()
  fixes the problem. NB I not been able to replicate the error on systems that
  do not have windowblinds installed, though I cannot say definitively if that
  is the cause.

Change 4252 on 2006/10/13 by calimet@lavender

  add support for 'pause when done' (closes bugzilla bug 5)

Change 4251 on 2006/10/13 by thorsten@host27i

  set background color in parser

Change 4248 on 2006/10/12 by thorsten@host27i

  changes alpha handling for rays not going straight to the background

Change 4246 on 2006/10/10 by chrisc@x4

  fixes 'Initial_Frame is ignored' issue (bugzilla bug #20).

Change 4244 on 2006/10/07 by chormann@chho

  improvements/fixes for the install script:
    - fixing problem with the install log (uninstall now works after user install)
    - added warning about existing povray executables.
    - some changes in the text messages.
    - changed a few -f tests to -r
    - preparation for different target platforms
      (TARGET_PLATFORM and TARGET_PLATFORM_NAME - AMD64 version commented out)

Change 4243 on 2006/10/05 by chrisc@x4

  improve temp file handling under windows vfe platform implementation.
  code now uses its own subdir under the windows temp dir, and also keeps
  track of temp filenames handed out so as to delete them on exit in case
  the core code doesn't do so. also now automatically permits read/writes
  in the temp dir when I/O restrictions are turned on.

Change 4242 on 2006/10/05 by chrisc@x4

  change WorkThreads INI option to Work_Threads for consistency.
  change bounding method command-line option from +b2 to +bm2 for the same reason.

Change 4241 on 2006/10/05 by chrisc@x4

  fix major (e.g. 100x or more when rendering menger.pov) slowdown when using
  BSP bounding, an orthographic camera (or any camera with non-constant origin),
  and large numbers of slow objects. this was due to InitRayContainerState() not
  having BSP support written for it yet.
  also added BSP support to CheckCameraHollowObject().

Change 4240 on 2006/10/04 by chrisc@x4

  add ability to close edit tab by middle-clicking on it.
  Improve parsing of POVWIN-specific command-line filenames containing single
    quotes.
  Add /EDITDLLPATH command-line parameter which allows the user to override the
    default DLL locations.
  Changed edit DLL filenames to include 'd' for debug builds; e.g. cmedit32.dll
    becomes cmedit32d.dll.

  NOTE: the above change means that if you are debugging POVWIN and haven't 
  built and installed the debug DLL's, the editor won't load. Either build and 
  install the debug editor DLL's (codemax and cmedit projects), or copy 
  cmedit32.dll and povcmax32.dll to cmedit32d.dll and povcmax32d.dll 
  respectively, and place them into the default POVWIN install bin dir.
  Ditto  for the 64-bit ones if you're using Win64.

Change 4239 on 2006/10/02 by chrisc@x4

  add SEH and minidump generation to windows code.

Change 4233 on 2006/09/30 by chrisc@x4

  some code for experimental vidcap support.
  add 'beta_feature_flag' which works like 'experimental_flag' but also warns 
  feature may go away entirely.
  
  the vidcap code is an outgrowth of a real-time-raytracing experiment done 
  for IDF fall 2006, where a live image from a webcam was mapped onto a moving 
  curved reflective surface in real-time. the original code was a quick hack; 
  this is an attempt to provide it in a more usable framework that doesn't 
  break standard use of POV as I think it's worth further experimentation.
  
  currently this feature only works with image maps but there's no reason why 
  it can't work with other things that use images. the implementation returns 
  a pov::Image which is updated either continuously or when a UpdateImage() 
  request is made. no double-buffering is used in the windows implementation 
  yet.
  
  to implement this on other platforms, define the macro POV_VIDCAP_IMPL in 
  your syspovconfig.h file. the value of this macro should be the name of a 
  class which has a default constructor. it should also implement the methods 
  Init(), UpdateImage(), and WaitFrame(). see syspovimage.h in this submission 
  for an example, as well as the other files in the windows rtrsupport 
  directory.

Change 4232 on 2006/09/30 by chrisc@x4

  fix for error line/col reporting.

Change 4229 on 2006/09/29 by chrisc@x4

  change default number of threads to number of CPU's (was number of CPU's * 2).

Change 4213 on 2006/09/16 by chrisc@x4

  add ability to specify thread count from render menu. NB this value is not saved.
  tweak process priority for normal priority selection.

Change 4208 on 2006/09/14 by chrisc@x4

  fix for bugzilla bug #15 ('non-terminating unix POV-Ray').

Change 4204 on 2006/09/09 by nkopp@lightspeed

  Fix problem with photons in grenadine.pov
  It turns out that somehow when rendered with +b2 (BSP tree partitioning),
  we end up with LOTS of photons in the exact same spot (locaton 
  -0.865566,1.846830,-0.464796).  The code finds the average density of
  the scene by sampling points, and whenever it would sample that point,
  it would compute a density of infinity (because it would reach the maximum
  number of photons, and return a zero-radius surface area for those
  photons).
  
  The current fix is to make the system ignore samples that give zero-radius
  (infinite density) results.
  
  The "real" fix will be to figure out why we end up with over 100 photons
  in one spot when rendering with BSP, but not when rendering with the old
  block partitioning.

Change 4203 on 2006/09/04 by chormann@chho

  changed density file fix (change 4195) to use 'size_t' instead of 'long'.

Change 4201 on 2006/09/04 by chrisc@x2

  Fix nasty heap overwrite in BVH code. See <web.44e5a00bfcc26e0fc717c9af0@news.povray.org>.
  
  This bug caused delayed crashes and would not show up in debug mode.
  It's been in the codebase since at least version 3.5, if not earlier.

Change 4195 on 2006/08/31 by chormann@chho

  fixed the density file size limitation by changing 'int' to 'long' for
  various index variables in DF3 reading, pattern evaluation and data structure.
  See <web.44f40e4698b0d9e4b399450c0@news.povray.org>

Change 4194 on 2006/08/30 by calimet@nx

  fix "Crash when assigning materials" issue reported in <44f596fa$1@news.povray.org>

Change 4193 on 2006/08/29 by calimet@nx

  [docs] [unix] fix navigation problems (malformed <a name></a> tags); add
  'id' attribute together with 'name' and post-process their values for better
  w3c conformance; workaround to missing images (gif->png) when building the docs
  using the default "skip ta" makedocs option.

Change 4191 on 2006/08/23 by calimet@nx

  fix broken RLE Targa (+FC) output causing program abort (pixel overflow)

Change 4190 on 2006/08/23 by calimet@nx

  fix PNG output: corrupted file (missing IEND chunk) and potential memory leak

Change 4181 on 2006/07/27 by chrisc@x2

  benchmark.cpp fix.

Change 4173 on 2006/07/21 by chrisc@x2

  gamma changes, revert to beta.10 behaviour with some tweaks for more 
  extensive version checking.
  
  In particular, specifying -MV3.7 or later via an INI file or the 
  command-line is taken at higher precedence than a #version 3.6 (or 
  lower) in the scene file when it comes to assigning the default state of 
  gamma correction (on/off, not its actual value if on). the value used 
  when it is on is determined by either Display_Gamma (if given) or 
  DEFAULT_DISPLAY_GAMMA otherwise. Similar steps are taken for the new 
  File_Gamma option.
  
  The actual value of assumed_gamma is not passed on; this prevents its 
  use for anything other than turning gamma on or off (which is what the 
  majority of scenes did with it). Those scenes that (mis)used 
  assumed_gamma to adjust the scene appearance outside of the needs of the 
  user's actual display gamma will need to either be altered to suit, or 
  to be run with an adjusted Display_Gamma and File_Gamma.
  
  NB users are warned that assumed_gamma support will be removed entirely 
  in a later 3.7 revision.

Change 4170 on 2006/07/20 by thorsten@host27

  Adds gamma correction to file output. Need to determine if gamma 
  correction of alpha channel makes sense (3.6 and earlier manipulated 
  gamma in some strange way when merging filter and transmit). Further 
  added DEFAULT_ASSUMED_GAMMA macro to provide full backward compatibility 
  features for assumed_gamma (includes a strong warning).

Change 4169 on 2006/07/19 by thorsten@host27

  Changes display gamma to consider assumed_gamma for legacy scenes and 
  issue extensive warning messages to inform users about the change and 
  how to fix their scene file

Change 4168 on 2006/07/03 by thorsten@host27

  Adds "WorkThreads" INI option and "WT" command-line option to set 
  MaxRenderThreads

Change 4163 on 2006/06/22 by nkopp@lightspeed

  fix media photons (gather); also refactor some photon shooting code

Change 4161 on 2006/06/22 by chormann@chho

  implementing most of the functionality of old unix.cpp in a new 
  UnixOptionsProcessor class.  This provides options processing for the 
  standard options as well as for the display subsystems.
  
  This adds to the Unix frontend:
  
    - io-restrictions
    - povray.ini file processing
    - help display
  
  Further minor tweaks.

Change 4152 on 2006/06/18 by thorsten@host27

  Adds FileGamma option
Change 4141 on 2006/05/10 by chrisc@x2

  fix default blend map destruction issue.

Change 4132 on 2006/05/01 by chrisc@x2

  fix object count when no bounding is used, rendering empty file leaves stop 
    icon, and winpov exit command not working issues as reported in 
    <442df1da$1@news.povray.org>.

Change 4131 on 2006/05/01 by chrisc@x2

  fix photon memory issue referred to in <web.444b4f4ed5b924f08b9c27240@news.povray.org>.

Change 4129 on 2006/05/01 by chrisc@x2

  don't send mem usage stats as they are not accurate. have to fix this before
    release.

Change 4128 on 2006/05/01 by chrisc@x2

  make render failure messages a little more informative.

Change 4121 on 2006/04/05 by chrisc@x2

  ensure first texture is supplied when parsing tiles declaration.

Change 4120 on 2006/04/05 by chrisc@x2

  add exception translation (native windows to pov_base::Exception).
  reconfigure backend to report some exceptions more clearly.

Change 4117 on 2006/04/03 by chrisc@x2

  fix issue with ray interior being removed during evaluation of area lights.
  fix issue with intersection min depth being too coarse (e.g. the liquid in 
    the glass in balcony.pov did not render).

Change 4116 on 2006/04/03 by chrisc@x2

  check for zero-sized area light array parameters.

Change 4114 on 2006/04/02 by chrisc@x2

  fix sombrero.pov bug reported in <web.442c3cd3ccb62fd8c7294af50@news.povray.org>.

Change 4113 on 2006/04/02 by chrisc@x2

  improve error reporting when exception is caught in renderbackend.
  also add range-checking of start/end column/row against render width/height.

Change 4112 on 2006/04/02 by chrisc@x2

  bugfix for printing of max depth stopped nodes per node.

Change 4111 on 2006/04/01 by chrisc@x2

  make sure parse and bounding times are included in stream output.
  implement debug output to stream.

Change 4107 on 2006/04/01 by chrisc@x2

  fix render percentage error when a large number of pixels are being rendered.
  a few other tweaks.

Change 4100 on 2006/03/29 by chrisc@x2

  change default BSP child access cost to 5.0.
  tweak index insertion to massively speed up build of large trees
    (e.g. abyss.pov build was 45s now 3s).
  more changes to BSP tree reading.

Change 4098 on 2006/03/28 by chrisc@x2

  small but important fix to BSP tree traversal - fixes occasional missing 
  object which could occur where the ray origin lay exactly on the splitting 
  plane.

Change 4096 on 2006/03/27 by chrisc@x2

  BSP tweak, seems to speed things up a little.
  also implement more robust support for reading externally-generated BSP trees.

Change 4092 on 2006/03/26 by chrisc@x2

  should fix startup problems reported for initial release of beta.12.

Change 4089 on 2006/03/26 by chrisc@x2

  some fixes to bounding and object count statistics. fix typo in attribute name.

Change 4088 on 2006/03/26 by chrisc@x2

  no longer use intel's math library (too much hassle for too little gain).

Change 4086 on 2006/03/26 by chrisc@x2

  fix bug where some feature advice dialogs would be shown off-screen.

Change 4084 on 2006/03/26 by chrisc@x2

  fix spheresweep copy bug reported in <43fbaf97$1@news.povray.org>.

Change 4083 on 2006/03/26 by chrisc@x2

  fix 'aa incorrectly reported to be on' issue reported in
    <43fc75f9$1@news.povray.org>.

Change 4082 on 2006/03/07 by thorsten@host27i

  Adds progress and stats reporting for BSP bounding

Change 4081 on 2006/03/07 by thorsten@host27i

  Fixes camera inside media/interior mostly lost bug

Change 4079 on 2006/03/02 by chrisc@x2

  add means of setting BSP cost-function constants via INI file.
  this is possibly temporary.

Change 4063 on 2006/02/25 by chrisc@x2

  fix bug in BoundingTask::SendFatalError that was hiding real cause of
    some errors.

Change 4062 on 2006/02/25 by chrisc@x2

  some fixes for BSP code.
  now works much better. code changed to read more like Eric Haine's
    article so I can follow it more easily.
  still work to be done to improve it.

Change 4061 on 2006/02/19 by chrisc@x2

  fix debug message output.

Change 4060 on 2006/02/19 by chrisc@x2

  AA method 1 block artifact fix (see <43ebe0bc@news.povray.org>).
  also correct some jitter option issues and add slight optimization if
    jitter is turned off.
  NB it is still technically possible that block-boundary AA artifacts
    could occur but they are much less likely.

Change 4058 on 2006/02/18 by chrisc@x2

  fix bug in generation of lit intervals for media.

Change 4057 on 2006/02/17 by chrisc@x2

  fix "light doesn't pass through transparent image_map" issue
    (<43a97c75$1@news.povray.org>).

Change 4055 on 2006/02/17 by chrisc@x2

  Fix 'trace fails with no_image object in union' bug reported in
    <43f57a9d$1@news.povray.org>.

Change 4054 on 2006/02/17 by chrisc@x2

  fix issue where cancelling a render may not work if all CPU resources
    are committed to a render.

Change 4049 on 2006/02/12 by thorsten@host27i

  Adds smarter handling of bbox test for trivial objects
    (boxes, spheres, etc)

Change 4041 on 2006/02/10 by thorsten@host27i

  Adds new BSP code
  Threading control uses condition variable
  Changes platform-config include file logic
  Misc tweaks to error messages
  Enables parser stats (incomplete)
  Fixes generic timer bugs

Change 4040 on 2006/02/10 by chrisc@x2

  a few fixes for the new-style povwin render window.

Change 4039 on 2006/02/08 by chrisc@x2

  fix 'unrecognized file format' warning when HDR output is selected.

Change 4038 on 2006/02/08 by chrisc@x2

  fix flipped image HDR reading bug (<43e8190e@news.povray.org>)

Change 4037 on 2006/02/08 by chrisc@x2

  fix dispersion bug (long render times).

Change 4034 on 2006/02/05 by chrisc@x2

  (re-)implement display retention and bitmap preservation during animation.

Change 4029 on 2006/01/30 by chrisc@x2

  fix to image filename generation and rendered pixel counting.

Change 4026 on 2005/12/07 by chrisc@x2

  add LF to lineoutput.
  infer input directory from input file path if not supplied.

Change 4025 on 2005/12/07 by chrisc@x2

  fix gamma assignment in PNG output.

Change 4023 on 2005/12/05 by chrisc@x2

  version 3.7.beta.11a.

Change 4001 on 2005/11/08 by chrisc@x2

  change Cone_Tolerance to 1.0e-9 as per suggestion from DKB.

Change 4000 on 2005/10/22 by chrisc@x2

  hack fix into findfile stuff to accomodate relative filenames.

Change 3999 on 2005/10/22 by chrisc@x2

  fix a few problems in option parsing WRT unrecognized keywords.
  also mark Buffer_Output and Buffer_Size as superceded keywords (generates
    parse error but doesn't stop render).

Change 3995 on 2005/10/19 by chrisc@x2

  fix delayed crash caused by double-free of POVMS data.

Change 3994 on 2005/10/19 by chrisc@x2

  work around crash when All_File is turned on.

Change 3993 on 2005/10/18 by chrisc@x2

  a few misc changes.

Change 3992 on 2005/10/18 by chrisc@x2

  provides for output gamma correction.

Change 3990 on 2005/10/17 by chrisc@x2

  second part of gamma changes, still have file output to do.

Change 3987 on 2005/10/17 by chrisc@x2

  improve responsiveness by using events for control thread waits
  (esp. useful on fast animations).

Change 3986 on 2005/10/16 by chrisc@x2

  fix input image file default type selection.

Change 3985 on 2005/10/16 by chrisc@x2

  first part of gamma correction changes.

Change 3981 on 2005/10/13 by chrisc@x2

  some speedups for BSP tree iteration.

Change 3980 on 2005/10/13 by chrisc@x2

  fix for truetype objects within CSG.

Change 3979 on 2005/10/12 by thorsten@host27i

  Adds bounding method setting
  SceneData stores output file type for use

Change 3978 on 2005/10/12 by chrisc@x2

  this gets rid of the visual artifacts in bsptree tracing. still
  need to optimize the bbox tests and more.

Change 3975 on 2005/10/11 by chrisc@x2

  one bsp fix; helps somewhat but some issues still remain.
  temporarily make bsptree a void* for faster rebuilds.

Change 3973 on 2005/10/10 by thorsten@host27i

  Intersection test with bounds for BSP tree like for BVH

Change 3969 on 2005/10/09 by thorsten@host27i

  Adds experimental BSP tree tracing

Change 3949 on 2005/10/08 by thorsten@host27i

  Unified handling of file names and paths as UCS2

Change 3944 on 2005/10/06 by chrisc@x2

  find file now looks in current dir.
  fix logic in output filename generation code.

Change 3941 on 2005/10/02 by chrisc@x2

  some perl modules (+ example and generator) for helping
  makefile generation.

Change 3940 on 2005/09/30 by chrisc@x2

  a few tweaks to improve error display location in source files.

Change 3939 on 2005/09/30 by chrisc@x2

  fix cancel state in windows frontend.

Change 3934 on 2005/09/28 by thorsten@host27i

  Adds Path class
  Adds stream to file redirection
  TaskQueue now processes one Task per call
  File searching is now done by frontend
  Fixes misc typos

Change 3932 on 2005/09/23 by chrisc@x2

  fix some memory leaks in radiosity code.

Change 3930 on 2005/09/23 by chrisc@x2

  tiny but important fix to BSP cost function.

Change 3929 on 2005/09/22 by thorsten@host27i

  Changes BSP cost algorithm to work almost right

Change 3928 on 2005/09/22 by thorsten@host27i

  Adds exception handler support to Task class
  Fixes comments and semicolons in misc places
  Adds a missing method to renderbackend

Change 3926 on 2005/09/22 by thorsten@host27i

  Adds failed state for view

Change 3925 on 2005/09/22 by chrisc@x2

  fix uninitialized variable.
  make default parse or render fail error less confusing.

Change 3924 on 2005/09/22 by chrisc@x2

  fix crash in read_image_file.

Change 3923 on 2005/09/21 by chrisc@x2

  add visual bounding volumes to bsptree dump.

Change 3922 on 2005/09/21 by chrisc@x2

  a fix and more debugging stuff for bsptrees.

Change 3920 on 2005/09/20 by thorsten@host27i

  Completes BSP cost function (needs testing)
  Adds automatic recursion limit to BSP building

Change 3912 on 2005/09/20 by thorsten@host27i

  Changes BSP code to use multiset

Change 3911 on 2005/09/20 by chrisc@x2

  some fixes to bsptree bounding. this checkin does not fix the issue
  with duplicate keys in the min/max sets.

Change 3910 on 2005/09/19 by chrisc@x2

  windows changes - remove rerun handler.
  add stack walker, radiosity progress, display gamma.
  also misc fixes.

Change 3909 on 2005/09/18 by thorsten@host27i

  Adds gamma correction support to display

Change 3906 on 2005/09/18 by thorsten@host27i

  Adds more frequent stop-checking to all render tasks
  Adds two tiny radiosity speed optimisations
  Adds progress reporting for radiosity
  Adds radiosity progress output in frontend

Change 3905 on 2005/09/18 by chrisc@x2

  fix issue causing acne in e.g. cornell scene (with or without radiosity).
  [SHADOW_TOLERANCE was not being taken into account in blocking object intersection tests].

Change 3904 on 2005/09/17 by chrisc@x2

  radiosity now working a lot better.

Change 3900 on 2005/09/13 by chrisc@x2

  add Render_Block_Size INI option (+BS as command-line option).

Change 3899 on 2005/09/13 by chrisc@x2

  fix crash caused by resource exhaustion (too many threads); refer <4303d267$1@news.povray.org>.

Change 3897 on 2005/09/13 by chrisc@x2

  address state issue referred to in <web.42af2f04951c51e46a3607400@news.povray.org>.

Change 3895 on 2005/09/13 by chrisc@x2

  tweak editor handling of missing files.
  prevent multiple message-box display when switching focus and a file is modified or updated.

Change 3893 on 2005/09/13 by thorsten@host27i

  Mosaic preview now computes pixels rendered just like regular rendering,
    which will cause the counters to loop for each preview step but they will
    otherwise be correct. More information may be added latter for more accurate
    progress reporting

Change 3892 on 2005/09/13 by chrisc@x2

  Fix output file reporting issue reported in <web.430dc75ff23d654e726bd13c0@news.povray.org>.
  few other minor tweaks.

Change 3891 on 2005/09/13 by chrisc@x2

  ImageProcessing::WriteImage() now returns the name of the file it wrote.

Change 3890 on 2005/09/10 by thorsten@host27i

  Adds dispersion (still to be tested)
  Fixes misc little issues

Change 3889 on 2005/09/10 by thorsten@host27i

  Attempt to fix a mosaic preview related pointer problem

Change 3888 on 2005/09/10 by chrisc@x2

  fix render window re-display problem.
  ensure local povray.ini search location is in source file dir.
  add handler to throw std::bad_alloc on out-of-memory during operator new*.
  misc changes to vc.net project file.

Change 3887 on 2005/09/10 by chrisc@x2

  use FileMappedImageAllocator in windows project.

Change 3886 on 2005/09/10 by chrisc@x2

  improve error reporting when image allocation fails.

Change 3882 on 2005/09/10 by chrisc@x2

  handle out-of-memory condition when calling Image::Create().

Change 3881 on 2005/09/10 by chrisc@x2

  a few fixes for mosaic preview.

Change 3880 on 2005/09/10 by chrisc@x2

  radiosity fix.

Change 3879 on 2005/09/09 by thorsten@host27i

  Adds support for file-mapped image memory
  Requires FILE_MAPPED_IMAGE_ALLOCATOR to be defined to be a standard STL
    allocator that will be used when file-mapped image is required.
  Adds support for mosaic preview.

Change 3878 on 2005/09/08 by chrisc@x2

  focal blur bugfix.

Change 3876 on 2005/09/08 by thorsten@host27i

  Force finding free grid places in focal blur

Change 3875 on 2005/09/07 by thorsten@host27i

  Fixes of by one error in focal blur code

Change 3870 on 2005/09/06 by thorsten@host27i

  Fixes trace depth returning for radiosity

Change 3869 on 2005/09/06 by thorsten@host27i

  First version with radiosity sort of working (it is a "bit" too dark)

Change 3868 on 2005/09/05 by thorsten@host27i

  Concludes some major reorganisation:
    All dependencies on global variables in the radiosity
      code have been identified. However, the code cannot work
      as is until the variables are passed along properly.
      Vector and color classes had a rather serious (but easy
      to overlook) bug that did never cause any problems before
      because the features were never used before.
    Misc little tweaks to previous changes

Change 3867 on 2005/09/04 by thorsten@host27i

  Mostly compiling major reorganisation of tracing, photons and radiosity
    Media has been decoupled from tracing fairly cleanly
    Media has been mostly decoupled from photon tracing (but not completely)
    Radiosity has a structure better separating data and operations (but doesn't compile yet)
    Misc header dependencies have been removed

Change 3864 on 2005/09/04 by thorsten@host27i

  Misc changes preparing for radiosity
    Cleans up quality settings use
    Cleans up max trace level and adc bailout use
    Cleans up dependencies on output file name in backend
    Cleans up dependencies on output file type in backend
    Reverts to set in block tracking
    Adds fixmes to various places
    Adds operators to colour classes
    Adds warnings for non-longer available global settings
    Fixes misc dependencies on global stuff or marks it

Change 3863 on 2005/08/18 by chrisc@x2

  fix AA method 2 crash reported in <430358ed@news.povray.org>.

Change 3861 on 2005/08/17 by chrisc@x2

  animation handling tweak for windows.

Change 3860 on 2005/08/17 by chrisc@x2

  a bit more work on crackle.

Change 3857 on 2005/08/14 by thorsten@host27

  Adds back buffering of samples to AA method 2 (should be as fast as in 3.6 now)

Change 3855 on 2005/08/13 by chrisc@x2

  implement per-thread crackle cache.

Change 3853 on 2005/08/13 by thorsten@host27

  Adds parsing task queue
  Moves bounding into parsing task queue (bounds don't for each view change)
  New bounding location needs testing!

Change 3847 on 2005/08/09 by chrisc@x2

  add HDR file support (RGBE).

Change 3841 on 2005/08/01 by chrisc@x2

  exr support now uses the supplied streams and thus the correct filenames.

Change 3839 on 2005/07/29 by chrisc@x2

  adds EXR file support using OpenEXR library.
  very rough first pass, no options supported yet.
  currently input and output file names are hard-coded; this has to be fixed.

Change 3836 on 2005/07/26 by thorsten@host27

  Should fix an animation clock jump error

Change 3835 on 2005/07/22 by chrisc@x2

  temporary change to SMALL_TOLERANCE just for beta.7. Need to change it back later.

Change 3834 on 2005/07/22 by chrisc@x2

  windows output stream changes.

Change 3833 on 2005/07/22 by chrisc@x2

  fix version number display.

Change 3831 on 2005/07/20 by chrisc@x2

  bump version to 3.7.beta.7.

Change 3829 on 2005/07/17 by thorsten@host27

  Adds clock extraction to backend and clock use parser

Change 3828 on 2005/07/17 by chrisc@x2

  animation support under windows, first pass.
  needs core code support for clock to work.

Change 3825 on 2005/07/17 by chrisc@x2

  make render cancellation more responsive in the presence of a large number of threads.

Change 3824 on 2005/07/17 by chrisc@x2

  fix continue code, also change logic a bit.
  also the old behaviour of skipping a render if a completed output file is
    present is not yet implemented.

Change 3823 on 2005/07/16 by chrisc@x2

  get code from last few changes building under windows.
  fix a few bugs in continue code. this is a WIP as continue still won't work under
    certain skip list conditions.

Change 3821 on 2005/07/14 by thorsten@host27

  Adds basic animation support
  Makes misc pointers smart

Change 3819 on 2005/07/14 by thorsten@host27

  Adds continue-trace feature.  Currently consumes about 16*pixels bytes for
    continue-trace file. Compression with zlib probably should be added as an option.
  Fixes a bug in reading of message objects
  Tweak to file ids

Change 3818 on 2005/07/12 by thorsten@host27

  Adds backend support for continue trace
  Adds partial frontend support for continue trace

Change 3817 on 2005/07/10 by thorsten@host27

  Replaces POV_RAND with a new pseudo-random engine that is thread-safe
  as it just generates a predefined sequence of random numbers. This may
  cause visual differences in some places. However, noise tables are still
  initialised using the old random number algorithm, so there should be no
  visual difference when rendering *plain* noise.

Change 3816 on 2005/06/17 by chormann@chho

  core code changes required to build with gcc on linux:
    - backend/povray.cpp: changing "boost\version.hpp" to "boost/version.hpp" commenting
      hardcoded input file parameters.
    - base/pov_err.h: some small, hopefully uncritical changes to make it compatible to gcc.

Change 3815 on 2005/06/17 by chormann@chho

  fix for problem with C99_COMPATIBLE_RADIOSITY

Change 3813 on 2005/06/14 by chrisc@x2

  fix memory leak in photon code introduced in change #3804.

Change 3811 on 2005/06/13 by chrisc@x2

  csg merge fix from Massimo Valentini.

Change 3810 on 2005/06/13 by chrisc@x2

  quadric bounding fix from Massimo Valentini.

Change 3809 on 2005/06/13 by chrisc@x2

  add windows thread startup/cleanup support.
  set ideal processor for each thread.

Change 3800 on 2005/05/20 by chrisc@x2

  fix bug reported in <428de855@news.povray.org> re:sunsethf.pov.

Change 3796 on 2005/05/19 by chrisc@x2

  work around SMP bug in trace related to lighting code altering lightsources during render.
  for now each thread has its own copy of the lightsources. the lighting code should perhaps be
  fixed to treat lightsources as const, in which case this workaround can go away.

Change 3795 on 2005/05/19 by chrisc@x2

  add fixed allocator useful for stack-based stl collections, and modify Ray to use it.
  add some infrastructure support for call profiling (more to come).
  fix bug in photon code related to previous fix (see #3785).

Change 3791 on 2005/05/17 by chrisc@x2

  small but important fix for photon building that fixes one speed issue.

Change 3785 on 2005/05/13 by chrisc@x2

  fix scattering media problem reported in <427ca163@news.povray.org>.
  This was two separate bugs; the media was sometimes being evaluated twice,
  causing the result to be too dark, and the aa_threshold was not being set
  correctly, causing artifacts. This also fixes <427c0121@news.povray.org>.

Change 3784 on 2005/05/13 by chrisc@x2

  parser now honors Split_Unions and Remove_Bounds options.

Change 3783 on 2005/05/13 by chrisc@x2

  undo changes to SMALL_TOLERANCE and MAX_DISTANCE submitted in #3320.
  This fixes the lathe artifacts bug reported in <427c0f95@news.povray.org>.
  It also fixes the sphere_sweep issue alluded to in #3759.

Change 3781 on 2005/05/10 by chrisc@x2

  Fix no_image and no_reflection issues reported in <427c1900@news.povray.org>.

Change 3780 on 2005/05/10 by chrisc@x2

  fix area light orient issue reported in <427c14ef@news.povray.org>.

Change 3778 on 2005/05/07 by chrisc@x2

  fix issue where a new clip statement would overwrite a previous one rather than appending to it.
  fix speed issue with quadrics by reverting to old bbox calculation method.
  note however that this method is faulty in some circumstances (see comments in quadrics.cpp).

Change 3776 on 2005/05/06 by chrisc@x2

  fix a swathe of memory leaks.
  add boost library to library usage list.

Change 3775 on 2005/05/06 by chrisc@x2

  fix leak of transform memory in numerous shapes.
  Note: some shapes (notably CSG) do not copy the source transform. Have to check why.

Change 3768 on 2005/05/05 by chrisc@x2

  fix indexed PNG alpha problem reported in <42765ef3$1@news.povray.org>.

Change 3767 on 2005/05/05 by chrisc@x2

  fixes area lights.

Change 3766 on 2005/05/05 by chrisc@x2

  fix crash during trace() of lathe reported in <42796797@news.povray.org>.

Change 3765 on 2005/05/04 by chrisc@x2

  improve handling of cancel_render() a bit (provide retry).
  other windows tweaks.

Change 3764 on 2005/05/04 by chrisc@x2

  fix for max_trace_level calculation and display (see <42769105@news.povray.org>).
  Also apply texture list fixes from #3761 to shadow rays.

Change 3763 on 2005/05/04 by chrisc@x2

  fix memory leak.

Change 3762 on 2005/05/04 by chrisc@x2

  make code more responsive to cancel/pause requests.

Change 3761 on 2005/05/04 by chrisc@x2

  fix speed issues reported in <42769f6d@news.povray.org>.
  ComputeTextureColour() was tracing a full series of rays (potentially up to Max_Trace_Level)
  for each detected texture in multi-component objects (e.g. blobs) even when the multi_texture
  flag was not set.

Change 3760 on 2005/05/03 by chrisc@x2

  fix for shadow problem mentioned in <42769f6d@news.povray.org>.
  (other issues from <42769f6d@news.povray.org> still remain outstanding).

Change 3759 on 2005/05/03 by chrisc@x2

  fix sphere_sweep bug reported in <42773e51@news.povray.org>.
  There still seems to be a minor accuracy problem that was not visible in 3.6.

Change 3758 on 2005/05/03 by chrisc@x2

  fix 'inverting pre-declared union' crash reported in <42769b59@news.povray.org>.

Change 3756 on 2005/05/03 by chrisc@x2

  focal blur fix, part 2 of 2.

Change 3750 on 2005/05/03 by chrisc@x2

  partial fix for focal blur problem.

Change 3749 on 2005/05/03 by chrisc@x2

  fix omnimax camera bug reported in <42775c1b$1@news.povray.org>, plus several other related camera issues.

Change 3746 on 2005/05/03 by chrisc@x2

  fix for facets pattern crash reported in <42773fab$1@news.povray.org>.

Change 3744 on 2005/05/01 by chrisc@x2

  fix recursive memory leak when a CSG declare is redefined.

Change 3743 on 2005/05/01 by chrisc@x2

  fix render area selection.

Change 3742 on 2005/05/01 by thorsten@host27

  Should fix partial render area problems
  Should fix state errors in frontend due to missing information in backend messages

Change 3732 on 2005/04/30 by chrisc@x2

  fix CSG merge issue reported in <42645c3b@news.povray.org>.
  also re-implement some of the TODO code in Link_To_Frame.
  re-implement error message when photon file fails to load in photons.cpp.

Change 3730 on 2005/04/30 by chrisc@x2

  add warning and better progress reporting to photons.

Change 3729 on 2005/04/30 by chrisc@x2

  update to beta.3, set windows expiry date to 15 May.

Change 3728 on 2005/04/29 by chrisc@x2

  hopefully final part of hollow media fixes.
  misc other tweaks.

Change 3727 on 2005/04/29 by chrisc@x2

  work in progress; some fixes for hollow object media issue.
  add CheckCameraHollowObject() method to View (this needs more work).
  various minor changes.

Change 3726 on 2005/04/29 by chrisc@x2

  centralise handling of filter/transmit<->alpha conversion in Colour class.
  add methods allowing colours and images to be initialised from iterators.

Change 3725 on 2005/04/28 by chrisc@x2

  re-enable alpha display in render window for windows port.

Change 3724 on 2005/04/28 by chrisc@x2

  fix alpha bug reported in <web.426402d627a031d914107e060@news.povray.org>
  fix no_image bug reported in <web.426402d627a031d914107e060@news.povray.org>
  pass render settings to trace task (more to do on this subject).
  add basic RGBFT<->RGBA conversion support to image classes.
  turn Test_Ray_Flags and Test_Ray_Flags_Shadow into inline functions to make debugging easier.
  change default bounding threshold back to 3 as per v3.6.
  fix alpha inversion bug in BMP, Targa, and PNG file reading/writing.
  numerous changes to ensure that RGBA or GrayA images have the alpha channel initialised to 1.0, not 0.0.
  NB there is still a difference in alpha output compared to v3.6 which I have to chase down.

Change 3723 on 2005/04/26 by chrisc@x2

  fix for crash mentioned in <42689685@news.povray.org>.
  This was caused by a trace() intersecting a blob where the threaddata's blob intervals array had not been resized.
  N.B. we need to check other objects that use cached arrays for the same behaviour.

Change 3722 on 2005/04/26 by chrisc@x2

  fix noise generator default issue reported in <426898db@news.povray.org>.
  this was also causing differences elsewhere in the code (e.g. in the appearance of the irid in the previous fix).
  
Change 3721 on 2005/04/25 by chrisc@x2

  fixed irid problem reported in <42680b39@news.povray.org>.
  Also fixed similar issue with DepositMediaPhotons.
  We need to audit codebase to check for more of these (class Colour being passed by value).

Change 3720 on 2005/04/25 by chrisc@x2

  partial fix for hollow media issue reported in <42680e58@news.povray.org>.
  also tweaked ComputeShadowMedia() as it didn't seem to make sense when called from TraceShadowRay().

Change 3719 on 2005/04/25 by chrisc@x2

  fix for area light problem from Massimo Valentini.

Change 3718 on 2005/04/25 by chrisc@x2

  make quick_colour work again as it should (more or less).
  also fix problem where language version was being extracted from quality setting.

Change 3715 on 2005/04/24 by chrisc@x2

  misc windows changes, mostly related to using intel emt64 compiler.

Change 3713 on 2005/04/24 by chrisc@x2

  changes mostly to ensure that math.h isn't included before config.h.
  this is to allow config.h to optionally include a compiler-specific math library such as Intel's mathimf.h.

Change 3707 on 2005/04/19 by _abx_@_abx_

  Build fix for MinGW.

Change 3700 on 2005/04/18 by thorsten@host27

  CSG inversion bug fixes
  Misc other changes

Change 3698 on 2005/04/18 by thorsten@SMP

  Fixes shadow flag copying bug

Change 3696 on 2005/04/18 by thorsten@host27

  Adds max trace level check and trace level incrementing to TraceShadowRay

Change 3693 on 2005/04/18 by chrisc@x2

  I/O restrictions stuff.

Change 3692 on 2005/04/18 by chrisc@x2

  fix crash reported in <4263125b@news.povray.org> and one related bug.

Change 3691 on 2005/04/18 by chrisc@x2

  fix render quality options output.
  change references to 'CPU(s)' to 'thread(s)'.
  update render time output to include fractional seconds.

Change 3690 on 2005/04/17 by chrisc@x2

  tweak output filename and path logic.

Change 3689 on 2005/04/17 by thorsten@host27

  Fixes AA method selection and enabling
  Fixes image percentage size computation

Change 3686 on 2005/04/17 by chrisc@x2

  fix for BMP reading.

Change 3685 on 2005/04/17 by chrisc@x2

  add 'bmp' token to parser.

Change 3684 on 2005/04/17 by chrisc@x2

  file output should default to on.

Change 3683 on 2005/04/17 by chrisc@x2

  add output file type '+FB' (bmp).
  add macro to equate SYS file type to internal file type where supported.

Change 3677 on 2005/04/17 by thorsten@host27

  Fixes AA method 2 brightness issue

Change 3675 on 2005/04/17 by thorsten@host27

  Fixes rendering area bug

Change 3674 on 2005/04/17 by thorsten@host27

  Fixes no-display crash
  Fixes image closing bug
  Tweak to some radiosity local vars

Change 3673 on 2005/04/17 by chrisc@x2

  windows stuff: customise error/warning message handling.
  restore ability to open error file in editor (note: missing column number).
  introduce helper class for error/warning messages.
  remove some old code.

Change 3672 on 2005/04/16 by nkopp@impulse

  add initialization for lots of photon-releated variables

Change 3665 on 2005/04/15 by thorsten@host27

  Timing information

Change 3655 on 2005/04/15 by thorsten@host27

  Adds shadow ray cache stat

Change 3652 on 2005/04/15 by thorsten@host27

  we now have a shadow cache again

Change 3651 on 2005/04/15 by thorsten@SMP

  AA method 1 and 2 fully functional now

Change 3649 on 2005/04/15 by thorsten@host27

  Restores AA method 2

Change 3644 on 2005/04/15 by thorsten@host27

  Temporary solution for removed identifiers

Change 3642 on 2005/04/15 by chrisc@x2

  implement cleanup when parse fails.

Change 3640 on 2005/04/15 by chrisc@x2

  update built-in benchmark.

Change 3639 on 2005/04/15 by chrisc@x2

  make sure photon task exits promptly if requested.
  allow exception to be passed to Error() and ErrorAt() for throwing.
  clean up parser on parse error.
  ensure language version gets set to MessageFactory when changed.
  fix apparent bug in old tokenizer warning code.

Change 3637 on 2005/04/14 by thorsten@host27

  Adds photon stats and rendering timing output

Change 3636 on 2005/04/14 by thorsten@SMP

  Enable radiosity in view

Change 3629 on 2005/04/14 by thorsten@host27

  Adds version warning
  Adds basic radiosity support code

Change 3628 on 2005/04/14 by thorsten@host27

  Adds shadow stat counter and adds misc stats outputs

Change 3627 on 2005/04/14 by chrisc@x2

  fix for another bbox issue.

Change 3625 on 2005/04/13 by nkopp@impulse

  fix the photon "shadow blocking" problem for both
    media and surface photons

Change 3620 on 2005/04/13 by chrisc@x2

  add some more stats back in.

Change 3619 on 2005/04/13 by thorsten@host27

  Some changes to fix shadow bounding box test of shadowless objects
  Adds back trace level statistic
  Adds Cooperate call to photons (so building can be interrupted)

Change 3618 on 2005/04/13 by thorsten@host27

  Adds back basic stats

Change 3617 on 2005/04/13 by thorsten@SMP

  Focal blur is back! Should work with AA, too now!
  Fixed what seems like a bug in refraction, too.

Change 3615 on 2005/04/13 by chrisc@x2

  small but important interior fix!

Change 3614 on 2005/04/13 by thorsten@host27

  Noise generator global variable access no longer needed

Change 3613 on 2005/04/13 by thorsten@host27

  Noise setting, focal blur, bounding for show-rays

Change 3612 on 2005/04/13 by nkopp@impulse

  mostly fixed media photons.

Change 3608 on 2005/04/12 by thorsten@host27

  Adds splitting of unions

Change 3607 on 2005/04/12 by thorsten@SMP

  Adds image output support to Windows code

Change 3605 on 2005/04/12 by thorsten@host27

  Adds image output support

Change 3604 on 2005/04/12 by thorsten@host27

  Adds ComputeShadowMedia
  Adds clipping to image output

Change 3603 on 2005/04/12 by nkopp@impulse

  more photon-related fixes

Change 3600 on 2005/04/12 by chrisc@x2

  fix object copy bug

Change 3599 on 2005/04/11 by nkopp@impulse

  re-enable media photons

Change 3598 on 2005/04/11 by chrisc@x2

  restore support for POT files.

Change 3597 on 2005/04/11 by chrisc@x2

  eliminate globals and shared variables from parametric object.

Change 3596 on 2005/04/11 by chrisc@x2

  remove global from fractal code.

Change 3595 on 2005/04/10 by chrisc@x2

  temporary fix for problem where quadrics return clip 
  region smaller than clipping object even when original bbox 
  was larger (this is particularly visible when bounding slabs 
  are turned off).
  also add support for multiple clipping objects back.

Change 3594 on 2005/04/10 by chrisc@x2

  fix torus artifact.

Change 3590 on 2005/04/10 by nkopp@impulse

  further changes of photon

Change 3588 on 2005/04/09 by thorsten@host27

  Adds rainbow

Change 3587 on 2005/04/09 by thorsten@SMP

  Some cutting on light tests in media

Change 3584 on 2005/04/09 by thorsten@SMP

  This at last renders media correectly

Change 3583 on 2005/04/09 by chrisc@x2

  add platform-specific thread startup and cleanup macros.
  note that this change expects that boost::threads is modified 
  for win32 to not catch exceptions.

Change 3581 on 2005/04/09 by thorsten@host27

  Fixes to media lit interval computation

Change 3579 on 2005/04/09 by nkopp@impulse

  Re-enable photons afterlatest round of changes

Change 3578 on 2005/04/09 by chrisc@x2

  fix for interior uninitialised variables.

Change 3577 on 2005/04/09 by thorsten@host27

  Removes misc global variables and some general code cleanup

Change 3576 on 2005/04/09 by chrisc@x2

  image filter fixes.

Change 3574 on 2005/04/09 by thorsten@host27

  Adds fog support

Change 3573 on 2005/04/09 by chrisc@x2

  temporary work-around to stop boost:threads catching access violation etc exceptions.

Change 3571 on 2005/04/09 by thorsten@host27

  Unified image types for colour maps
  Added methods to get and set whole colour maps

Change 3570 on 2005/04/09 by chrisc@x2

  fix problem with blend maps

Change 3569 on 2005/04/08 by thorsten@host27

  Simplifies AA method 1 code

Change 3567 on 2005/04/08 by chrisc@x2

  ensure gammacorrect is specified when reading image files.

Change 3565 on 2005/04/08 by chrisc@x2

  ensure image files are closed after they are read.

Change 3560 on 2005/04/07 by thorsten@SMP

  Another AA method 1 change. Note that this
  method is currently not identical to AA method 1
  from POV-Ray 3.6 as there are a few odd things
  in that algorithm...

Change 3554 on 2005/04/06 by chrisc@x2

  exception handling changes

Change 3552 on 2005/04/04 by chrisc@x2

  more correct handling of inverse keyword for CSG objects.

Change 3551 on 2005/04/04 by thorsten@host27

  Rays now carry various important flags.
  Adds atmospheric media

Change 3549 on 2005/04/04 by thorsten@host27

  Media code is basically complete

Change 3548 on 2005/04/04 by thorsten@host27

  media (re)integration part two - cleanups and more cleanups
  in particular now color and vector components are properly accessed
  rather than using indices 0, 1 and 2!

Change 3547 on 2005/04/03 by chrisc@x2

  more internal blob tweaks

Change 3545 on 2005/04/03 by thorsten@host27

  Changes INTERIOR to Interior and various variables named Interior to interior
  Also changes IMEDIA to Media.

Change 3544 on 2005/04/03 by chrisc@x2

  partial cleanup of blob code

Change 3541 on 2005/04/02 by thorsten@host27

  Adds back bound sphere code
  Makes sort function Axis a template

Change 3538 on 2005/04/02 by thorsten@host27

  Fixes use of max trace level and adc bailout

Change 3537 on 2005/04/02 by thorsten@SMP

  Eliminates a message "race" (no, not really,
  but close) condition that prevented proper stopping

Change 3526 on 2005/04/01 by thorsten@host27

  Three arrays in Trace are now pooled/cached as well

Change 3521 on 2005/04/01 by thorsten@host27

  Changes Ray and IStack to be passed by reference hopefully everywhere

Change 3517 on 2005/04/01 by thorsten@host27

  Tweaks to use of bounding code
  Tweaks to camera ray interior finding

Change 3512 on 2005/03/31 by thorsten@host27

  Enables bounding slabs again (as a temporary bounding)

Change 3510 on 2005/03/30 by chrisc@x2

  remove half-pixel offset from CreateCameraRay(). 
  
Change 3508 on 2005/03/30 by thorsten@host27

  Progress reporting for parsing and rendering

Change 3506 on 2005/03/30 by thorsten@SMP

  Isosurfaces are now multithread-safe

Change 3503 on 2005/03/29 by thorsten@host27

  Extensive attempt to resolve all but one isosurface threading issue
  What remains is the use of eval and it modifying max_gradient - while
   the serious problems with this have been resolved, storing a new
   max_gradient involves a max() call, which is of course not thread-safe
   and could result in a higher max_gradient getting overwritten. However,
   it seems only a slight chance this could have a very serious impact - 
   only testing will tell. Either way, it won't cause visual problems
   but could result in incorrect max_gradient being reported to the user
   in case of using eval.  It can however cause a slight slowdown under
   very odd race conditions.  Note that the other reporting is not
   thread-safe either, but that should not be a major issue either...

Change 3502 on 2005/03/29 by chrisc@x2

  save povwin settings before each render.

Change 3501 on 2005/03/29 by chrisc@x2

  remove lathe and SOR mutexes by creating thread-local shared bounding arrays.

Change 3500 on 2005/03/29 by chrisc@x2

  stop the thread_specific_ptr in Task from deleting TaskData.

Change 3498 on 2005/03/29 by chrisc@x2

  changes mostly related to temp file handling.

Change 3488 on 2005/03/25 by chrisc@x2

  remove weighting from TraceRay.
  Restore time statistics output to message display (temporary).
  Initialise default thread count to nCPU's*2.
  Allow number of threads to be specified on command-line with '/THREADS n' parameter.

Change 3486 on 2005/03/25 by chrisc@x2

  add progress bar.

Change 3482 on 2005/03/24 by thorsten@host27

  Adds ability to pause parsing as well as proper return messages
  upon a user canceling parsing/rendering

Change 3480 on 2005/03/24 by thorsten@host27

  Fixes problem with function pattern contexts in parser

Change 3479 on 2005/03/24 by thorsten@host27

  Disables duplicate deletion of light sources

Change 3478 on 2005/03/24 by thorsten@host27

  Adds VM internal function thread pointer passing via context

Change 3477 on 2005/03/24 by thorsten@host27

  Eliminates need for function VM mutex
  Reorganises thread specific data

Change 3461 on 2005/03/19 by thorsten@host27

  Adds exception class and helper macros (pov_err.h)
  Moves task and task queue to support
  Enables Pause/Resume of parser
  Adds message factory for easier output abstraction

Change 3455 on 2005/03/19 by chrisc@x2

  wrap windows code in namespace povwin.

Change 3451 on 2005/03/19 by chrisc@x2

  windows preview display

Change 3435 on 2005/03/18 by thorsten@host27

  POVMS now supports sequences of ints, longs, floats and types,
  which makes transmitting i.e. blocks of colors much more efficient
  than using POVMS lists!
  Further finished transmission of pixel blocks

Change 3434 on 2005/03/18 by thorsten@host27

  Parser now runs in its own thread rather than the
  message receiver thread (which was just a hack)

Change 3432 on 2005/03/18 by thorsten@host27

  Integrates the new render task queue into the rendering process

Change 3431 on 2005/03/18 by thorsten@host27

  Adds render task queue and render task classes. These will
  allow to create a queue of individual threaded actions, i.e.
  first run a bounding task, then a photon task and then a radiosity
  task, and then run a render task. It also allows to start multiple
  of these tasks and wait in between for a set of tasks to be
  completed.

Change 3429 on 2005/03/17 by thorsten@host27

  Adds handling of pixel blocks to frontend

Change 3403 on 2005/03/06 by thorsten@host27

  Image read/write now take an options block

Change 3401 on 2005/03/06 by thorsten@host27

  Adds gamma and easier handling of colour maps

Change 3397 on 2005/03/05 by chrisc@x2

  add BMP to new image code. note that portable BMP support is now part of the core.

Change 3390 on 2005/03/05 by chrisc@x2

  adds pgm and iff support for new image handling

Change 3389 on 2005/03/04 by chrisc@x2

  jpeg support for new image handling

Change 3388 on 2005/03/04 by chrisc@x2

  add PNG support for new image handling

Change 3387 on 2005/03/04 by chrisc@x2

  add gif support to new image code

Change 3385 on 2005/03/03 by thorsten@host27

  Adds universal indexed image support

Change 3384 on 2005/03/03 by chrisc@x2

  clean up targa support a bit.

Change 3383 on 2005/03/03 by chrisc@x2

  add targa support to new image code

Change 3380 on 2005/03/02 by thorsten@host27

  Adds image class to base/image/

Change 3379 on 2005/03/02 by nkopp@impulse

  make photon code more object-oriented and more thread-safe

Change 3365 on 2005/02/24 by chrisc@x2

  work around fact BCyl code uses many temporaries shared between threads.

Change 3364 on 2005/02/24 by chrisc@x2

  massage bbox and mesh stuff to ensure shared bounding tree data is const.

Change 3363 on 2005/02/24 by chrisc@x2

  add code for bounding trees.

Change 3362 on 2005/02/24 by chrisc@x2

  remove global mesh queue.

Change 3348 on 2005/02/23 by chrisc@x2

  some tweaks to mesh to remove a few globals.

Change 3345 on 2005/02/23 by thorsten@host27

  Adds background/skysphere support back.

Change 3341 on 2005/02/23 by thorsten@host27

  Removes plenty of stuff from "opts"

Change 3338 on 2005/02/23 by chrisc@x2

  cleanup core header use in windows files.

Change 3334 on 2005/02/22 by thorsten@SMP

  Adds partial preview back

Change 3332 on 2005/02/21 by chrisc@x2

  can now use fractal istack in threaddata.

Change 3327 on 2005/02/21 by thorsten@host27

  Removed dispersion code as it cannot be repaired but needs to be rewritten
  Added back camera ray creation code, now rendering works much better again

Change 3322 on 2005/02/21 by thorsten@host27

  Lighting enabled

Change 3321 on 2005/02/21 by chrisc@x2

  remove the need for the intersections array in the prism
  object by merging the code from Intersect() into All_Intersections.

Change 3314 on 2005/02/12 by chrisc@x2

  remove Sx, Sy, Sz, Sw globals from quatern and hcmplx code.
  Note that there is a temp. global that needs to be removed once access to threaddata
  is available to the run-time fractal code.

Change 3311 on 2005/02/12 by chrisc@x2

  get rid of Distance and Precision global variables from fractal code.

Change 3304 on 2005/02/11 by thorsten@host27

  Turns RAY, ISTACK and INTERSECTION into the classes
  Ray, IStack and Intersection. This makes several dozen
  support and initialisation functions obsolete. There no
  longer is a max_intersections ISTACK limit either. As such,
  no more ISTACK overflows and thee global setting
  'max_intersections' is no longer needed.

Change 3302 on 2005/02/10 by chrisc@x2

  some work with Max_Trace_Level/Highest_Trace_Level and stats.

Change 3301 on 2005/02/10 by chrisc@x2

  update code to not use global stats variable.

Change 3299 on 2005/02/10 by chrisc@x2

  update shape code to accept thread data pointer.

Change 3296 on 2005/02/09 by chrisc@x2

  implement thread-safe local POVMS support in windows code.

Change 3293 on 2005/02/09 by chrisc@x2

  split reserved words global into its own file so it can be linked
  separately from the core code by e.g. a UI for syntax highlighting purposes.

Change 3292 on 2005/02/09 by chrisc@x2

  clean out old render thread from pvengine.cpp
  modify core project to include sub-categories of back-end code

Change 3282 on 2005/02/07 by chrisc@x2

  project file changes, and in pvengine

Change 3278 on 2005/02/06 by thorsten@host27

  Some major reorganisation of files

Change 3271 on 2005/01/28 by chrisc@x2

  first step in introducing new stats collection structure.

Change 3263 on 2005/01/22 by chrisc@x2

  changes to avoid literal copying of base class members.

Change 3245 on 2005/01/10 by thorsten@host27

  Changes methods&structs to classes.
