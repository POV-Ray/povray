env:
  global:
   # Required for clang.
   - CXXFLAGS="-fno-fast-math"

branches:
  except:
  # We're not using tags to trigger deployment, so there's no need to re-build tagged commits.
  # All our tags start with a version number, including a leading `v`.
  - /^v[0-9]/
  # Branches starting with "housekeeping" are intended for small changes that do not affect
  # the software per se (e.g. fixing typos in documentation or comments); no activity desired.
  - /^housekeeping/
  # Branches ending with "-stable" are used only to point to other branches,
  # which should already have been test-built at this point; no activity needed.
  - /-stable$/

language: cpp

matrix:
  include:
  - os: linux
    compiler: gcc
  - os: osx
    compiler: clang

sudo: false
dist: trusty

addons:
  apt:
    packages:
    - libboost-dev
    - libboost-date-time-dev
    - libjpeg8-dev
    - libopenexr-dev
    - libpng12-dev
    - libtiff4-dev
    - zlib1g-dev

install:
- unix/prebuild.sh
- ./configure COMPILED_BY="Travis CI" --prefix="$(pwd)/build"
- make check
- make install

script:
- true

notifications:
  email:
    recipients:
    - ${NOTIFICATION_EMAIL}
    on_success: change
    on_failure: always
